(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{116:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ENTERING_XR=0]="ENTERING_XR",e[e.EXITING_XR=1]="EXITING_XR",e[e.IN_XR=2]="IN_XR",e[e.NOT_IN_XR=3]="NOT_IN_XR"}(r||(r={}))},132:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),a=n(0),i=n(9),s=n(56),o=n(148),u=function(){function e(e){this.scene=e,this._sessionEnded=!1,this.baseLayer=null,this.currentTimestamp=-1,this.defaultHeightCompensation=1.7,this.onXRFrameObservable=new a.a,this.onXRReferenceSpaceChanged=new a.a,this.onXRSessionEnded=new a.a,this.onXRSessionInit=new a.a}return Object.defineProperty(e.prototype,"referenceSpace",{get:function(){return this._referenceSpace},set:function(e){this._referenceSpace=e,this.onXRReferenceSpaceChanged.notifyObservers(this._referenceSpace)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._sessionEnded||this.exitXRAsync(),this.onXRFrameObservable.clear(),this.onXRSessionEnded.clear(),this.onXRReferenceSpaceChanged.clear(),this.onXRSessionInit.clear()},e.prototype.exitXRAsync=function(){return this.session&&!this._sessionEnded?(this._sessionEnded=!0,this.session.end().catch((function(e){r.a.Warn("Could not end XR session.")}))):Promise.resolve()},e.prototype.getRenderTargetTextureForEye=function(e){return this._rttProvider.getRenderTargetForEye(e)},e.prototype.getWebXRRenderTarget=function(e){var t=this.scene.getEngine();return this._xrNavigator.xr.native?this._xrNavigator.xr.getWebXRRenderTarget(t):((e=e||o.b.GetDefaults(t)).canvasElement=t.getRenderingCanvas()||void 0,new o.a(this,e))},e.prototype.initializeAsync=function(){return this._xrNavigator=navigator,this._xrNavigator.xr?Promise.resolve():Promise.reject("WebXR not available")},e.prototype.initializeSessionAsync=function(e,t){var n=this;return void 0===e&&(e="immersive-vr"),void 0===t&&(t={}),this._xrNavigator.xr.requestSession(e,t).then((function(e){return n.session=e,n.onXRSessionInit.notifyObservers(e),n._sessionEnded=!1,n.session.addEventListener("end",(function(){var e=n.scene.getEngine();n._sessionEnded=!0,n._rttProvider=null,e.framebufferDimensionsObject=null,e.restoreDefaultFramebuffer(),e.customAnimationFrameRequester=null,n.onXRSessionEnded.notifyObservers(null),e._renderLoop()}),{once:!0}),n.session}))},e.prototype.isSessionSupportedAsync=function(t){return e.IsSessionSupportedAsync(t)},e.prototype.resetReferenceSpace=function(){this.referenceSpace=this.baseReferenceSpace},e.prototype.runXRRenderLoop=function(){var e=this,t=this.scene.getEngine();if(t.customAnimationFrameRequester={requestAnimationFrame:this.session.requestAnimationFrame.bind(this.session),renderFunction:function(n,r){e._sessionEnded||(e.currentFrame=r,e.currentTimestamp=n,r&&(t.framebufferDimensionsObject=e.baseLayer,e.onXRFrameObservable.notifyObservers(r),t._renderLoop(),t.framebufferDimensionsObject=null))}},this._xrNavigator.xr.native)this._rttProvider=this._xrNavigator.xr.getNativeRenderTargetProvider(this.session,this._createRenderTargetTexture.bind(this));else{var n=this._createRenderTargetTexture(this.baseLayer.framebufferWidth,this.baseLayer.framebufferHeight,this.baseLayer.framebuffer);this._rttProvider={getRenderTargetForEye:function(){return n}},t.framebufferDimensionsObject=this.baseLayer}"undefined"!=typeof window&&window.cancelAnimationFrame&&window.cancelAnimationFrame(t._frameHandler),t._renderLoop()},e.prototype.setReferenceSpaceTypeAsync=function(e){var t=this;return void 0===e&&(e="local-floor"),this.session.requestReferenceSpace(e).then((function(e){return e}),(function(e){return r.a.Error("XR.requestReferenceSpace failed for the following reason: "),r.a.Error(e),r.a.Log('Defaulting to universally-supported "viewer" reference space type.'),t.session.requestReferenceSpace("viewer").then((function(e){var n=new XRRigidTransform({x:0,y:-t.defaultHeightCompensation,z:0});return e.getOffsetReferenceSpace(n)}),(function(e){throw r.a.Error(e),'XR initialization failed: required "viewer" reference space type not supported.'}))})).then((function(e){return t.session.requestReferenceSpace("viewer").then((function(n){return t.viewerReferenceSpace=n,e}))})).then((function(e){return t.referenceSpace=t.baseReferenceSpace=e,t.referenceSpace}))},e.prototype.updateRenderStateAsync=function(e){return e.baseLayer&&(this.baseLayer=e.baseLayer),this.session.updateRenderState(e)},e.IsSessionSupportedAsync=function(e){if(!navigator.xr)return Promise.resolve(!1);var t=navigator.xr.isSessionSupported||navigator.xr.supportsSession;return t?t.call(navigator.xr,e).then((function(e){var t=void 0===e||e;return Promise.resolve(t)})).catch((function(e){return r.a.Warn(e),Promise.resolve(!1)})):Promise.resolve(!1)},e.prototype._createRenderTargetTexture=function(e,t,n){void 0===n&&(n=null);var r=new i.a(this.scene.getEngine(),i.b.Unknown,!0);r.width=e,r.height=t,r._framebuffer=n;var a=new s.a("XR renderTargetTexture",{width:e,height:t},this.scene,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0);return a._texture=r,a},e}()},148:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(0),a=function(){function e(){}return e.GetDefaults=function(t){var n=new e;return n.canvasOptions={antialias:!0,depth:!0,stencil:!t||t.isStencilEnable,alpha:!0,multiview:!1,framebufferScaleFactor:1},n.newCanvasCssStyle="position:absolute; bottom:0px;right:0px;z-index:10;width:90%;height:100%;background-color: #000000;",n},e}(),i=function(){function e(e,t){var n=this;if(void 0===t&&(t=a.GetDefaults()),this._options=t,this._canvas=null,this.xrLayer=null,this.onXRLayerInitObservable=new r.a,this._engine=e.scene.getEngine(),t.canvasElement)this._setManagedOutputCanvas(t.canvasElement);else{var i=document.createElement("canvas");i.style.cssText=this._options.newCanvasCssStyle||"position:absolute; bottom:0px;right:0px;",this._setManagedOutputCanvas(i)}e.onXRSessionInit.add((function(){n._addCanvas()})),e.onXRSessionEnded.add((function(){n._removeCanvas()}))}return e.prototype.dispose=function(){this._removeCanvas(),this._setManagedOutputCanvas(null)},e.prototype.initializeXRLayerAsync=function(e){var t=this,n=function(){var n=new XRWebGLLayer(e,t.canvasContext,t._options.canvasOptions);return t.onXRLayerInitObservable.notifyObservers(n),n};return this.canvasContext.makeXRCompatible?this.canvasContext.makeXRCompatible().then((function(){return t.xrLayer=n(),t.xrLayer})):(this.xrLayer=n(),Promise.resolve(this.xrLayer))},e.prototype._addCanvas=function(){var e=this;this._canvas&&this._canvas!==this._engine.getRenderingCanvas()&&document.body.appendChild(this._canvas),this.xrLayer?this._setCanvasSize(!0):this.onXRLayerInitObservable.addOnce((function(t){e._setCanvasSize(!0,t)}))},e.prototype._removeCanvas=function(){this._canvas&&document.body.contains(this._canvas)&&this._canvas!==this._engine.getRenderingCanvas()&&document.body.removeChild(this._canvas),this._setCanvasSize(!1)},e.prototype._setCanvasSize=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=this.xrLayer),this._canvas&&(e?t&&(this._canvas!==this._engine.getRenderingCanvas()?(this._canvas.style.width=t.framebufferWidth+"px",this._canvas.style.height=t.framebufferHeight+"px"):this._engine.setSize(t.framebufferWidth,t.framebufferHeight)):this._originalCanvasSize&&(this._canvas!==this._engine.getRenderingCanvas()?(this._canvas.style.width=this._originalCanvasSize.width+"px",this._canvas.style.height=this._originalCanvasSize.height+"px"):this._engine.setSize(this._originalCanvasSize.width,this._originalCanvasSize.height)))},e.prototype._setManagedOutputCanvas=function(e){this._removeCanvas(),e?(this._originalCanvasSize={width:e.offsetWidth,height:e.offsetHeight},this._canvas=e,this.canvasContext=this._canvas.getContext("webgl2"),this.canvasContext||(this.canvasContext=this._canvas.getContext("webgl"))):(this._canvas=null,this.canvasContext=null)},e}()},155:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(132),i=n(156),s=n(116),o=n(62),u=n(1),c=function(){function e(e){var t=this;this.scene=e,this._nonVRCamera=null,this._originalSceneAutoClear=!0,this._supported=!1,this.onInitialXRPoseSetObservable=new r.a,this.onStateChangedObservable=new r.a,this.state=s.a.NOT_IN_XR,this.sessionManager=new a.a(e),this.camera=new i.a("",e,this.sessionManager),this.featuresManager=new o.b(this.sessionManager),e.onDisposeObservable.add((function(){t.exitXRAsync()}))}return e.CreateAsync=function(t){var n=new e(t);return n.sessionManager.initializeAsync().then((function(){return n._supported=!0,n})).catch((function(e){throw n._setState(s.a.NOT_IN_XR),n.dispose(),e}))},e.prototype.dispose=function(){this.camera.dispose(),this.onStateChangedObservable.clear(),this.onInitialXRPoseSetObservable.clear(),this.sessionManager.dispose(),this._nonVRCamera&&(this.scene.activeCamera=this._nonVRCamera)},e.prototype.enterXRAsync=function(e,t,n,r){var a=this;if(void 0===n&&(n=this.sessionManager.getWebXRRenderTarget()),void 0===r&&(r={}),!this._supported)throw"WebXR not supported in this browser or environment";return this._setState(s.a.ENTERING_XR),"viewer"!==t&&"local"!==t&&(r.optionalFeatures=r.optionalFeatures||[],r.optionalFeatures.push(t)),this.featuresManager.extendXRSessionInitObject(r),"immersive-ar"===e&&"unbounded"!==t&&u.a.Warn("We recommend using 'unbounded' reference space type when using 'immersive-ar' session mode"),this.sessionManager.initializeSessionAsync(e,r).then((function(){return a.sessionManager.setReferenceSpaceTypeAsync(t)})).then((function(){return n.initializeXRLayerAsync(a.sessionManager.session)})).then((function(){return a.sessionManager.updateRenderStateAsync({depthFar:a.camera.maxZ,depthNear:a.camera.minZ,baseLayer:n.xrLayer})})).then((function(){return a.sessionManager.runXRRenderLoop(),a._originalSceneAutoClear=a.scene.autoClear,a._nonVRCamera=a.scene.activeCamera,a.scene.activeCamera=a.camera,"immersive-ar"!==e?a._nonXRToXRCamera():(a.scene.autoClear=!1,a.camera.compensateOnFirstFrame=!1),a.sessionManager.onXRSessionEnded.addOnce((function(){a.camera.rigCameras.forEach((function(e){e.outputRenderTarget=null})),a.scene.autoClear=a._originalSceneAutoClear,a.scene.activeCamera=a._nonVRCamera,"immersive-ar"!==e&&a.camera.compensateOnFirstFrame&&(a._nonVRCamera.setPosition?a._nonVRCamera.setPosition(a.camera.position):a._nonVRCamera.position.copyFrom(a.camera.position)),a._setState(s.a.NOT_IN_XR)})),a.sessionManager.onXRFrameObservable.addOnce((function(){a._setState(s.a.IN_XR)})),a.sessionManager})).catch((function(e){throw console.log(e),console.log(e.message),a._setState(s.a.NOT_IN_XR),e}))},e.prototype.exitXRAsync=function(){return this.state!==s.a.IN_XR?Promise.resolve():(this._setState(s.a.EXITING_XR),this.sessionManager.exitXRAsync())},e.prototype._nonXRToXRCamera=function(){this.camera.setTransformationFromNonVRCamera(this._nonVRCamera),this.onInitialXRPoseSetObservable.notifyObservers(this.camera)},e.prototype._setState=function(e){this.state!==e&&(this.state=e,this.onStateChangedObservable.notifyObservers(this.state))},e}()},156:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),a=n(34),i=n(45),s=n(66),o=n(92),u=n(86),c=n(0),h=function(e){function t(t,n,r){var s=e.call(this,t,a.e.Zero(),n)||this;return s._xrSessionManager=r,s._firstFrame=!1,s._referenceQuaternion=a.b.Identity(),s._referencedPosition=new a.e,s._xrInvPositionCache=new a.e,s._xrInvQuaternionCache=a.b.Identity(),s.onBeforeCameraTeleport=new c.a,s.onAfterCameraTeleport=new c.a,s.compensateOnFirstFrame=!0,s._rotate180=new a.b(0,1,0,0),s.minZ=.1,s.rotationQuaternion=new a.b,s.cameraRigMode=i.a.RIG_MODE_CUSTOM,s.updateUpVectorFromRotation=!0,s._updateNumberOfRigCameras(1),s.freezeProjectionMatrix(),s._xrSessionManager.onXRSessionInit.add((function(){s._referencedPosition.copyFromFloats(0,0,0),s._referenceQuaternion.copyFromFloats(0,0,0,1),s._firstFrame=s.compensateOnFirstFrame})),s._xrSessionManager.onXRFrameObservable.add((function(e){s._firstFrame&&s._updateFromXRSession(),s._updateReferenceSpace(),s._updateFromXRSession()}),void 0,!0),s}return Object(r.d)(t,e),Object.defineProperty(t.prototype,"realWorldHeight",{get:function(){var e=this._xrSessionManager.currentFrame&&this._xrSessionManager.currentFrame.getViewerPose(this._xrSessionManager.baseReferenceSpace);return e&&e.transform?e.transform.position.y:0},enumerable:!1,configurable:!0}),t.prototype._updateForDualEyeDebugging=function(){this._updateNumberOfRigCameras(2),this.rigCameras[0].viewport=new u.a(0,0,.5,1),this.rigCameras[0].outputRenderTarget=null,this.rigCameras[1].viewport=new u.a(.5,0,.5,1),this.rigCameras[1].outputRenderTarget=null},t.prototype.setTransformationFromNonVRCamera=function(e,t){(void 0===e&&(e=this.getScene().activeCamera),void 0===t&&(t=!0),e&&e!==this)&&(e.computeWorldMatrix().decompose(void 0,this.rotationQuaternion,this.position),this.position.y=0,a.b.FromEulerAnglesToRef(0,this.rotationQuaternion.toEulerAngles().y,0,this.rotationQuaternion),this._firstFrame=!0,t&&this._xrSessionManager.resetReferenceSpace())},t.prototype.getClassName=function(){return"WebXRCamera"},t.prototype._updateFromXRSession=function(){var e=this,t=this._xrSessionManager.currentFrame&&this._xrSessionManager.currentFrame.getViewerPose(this._xrSessionManager.referenceSpace);if(t){if(t.transform){var n=t.transform.position;this._referencedPosition.set(n.x,n.y,n.z);var r=t.transform.orientation;this._referenceQuaternion.set(r.x,r.y,r.z,r.w),this._scene.useRightHandedSystem||(this._referencedPosition.z*=-1,this._referenceQuaternion.z*=-1,this._referenceQuaternion.w*=-1),this._firstFrame?(this._firstFrame=!1,this.position.y+=this._referencedPosition.y,this._referenceQuaternion.copyFromFloats(0,0,0,1)):(this.rotationQuaternion.copyFrom(this._referenceQuaternion),this.position.copyFrom(this._referencedPosition))}this.rigCameras.length!==t.views.length&&this._updateNumberOfRigCameras(t.views.length),t.views.forEach((function(t,n){var r=e.rigCameras[n];r.isLeftCamera||r.isRightCamera||("right"===t.eye?r._isRightCamera=!0:"left"===t.eye&&(r._isLeftCamera=!0));var i=t.transform.position,s=t.transform.orientation;if(r.position.set(i.x,i.y,i.z),r.rotationQuaternion.set(s.x,s.y,s.z,s.w),e._scene.useRightHandedSystem?r.rotationQuaternion.multiplyInPlace(e._rotate180):(r.position.z*=-1,r.rotationQuaternion.z*=-1,r.rotationQuaternion.w*=-1),a.a.FromFloat32ArrayToRefScaled(t.projectionMatrix,0,1,r._projectionMatrix),e._scene.useRightHandedSystem||r._projectionMatrix.toggleProjectionMatrixHandInPlace(),0===n&&e._projectionMatrix.copyFrom(r._projectionMatrix),e._xrSessionManager.session.renderState.baseLayer){var o=e._xrSessionManager.session.renderState.baseLayer.getViewport(t),u=e._xrSessionManager.session.renderState.baseLayer.framebufferWidth,c=e._xrSessionManager.session.renderState.baseLayer.framebufferHeight;r.viewport.width=o.width/u,r.viewport.height=o.height/c,r.viewport.x=o.x/u,r.viewport.y=o.y/c}r.outputRenderTarget=e._xrSessionManager.getRenderTargetTextureForEye(t.eye)}))}},t.prototype._updateNumberOfRigCameras=function(e){for(void 0===e&&(e=1);this.rigCameras.length<e;){var t=new o.a("XR-RigCamera: "+this.rigCameras.length,a.e.Zero(),this.getScene());t.minZ=.1,t.rotationQuaternion=new a.b,t.updateUpVectorFromRotation=!0,t.isRigCamera=!0,t.rigParent=this,t.freezeProjectionMatrix(),this.rigCameras.push(t)}for(;this.rigCameras.length>e;){var n=this.rigCameras.pop();n&&n.dispose()}},t.prototype._updateReferenceSpace=function(){this.position.equals(this._referencedPosition)&&this.rotationQuaternion.equals(this._referenceQuaternion)||(this.position.subtractToRef(this._referencedPosition,this._referencedPosition),this._referenceQuaternion.conjugateInPlace(),this._referenceQuaternion.multiplyToRef(this.rotationQuaternion,this._referenceQuaternion),this._updateReferenceSpaceOffset(this._referencedPosition,this._referenceQuaternion.normalize()))},t.prototype._updateReferenceSpaceOffset=function(e,t,n){if(void 0===n&&(n=!1),this._xrSessionManager.referenceSpace&&this._xrSessionManager.currentFrame){this._xrInvPositionCache.copyFrom(e),t?this._xrInvQuaternionCache.copyFrom(t):this._xrInvQuaternionCache.copyFromFloats(0,0,0,1),this._scene.useRightHandedSystem||(this._xrInvPositionCache.z*=-1,this._xrInvQuaternionCache.z*=-1,this._xrInvQuaternionCache.w*=-1),this._xrInvPositionCache.negateInPlace(),this._xrInvQuaternionCache.conjugateInPlace(),this._xrInvPositionCache.rotateByQuaternionToRef(this._xrInvQuaternionCache,this._xrInvPositionCache),n&&(this._xrInvPositionCache.y=0);var r=new XRRigidTransform({x:this._xrInvPositionCache.x,y:this._xrInvPositionCache.y,z:this._xrInvPositionCache.z},{x:this._xrInvQuaternionCache.x,y:this._xrInvQuaternionCache.y,z:this._xrInvQuaternionCache.z,w:this._xrInvQuaternionCache.w}),i=this._xrSessionManager.referenceSpace.getOffsetReferenceSpace(r),s=this._xrSessionManager.currentFrame&&this._xrSessionManager.currentFrame.getViewerPose(i);if(s){var o=new a.e(s.transform.position.x,s.transform.position.y,s.transform.position.z);this._scene.useRightHandedSystem||(o.z*=-1),this.position.subtractToRef(o,o),this._scene.useRightHandedSystem||(o.z*=-1),o.negateInPlace();var u=new XRRigidTransform({x:o.x,y:o.y,z:o.z});this._xrSessionManager.referenceSpace=i.getOffsetReferenceSpace(u)}}},t}(s.a)},57:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(34),a=n(38),i=n(43);i.a.CreateSphere=function(e){for(var t=e.segments||32,n=e.diameterX||e.diameter||1,a=e.diameterY||e.diameter||1,s=e.diameterZ||e.diameter||1,o=e.arc&&(e.arc<=0||e.arc>1)?1:e.arc||1,u=e.slice&&e.slice<=0?1:e.slice||1,c=0===e.sideOrientation?0:e.sideOrientation||i.a.DEFAULTSIDE,h=new r.e(n/2,a/2,s/2),f=2+t,d=2*f,p=[],l=[],v=[],m=[],_=0;_<=f;_++){for(var g=_/f,b=g*Math.PI*u,R=0;R<=d;R++){var y=R/d,S=y*Math.PI*2*o,x=r.a.RotationZ(-b),C=r.a.RotationY(S),F=r.e.TransformCoordinates(r.e.Up(),x),w=r.e.TransformCoordinates(F,C),O=w.multiply(h),I=w.divide(h).normalize();l.push(O.x,O.y,O.z),v.push(I.x,I.y,I.z),m.push(y,g)}if(_>0)for(var X=l.length/3,E=X-2*(d+1);E+d+2<X;E++)_>1&&(p.push(E),p.push(E+1),p.push(E+d+1)),(_<f||u<1)&&(p.push(E+d+1),p.push(E+1),p.push(E+d+2))}i.a._ComputeSides(c,l,p,v,m,e.frontUVs,e.backUVs);var T=new i.a;return T.indices=p,T.positions=l,T.normals=v,T.uvs=m,T},a.a.CreateSphere=function(e,t,n,r,a,i){var o={segments:t,diameterX:n,diameterY:n,diameterZ:n,sideOrientation:i,updatable:a};return s.CreateSphere(e,o,r)};var s=function(){function e(){}return e.CreateSphere=function(e,t,n){void 0===n&&(n=null);var r=new a.a(e,n);return t.sideOrientation=a.a._GetDefaultSideOrientation(t.sideOrientation),r._originalBuilderSideOrientation=t.sideOrientation,i.a.CreateSphere(t).applyToMesh(r,t.updatable),r},e}()},62:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(41),a=function(){function e(){}return e.ANCHOR_SYSTEM="xr-anchor-system",e.BACKGROUND_REMOVER="xr-background-remover",e.HIT_TEST="xr-hit-test",e.PHYSICS_CONTROLLERS="xr-physics-controller",e.PLANE_DETECTION="xr-plane-detection",e.POINTER_SELECTION="xr-controller-pointer-selection",e.TELEPORTATION="xr-controller-teleportation",e.FEATURE_POINTS="xr-feature-points",e.HAND_TRACKING="xr-hand-tracking",e}(),i=function(){function e(e){var t=this;this._xrSessionManager=e,this._features={},this._xrSessionManager.onXRSessionInit.add((function(){t.getEnabledFeatures().forEach((function(e){var n=t._features[e];!n.enabled||n.featureImplementation.attached||n.featureImplementation.disableAutoAttach||t.attachFeature(e)}))})),this._xrSessionManager.onXRSessionEnded.add((function(){t.getEnabledFeatures().forEach((function(e){var n=t._features[e];n.enabled&&n.featureImplementation.attached&&t.detachFeature(e)}))}))}return e.AddWebXRFeature=function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=!1),this._AvailableFeatures[e]=this._AvailableFeatures[e]||{latest:n},n>this._AvailableFeatures[e].latest&&(this._AvailableFeatures[e].latest=n),r&&(this._AvailableFeatures[e].stable=n),this._AvailableFeatures[e][n]=t},e.ConstructFeature=function(e,t,n,r){void 0===t&&(t=1);var a=this._AvailableFeatures[e][t];if(!a)throw new Error("feature not found");return a(n,r)},e.GetAvailableFeatures=function(){return Object.keys(this._AvailableFeatures)},e.GetAvailableVersions=function(e){return Object.keys(this._AvailableFeatures[e])},e.GetLatestVersionOfFeature=function(e){return this._AvailableFeatures[e]&&this._AvailableFeatures[e].latest||-1},e.GetStableVersionOfFeature=function(e){return this._AvailableFeatures[e]&&this._AvailableFeatures[e].stable||-1},e.prototype.attachFeature=function(e){var t=this._features[e];t&&t.enabled&&!t.featureImplementation.attached&&t.featureImplementation.attach()},e.prototype.detachFeature=function(e){var t=this._features[e];t&&t.featureImplementation.attached&&t.featureImplementation.detach()},e.prototype.disableFeature=function(e){var t="string"==typeof e?e:e.Name,n=this._features[t];return!(!n||!n.enabled)&&(n.enabled=!1,this.detachFeature(t),n.featureImplementation.dispose(),!0)},e.prototype.dispose=function(){var e=this;this.getEnabledFeatures().forEach((function(t){e.disableFeature(t),e._features[t].featureImplementation.dispose()}))},e.prototype.enableFeature=function(t,n,a,i,s){var o=this;void 0===n&&(n="latest"),void 0===a&&(a={}),void 0===i&&(i=!0),void 0===s&&(s=!0);var u="string"==typeof t?t:t.Name,c=0;if("string"==typeof n){if(!n)throw new Error("Error in provided version - "+u+" ("+n+")");if(-1===(c="stable"===n?e.GetStableVersionOfFeature(u):"latest"===n?e.GetLatestVersionOfFeature(u):+n)||isNaN(c))throw new Error("feature not found - "+u+" ("+n+")")}else c=n;var h=this._features[u],f=e.ConstructFeature(u,c,this._xrSessionManager,a);if(!f)throw new Error("feature not found - "+u);h&&this.disableFeature(u);var d=f();if(d.dependsOn&&!d.dependsOn.every((function(e){return!!o._features[e]})))throw new Error("Dependant features missing. Make sure the following features are enabled - "+d.dependsOn.join(", "));if(d.isCompatible())return this._features[u]={featureImplementation:d,enabled:!0,version:c,required:s},i?this._xrSessionManager.session&&!h.featureImplementation.attached&&this.attachFeature(u):this._features[u].featureImplementation.disableAutoAttach=!0,this._features[u].featureImplementation;if(s)throw new Error("required feature not compatible");return r.b.Warn("Feature "+u+" not compatible with the current environment/browser and was not enabled."),d},e.prototype.getEnabledFeature=function(e){return this._features[e]&&this._features[e].featureImplementation},e.prototype.getEnabledFeatures=function(){return Object.keys(this._features)},e.prototype.extendXRSessionInitObject=function(e){var t=this;return this.getEnabledFeatures().forEach((function(n){var r=t._features[n],a=r.featureImplementation.xrNativeFeatureName;a&&(r.required?(e.requiredFeatures=e.requiredFeatures||[],-1===e.requiredFeatures.indexOf(a)&&e.requiredFeatures.push(a)):(e.optionalFeatures=e.optionalFeatures||[],-1===e.optionalFeatures.indexOf(a)&&e.optionalFeatures.push(a)))})),e},e._AvailableFeatures={},e}()}}]);
//# sourceMappingURL=6.babylonBundle.js.map