(window.webpackJsonp=window.webpackJsonp||[]).push([[0],Array(34).concat([function(t,e,i){"use strict";i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return c})),i.d(e,"f",(function(){return u})),i.d(e,"b",(function(){return l})),i.d(e,"a",(function(){return f})),i.d(e,"c",(function(){return p}));var r=i(46),n=i(60),o=i(85),s=i(35),a=i(17),h=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},t.prototype.getClassName=function(){return"Vector2"},t.prototype.getHashCode=function(){var t=0|this.x;return t=397*t^(0|this.y)},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.copyFromFloats=function(t,e){return this.x=t,this.y=e,this},t.prototype.set=function(t,e){return this.copyFromFloats(t,e)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.addToRef=function(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.addVector3=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.subtractToRef=function(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.multiply=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.multiplyToRef=function(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this},t.prototype.multiplyByFloats=function(e,i){return new t(this.x*e,this.y*i)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.divideToRef=function(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this},t.prototype.negateToRef=function(t){return t.copyFromFloats(-1*this.x,-1*this.y)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this},t.prototype.scale=function(e){var i=new t(0,0);return this.scaleToRef(e,i),i},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,this},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=n.a),t&&r.a.WithinEpsilon(this.x,t.x,e)&&r.a.WithinEpsilon(this.y,t.y,e)},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var t=this.length();return 0===t||(this.x/=t,this.y/=t),this},t.prototype.clone=function(){return new t(this.x,this.y)},t.Zero=function(){return new t(0,0)},t.One=function(){return new t(1,1)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1])},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1]},t.CatmullRom=function(e,i,r,n,o){var s=o*o,a=o*s;return new t(.5*(2*i.x+(-e.x+r.x)*o+(2*e.x-5*i.x+4*r.x-n.x)*s+(-e.x+3*i.x-3*r.x+n.x)*a),.5*(2*i.y+(-e.y+r.y)*o+(2*e.y-5*i.y+4*r.y-n.y)*s+(-e.y+3*i.y-3*r.y+n.y)*a))},t.Clamp=function(e,i,r){var n=e.x;n=(n=n>r.x?r.x:n)<i.x?i.x:n;var o=e.y;return new t(n,o=(o=o>r.y?r.y:o)<i.y?i.y:o)},t.Hermite=function(e,i,r,n,o){var s=o*o,a=o*s,h=2*a-3*s+1,c=-2*a+3*s,u=a-2*s+o,l=a-s;return new t(e.x*h+r.x*c+i.x*u+n.x*l,e.y*h+r.y*c+i.y*u+n.y*l)},t.Lerp=function(e,i,r){return new t(e.x+(i.x-e.x)*r,e.y+(i.y-e.y)*r)},t.Dot=function(t,e){return t.x*e.x+t.y*e.y},t.Normalize=function(t){var e=t.clone();return e.normalize(),e},t.Minimize=function(e,i){return new t(e.x<i.x?e.x:i.x,e.y<i.y?e.y:i.y)},t.Maximize=function(e,i){return new t(e.x>i.x?e.x:i.x,e.y>i.y?e.y:i.y)},t.Transform=function(e,i){var r=t.Zero();return t.TransformToRef(e,i,r),r},t.TransformToRef=function(t,e,i){var r=e.m,n=t.x*r[0]+t.y*r[4]+r[12],o=t.x*r[1]+t.y*r[5]+r[13];i.x=n,i.y=o},t.PointInTriangle=function(t,e,i,r){var n=.5*(-i.y*r.x+e.y*(-i.x+r.x)+e.x*(i.y-r.y)+i.x*r.y),o=n<0?-1:1,s=(e.y*r.x-e.x*r.y+(r.y-e.y)*t.x+(e.x-r.x)*t.y)*o,a=(e.x*i.y-e.y*i.x+(e.y-i.y)*t.x+(i.x-e.x)*t.y)*o;return s>0&&a>0&&s+a<2*n*o},t.Distance=function(e,i){return Math.sqrt(t.DistanceSquared(e,i))},t.DistanceSquared=function(t,e){var i=t.x-e.x,r=t.y-e.y;return i*i+r*r},t.Center=function(t,e){var i=t.add(e);return i.scaleInPlace(.5),i},t.DistanceOfPointFromSegment=function(e,i,r){var n=t.DistanceSquared(i,r);if(0===n)return t.Distance(e,i);var o=r.subtract(i),s=Math.max(0,Math.min(1,t.Dot(e.subtract(i),o)/n)),a=i.add(o.multiplyByFloats(s,s));return t.Distance(e,a)},t}(),c=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._isDirty=!0,this._x=t,this._y=e,this._z=i}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this._isDirty=!0},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"{X: "+this._x+" Y:"+this._y+" Z:"+this._z+"}"},t.prototype.getClassName=function(){return"Vector3"},t.prototype.getHashCode=function(){var t=0|this._x;return t=397*(t=397*t^(0|this._y))^(0|this._z)},t.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.toQuaternion=function(){return l.RotationYawPitchRoll(this._y,this._x,this._z)},t.prototype.addInPlace=function(t){return this.addInPlaceFromFloats(t._x,t._y,t._z)},t.prototype.addInPlaceFromFloats=function(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this},t.prototype.add=function(e){return new t(this._x+e._x,this._y+e._y,this._z+e._z)},t.prototype.addToRef=function(t,e){return e.copyFromFloats(this._x+t._x,this._y+t._y,this._z+t._z)},t.prototype.subtractInPlace=function(t){return this.x-=t._x,this.y-=t._y,this.z-=t._z,this},t.prototype.subtract=function(e){return new t(this._x-e._x,this._y-e._y,this._z-e._z)},t.prototype.subtractToRef=function(t,e){return this.subtractFromFloatsToRef(t._x,t._y,t._z,e)},t.prototype.subtractFromFloats=function(e,i,r){return new t(this._x-e,this._y-i,this._z-r)},t.prototype.subtractFromFloatsToRef=function(t,e,i,r){return r.copyFromFloats(this._x-t,this._y-e,this._z-i)},t.prototype.negate=function(){return new t(-this._x,-this._y,-this._z)},t.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.negateToRef=function(t){return t.copyFromFloats(-1*this._x,-1*this._y,-1*this._z)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.scale=function(e){return new t(this._x*e,this._y*e,this._z*e)},t.prototype.scaleToRef=function(t,e){return e.copyFromFloats(this._x*t,this._y*t,this._z*t)},t.prototype.scaleAndAddToRef=function(t,e){return e.addInPlaceFromFloats(this._x*t,this._y*t,this._z*t)},t.prototype.projectOnPlane=function(e,i){var r=t.Zero();return this.projectOnPlaneToRef(e,i,r),r},t.prototype.projectOnPlaneToRef=function(e,i,r){var n=e.normal,o=e.d,s=d.Vector3[0];this.subtractToRef(i,s),s.normalize();var a=t.Dot(s,n),h=-(t.Dot(i,n)+o)/a,c=s.scaleInPlace(h);i.addToRef(c,r)},t.prototype.equals=function(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=n.a),t&&r.a.WithinEpsilon(this._x,t._x,e)&&r.a.WithinEpsilon(this._y,t._y,e)&&r.a.WithinEpsilon(this._z,t._z,e)},t.prototype.equalsToFloats=function(t,e,i){return this._x===t&&this._y===e&&this._z===i},t.prototype.multiplyInPlace=function(t){return this.x*=t._x,this.y*=t._y,this.z*=t._z,this},t.prototype.multiply=function(t){return this.multiplyByFloats(t._x,t._y,t._z)},t.prototype.multiplyToRef=function(t,e){return e.copyFromFloats(this._x*t._x,this._y*t._y,this._z*t._z)},t.prototype.multiplyByFloats=function(e,i,r){return new t(this._x*e,this._y*i,this._z*r)},t.prototype.divide=function(e){return new t(this._x/e._x,this._y/e._y,this._z/e._z)},t.prototype.divideToRef=function(t,e){return e.copyFromFloats(this._x/t._x,this._y/t._y,this._z/t._z)},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.minimizeInPlace=function(t){return this.minimizeInPlaceFromFloats(t._x,t._y,t._z)},t.prototype.maximizeInPlace=function(t){return this.maximizeInPlaceFromFloats(t._x,t._y,t._z)},t.prototype.minimizeInPlaceFromFloats=function(t,e,i){return t<this._x&&(this.x=t),e<this._y&&(this.y=e),i<this._z&&(this.z=i),this},t.prototype.maximizeInPlaceFromFloats=function(t,e,i){return t>this._x&&(this.x=t),e>this._y&&(this.y=e),i>this._z&&(this.z=i),this},t.prototype.isNonUniformWithinEpsilon=function(t){var e=Math.abs(this._x),i=Math.abs(this._y);if(!r.a.WithinEpsilon(e,i,t))return!0;var n=Math.abs(this._z);return!r.a.WithinEpsilon(e,n,t)||!r.a.WithinEpsilon(i,n,t)},Object.defineProperty(t.prototype,"isNonUniform",{get:function(){var t=Math.abs(this._x);return t!==Math.abs(this._y)||t!==Math.abs(this._z)},enumerable:!1,configurable:!0}),t.prototype.floor=function(){return new t(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))},t.prototype.fract=function(){return new t(this._x-Math.floor(this._x),this._y-Math.floor(this._y),this._z-Math.floor(this._z))},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)},t.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z},t.prototype.normalize=function(){return this.normalizeFromLength(this.length())},t.prototype.reorderInPlace=function(t){var e=this;return"xyz"===(t=t.toLowerCase())||(d.Vector3[0].copyFrom(this),["x","y","z"].forEach((function(i,r){e[i]=d.Vector3[0][t[r]]}))),this},t.prototype.rotateByQuaternionToRef=function(e,i){return e.toRotationMatrix(d.Matrix[0]),t.TransformCoordinatesToRef(this,d.Matrix[0],i),i},t.prototype.rotateByQuaternionAroundPointToRef=function(t,e,i){return this.subtractToRef(e,d.Vector3[0]),d.Vector3[0].rotateByQuaternionToRef(t,d.Vector3[0]),e.addToRef(d.Vector3[0],i),i},t.prototype.cross=function(e){return t.Cross(this,e)},t.prototype.normalizeFromLength=function(t){return 0===t||1===t?this:this.scaleInPlace(1/t)},t.prototype.normalizeToNew=function(){var e=new t(0,0,0);return this.normalizeToRef(e),e},t.prototype.normalizeToRef=function(t){var e=this.length();return 0===e||1===e?t.copyFromFloats(this._x,this._y,this._z):this.scaleToRef(1/e,t)},t.prototype.clone=function(){return new t(this._x,this._y,this._z)},t.prototype.copyFrom=function(t){return this.copyFromFloats(t._x,t._y,t._z)},t.prototype.copyFromFloats=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},t.prototype.set=function(t,e,i){return this.copyFromFloats(t,e,i)},t.prototype.setAll=function(t){return this.x=this.y=this.z=t,this},t.GetClipFactor=function(e,i,r,n){var o=t.Dot(e,r)-n;return o/(o-(t.Dot(i,r)-n))},t.GetAngleBetweenVectors=function(e,i,r){var n=e.normalizeToRef(d.Vector3[1]),o=i.normalizeToRef(d.Vector3[2]),s=t.Dot(n,o),a=d.Vector3[3];return t.CrossToRef(n,o,a),t.Dot(a,r)>0?Math.acos(s):-Math.acos(s)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1],e[i+2])},t.FromFloatArray=function(e,i){return t.FromArray(e,i)},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2]},t.FromFloatArrayToRef=function(e,i,r){return t.FromArrayToRef(e,i,r)},t.FromFloatsToRef=function(t,e,i,r){r.copyFromFloats(t,e,i)},t.Zero=function(){return new t(0,0,0)},t.One=function(){return new t(1,1,1)},t.Up=function(){return new t(0,1,0)},Object.defineProperty(t,"UpReadOnly",{get:function(){return t._UpReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ZeroReadOnly",{get:function(){return t._ZeroReadOnly},enumerable:!1,configurable:!0}),t.Down=function(){return new t(0,-1,0)},t.Forward=function(e){return void 0===e&&(e=!1),new t(0,0,e?-1:1)},t.Backward=function(e){return void 0===e&&(e=!1),new t(0,0,e?1:-1)},t.Right=function(){return new t(1,0,0)},t.Left=function(){return new t(-1,0,0)},t.TransformCoordinates=function(e,i){var r=t.Zero();return t.TransformCoordinatesToRef(e,i,r),r},t.TransformCoordinatesToRef=function(e,i,r){t.TransformCoordinatesFromFloatsToRef(e._x,e._y,e._z,i,r)},t.TransformCoordinatesFromFloatsToRef=function(t,e,i,r,n){var o=r.m,s=t*o[0]+e*o[4]+i*o[8]+o[12],a=t*o[1]+e*o[5]+i*o[9]+o[13],h=t*o[2]+e*o[6]+i*o[10]+o[14],c=1/(t*o[3]+e*o[7]+i*o[11]+o[15]);n.x=s*c,n.y=a*c,n.z=h*c},t.TransformNormal=function(e,i){var r=t.Zero();return t.TransformNormalToRef(e,i,r),r},t.TransformNormalToRef=function(t,e,i){this.TransformNormalFromFloatsToRef(t._x,t._y,t._z,e,i)},t.TransformNormalFromFloatsToRef=function(t,e,i,r,n){var o=r.m;n.x=t*o[0]+e*o[4]+i*o[8],n.y=t*o[1]+e*o[5]+i*o[9],n.z=t*o[2]+e*o[6]+i*o[10]},t.CatmullRom=function(e,i,r,n,o){var s=o*o,a=o*s;return new t(.5*(2*i._x+(-e._x+r._x)*o+(2*e._x-5*i._x+4*r._x-n._x)*s+(-e._x+3*i._x-3*r._x+n._x)*a),.5*(2*i._y+(-e._y+r._y)*o+(2*e._y-5*i._y+4*r._y-n._y)*s+(-e._y+3*i._y-3*r._y+n._y)*a),.5*(2*i._z+(-e._z+r._z)*o+(2*e._z-5*i._z+4*r._z-n._z)*s+(-e._z+3*i._z-3*r._z+n._z)*a))},t.Clamp=function(e,i,r){var n=new t;return t.ClampToRef(e,i,r,n),n},t.ClampToRef=function(t,e,i,r){var n=t._x;n=(n=n>i._x?i._x:n)<e._x?e._x:n;var o=t._y;o=(o=o>i._y?i._y:o)<e._y?e._y:o;var s=t._z;s=(s=s>i._z?i._z:s)<e._z?e._z:s,r.copyFromFloats(n,o,s)},t.CheckExtends=function(t,e,i){e.minimizeInPlace(t),i.maximizeInPlace(t)},t.Hermite=function(e,i,r,n,o){var s=o*o,a=o*s,h=2*a-3*s+1,c=-2*a+3*s,u=a-2*s+o,l=a-s;return new t(e._x*h+r._x*c+i._x*u+n._x*l,e._y*h+r._y*c+i._y*u+n._y*l,e._z*h+r._z*c+i._z*u+n._z*l)},t.Lerp=function(e,i,r){var n=new t(0,0,0);return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){r.x=t._x+(e._x-t._x)*i,r.y=t._y+(e._y-t._y)*i,r.z=t._z+(e._z-t._z)*i},t.Dot=function(t,e){return t._x*e._x+t._y*e._y+t._z*e._z},t.Cross=function(e,i){var r=t.Zero();return t.CrossToRef(e,i,r),r},t.CrossToRef=function(t,e,i){var r=t._y*e._z-t._z*e._y,n=t._z*e._x-t._x*e._z,o=t._x*e._y-t._y*e._x;i.copyFromFloats(r,n,o)},t.Normalize=function(e){var i=t.Zero();return t.NormalizeToRef(e,i),i},t.NormalizeToRef=function(t,e){t.normalizeToRef(e)},t.Project=function(e,i,r,n){var o=n.width,s=n.height,a=n.x,h=n.y,c=d.Matrix[1];f.FromValuesToRef(o/2,0,0,0,0,-s/2,0,0,0,0,.5,0,a+o/2,s/2+h,.5,1,c);var u=d.Matrix[0];return i.multiplyToRef(r,u),u.multiplyToRef(c,u),t.TransformCoordinates(e,u)},t._UnprojectFromInvertedMatrixToRef=function(e,i,n){t.TransformCoordinatesToRef(e,i,n);var o=i.m,s=e._x*o[3]+e._y*o[7]+e._z*o[11]+o[15];r.a.WithinEpsilon(s,1)&&n.scaleInPlace(1/s)},t.UnprojectFromTransform=function(e,i,r,n,o){var s=d.Matrix[0];n.multiplyToRef(o,s),s.invert(),e.x=e._x/i*2-1,e.y=-(e._y/r*2-1);var a=new t;return t._UnprojectFromInvertedMatrixToRef(e,s,a),a},t.Unproject=function(e,i,r,n,o,s){var a=t.Zero();return t.UnprojectToRef(e,i,r,n,o,s,a),a},t.UnprojectToRef=function(e,i,r,n,o,s,a){t.UnprojectFloatsToRef(e._x,e._y,e._z,i,r,n,o,s,a)},t.UnprojectFloatsToRef=function(e,i,r,n,o,s,a,h,c){var u=d.Matrix[0];s.multiplyToRef(a,u),u.multiplyToRef(h,u),u.invert();var l=d.Vector3[0];l.x=e/n*2-1,l.y=-(i/o*2-1),l.z=2*r-1,t._UnprojectFromInvertedMatrixToRef(l,u,c)},t.Minimize=function(t,e){var i=t.clone();return i.minimizeInPlace(e),i},t.Maximize=function(t,e){var i=t.clone();return i.maximizeInPlace(e),i},t.Distance=function(e,i){return Math.sqrt(t.DistanceSquared(e,i))},t.DistanceSquared=function(t,e){var i=t._x-e._x,r=t._y-e._y,n=t._z-e._z;return i*i+r*r+n*n},t.Center=function(t,e){var i=t.add(e);return i.scaleInPlace(.5),i},t.RotationFromAxis=function(e,i,r){var n=t.Zero();return t.RotationFromAxisToRef(e,i,r,n),n},t.RotationFromAxisToRef=function(t,e,i,r){var n=d.Quaternion[0];l.RotationQuaternionFromAxisToRef(t,e,i,n),n.toEulerAnglesToRef(r)},t._UpReadOnly=t.Up(),t._ZeroReadOnly=t.Zero(),t}(),u=function(){function t(t,e,i,r){this.x=t,this.y=e,this.z=i,this.w=r}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},t.prototype.getClassName=function(){return"Vector4"},t.prototype.getHashCode=function(){var t=0|this.x;return t=397*(t=397*(t=397*t^(0|this.y))^(0|this.z))^(0|this.w)},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},t.prototype.addToRef=function(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},t.prototype.subtractToRef=function(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this},t.prototype.subtractFromFloats=function(e,i,r,n){return new t(this.x-e,this.y-i,this.z-r,this.w-n)},t.prototype.subtractFromFloatsToRef=function(t,e,i,r,n){return n.x=this.x-t,n.y=this.y-e,n.z=this.z-i,n.w=this.w-r,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this},t.prototype.negateToRef=function(t){return t.copyFromFloats(-1*this.x,-1*this.y,-1*this.z,-1*this.w)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e,this.w*e)},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=n.a),t&&r.a.WithinEpsilon(this.x,t.x,e)&&r.a.WithinEpsilon(this.y,t.y,e)&&r.a.WithinEpsilon(this.z,t.z,e)&&r.a.WithinEpsilon(this.w,t.w,e)},t.prototype.equalsToFloats=function(t,e,i,r){return this.x===t&&this.y===e&&this.z===i&&this.w===r},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},t.prototype.multiply=function(e){return new t(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)},t.prototype.multiplyToRef=function(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this},t.prototype.multiplyByFloats=function(e,i,r,n){return new t(this.x*e,this.y*i,this.z*r,this.w*n)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)},t.prototype.divideToRef=function(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.minimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this},t.prototype.maximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.normalize=function(){var t=this.length();return 0===t?this:this.scaleInPlace(1/t)},t.prototype.toVector3=function(){return new c(this.x,this.y,this.z)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.prototype.copyFromFloats=function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},t.prototype.set=function(t,e,i,r){return this.copyFromFloats(t,e,i,r)},t.prototype.setAll=function(t){return this.x=this.y=this.z=this.w=t,this},t.FromArray=function(e,i){return i||(i=0),new t(e[i],e[i+1],e[i+2],e[i+3])},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]},t.FromFloatArrayToRef=function(e,i,r){t.FromArrayToRef(e,i,r)},t.FromFloatsToRef=function(t,e,i,r,n){n.x=t,n.y=e,n.z=i,n.w=r},t.Zero=function(){return new t(0,0,0,0)},t.One=function(){return new t(1,1,1,1)},t.Normalize=function(e){var i=t.Zero();return t.NormalizeToRef(e,i),i},t.NormalizeToRef=function(t,e){e.copyFrom(t),e.normalize()},t.Minimize=function(t,e){var i=t.clone();return i.minimizeInPlace(e),i},t.Maximize=function(t,e){var i=t.clone();return i.maximizeInPlace(e),i},t.Distance=function(e,i){return Math.sqrt(t.DistanceSquared(e,i))},t.DistanceSquared=function(t,e){var i=t.x-e.x,r=t.y-e.y,n=t.z-e.z,o=t.w-e.w;return i*i+r*r+n*n+o*o},t.Center=function(t,e){var i=t.add(e);return i.scaleInPlace(.5),i},t.TransformNormal=function(e,i){var r=t.Zero();return t.TransformNormalToRef(e,i,r),r},t.TransformNormalToRef=function(t,e,i){var r=e.m,n=t.x*r[0]+t.y*r[4]+t.z*r[8],o=t.x*r[1]+t.y*r[5]+t.z*r[9],s=t.x*r[2]+t.y*r[6]+t.z*r[10];i.x=n,i.y=o,i.z=s,i.w=t.w},t.TransformNormalFromFloatsToRef=function(t,e,i,r,n,o){var s=n.m;o.x=t*s[0]+e*s[4]+i*s[8],o.y=t*s[1]+e*s[5]+i*s[9],o.z=t*s[2]+e*s[6]+i*s[10],o.w=r},t.FromVector3=function(e,i){return void 0===i&&(i=0),new t(e._x,e._y,e._z,i)},t}(),l=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),this._isDirty=!0,this._x=t,this._y=e,this._z=i,this._w=r}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._w},set:function(t){this._w=t,this._isDirty=!0},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"{X: "+this._x+" Y:"+this._y+" Z:"+this._z+" W:"+this._w+"}"},t.prototype.getClassName=function(){return"Quaternion"},t.prototype.getHashCode=function(){var t=0|this._x;return t=397*(t=397*(t=397*t^(0|this._y))^(0|this._z))^(0|this._w)},t.prototype.asArray=function(){return[this._x,this._y,this._z,this._w]},t.prototype.equals=function(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z&&this._w===t._w},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=n.a),t&&r.a.WithinEpsilon(this._x,t._x,e)&&r.a.WithinEpsilon(this._y,t._y,e)&&r.a.WithinEpsilon(this._z,t._z,e)&&r.a.WithinEpsilon(this._w,t._w,e)},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._w)},t.prototype.copyFrom=function(t){return this.x=t._x,this.y=t._y,this.z=t._z,this.w=t._w,this},t.prototype.copyFromFloats=function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},t.prototype.set=function(t,e,i,r){return this.copyFromFloats(t,e,i,r)},t.prototype.add=function(e){return new t(this._x+e._x,this._y+e._y,this._z+e._z,this._w+e._w)},t.prototype.addInPlace=function(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._w+=t._w,this},t.prototype.subtract=function(e){return new t(this._x-e._x,this._y-e._y,this._z-e._z,this._w-e._w)},t.prototype.scale=function(e){return new t(this._x*e,this._y*e,this._z*e,this._w*e)},t.prototype.scaleToRef=function(t,e){return e.x=this._x*t,e.y=this._y*t,e.z=this._z*t,e.w=this._w*t,this},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this._x*t,e.y+=this._y*t,e.z+=this._z*t,e.w+=this._w*t,this},t.prototype.multiply=function(e){var i=new t(0,0,0,1);return this.multiplyToRef(e,i),i},t.prototype.multiplyToRef=function(t,e){var i=this._x*t._w+this._y*t._z-this._z*t._y+this._w*t._x,r=-this._x*t._z+this._y*t._w+this._z*t._x+this._w*t._y,n=this._x*t._y-this._y*t._x+this._z*t._w+this._w*t._z,o=-this._x*t._x-this._y*t._y-this._z*t._z+this._w*t._w;return e.copyFromFloats(i,r,n,o),this},t.prototype.multiplyInPlace=function(t){return this.multiplyToRef(t,this),this},t.prototype.conjugateToRef=function(t){return t.copyFromFloats(-this._x,-this._y,-this._z,this._w),this},t.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.conjugate=function(){return new t(-this._x,-this._y,-this._z,this._w)},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.prototype.normalize=function(){var t=this.length();if(0===t)return this;var e=1/t;return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.prototype.toEulerAngles=function(t){void 0===t&&(t="YZX");var e=c.Zero();return this.toEulerAnglesToRef(e),e},t.prototype.toEulerAnglesToRef=function(t){var e=this._z,i=this._x,r=this._y,n=this._w,o=n*n,s=e*e,a=i*i,h=r*r,c=r*e-i*n;return c<-.4999999?(t.y=2*Math.atan2(r,n),t.x=Math.PI/2,t.z=0):c>.4999999?(t.y=2*Math.atan2(r,n),t.x=-Math.PI/2,t.z=0):(t.z=Math.atan2(2*(i*r+e*n),-s-a+h+o),t.x=Math.asin(-2*(e*r-i*n)),t.y=Math.atan2(2*(e*i+r*n),s-a-h+o)),this},t.prototype.toRotationMatrix=function(t){return f.FromQuaternionToRef(this,t),this},t.prototype.fromRotationMatrix=function(e){return t.FromRotationMatrixToRef(e,this),this},t.FromRotationMatrix=function(e){var i=new t;return t.FromRotationMatrixToRef(e,i),i},t.FromRotationMatrixToRef=function(t,e){var i,r=t.m,n=r[0],o=r[4],s=r[8],a=r[1],h=r[5],c=r[9],u=r[2],l=r[6],f=r[10],d=n+h+f;d>0?(i=.5/Math.sqrt(d+1),e.w=.25/i,e.x=(l-c)*i,e.y=(s-u)*i,e.z=(a-o)*i):n>h&&n>f?(i=2*Math.sqrt(1+n-h-f),e.w=(l-c)/i,e.x=.25*i,e.y=(o+a)/i,e.z=(s+u)/i):h>f?(i=2*Math.sqrt(1+h-n-f),e.w=(s-u)/i,e.x=(o+a)/i,e.y=.25*i,e.z=(c+l)/i):(i=2*Math.sqrt(1+f-n-h),e.w=(a-o)/i,e.x=(s+u)/i,e.y=(c+l)/i,e.z=.25*i)},t.Dot=function(t,e){return t._x*e._x+t._y*e._y+t._z*e._z+t._w*e._w},t.AreClose=function(e,i){return t.Dot(e,i)>=0},t.Zero=function(){return new t(0,0,0,0)},t.Inverse=function(e){return new t(-e._x,-e._y,-e._z,e._w)},t.InverseToRef=function(t,e){return e.set(-t._x,-t._y,-t._z,t._w),e},t.Identity=function(){return new t(0,0,0,1)},t.IsIdentity=function(t){return t&&0===t._x&&0===t._y&&0===t._z&&1===t._w},t.RotationAxis=function(e,i){return t.RotationAxisToRef(e,i,new t)},t.RotationAxisToRef=function(t,e,i){var r=Math.sin(e/2);return t.normalize(),i.w=Math.cos(e/2),i.x=t._x*r,i.y=t._y*r,i.z=t._z*r,i},t.FromArray=function(e,i){return i||(i=0),new t(e[i],e[i+1],e[i+2],e[i+3])},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]},t.FromEulerAngles=function(e,i,r){var n=new t;return t.RotationYawPitchRollToRef(i,e,r,n),n},t.FromEulerAnglesToRef=function(e,i,r,n){return t.RotationYawPitchRollToRef(i,e,r,n),n},t.FromEulerVector=function(e){var i=new t;return t.RotationYawPitchRollToRef(e._y,e._x,e._z,i),i},t.FromEulerVectorToRef=function(e,i){return t.RotationYawPitchRollToRef(e._y,e._x,e._z,i),i},t.RotationYawPitchRoll=function(e,i,r){var n=new t;return t.RotationYawPitchRollToRef(e,i,r,n),n},t.RotationYawPitchRollToRef=function(t,e,i,r){var n=.5*i,o=.5*e,s=.5*t,a=Math.sin(n),h=Math.cos(n),c=Math.sin(o),u=Math.cos(o),l=Math.sin(s),f=Math.cos(s);r.x=f*c*h+l*u*a,r.y=l*u*h-f*c*a,r.z=f*u*a-l*c*h,r.w=f*u*h+l*c*a},t.RotationAlphaBetaGamma=function(e,i,r){var n=new t;return t.RotationAlphaBetaGammaToRef(e,i,r,n),n},t.RotationAlphaBetaGammaToRef=function(t,e,i,r){var n=.5*(i+t),o=.5*(i-t),s=.5*e;r.x=Math.cos(o)*Math.sin(s),r.y=Math.sin(o)*Math.sin(s),r.z=Math.sin(n)*Math.cos(s),r.w=Math.cos(n)*Math.cos(s)},t.RotationQuaternionFromAxis=function(e,i,r){var n=new t(0,0,0,0);return t.RotationQuaternionFromAxisToRef(e,i,r,n),n},t.RotationQuaternionFromAxisToRef=function(e,i,r,n){var o=d.Matrix[0];f.FromXYZAxesToRef(e.normalize(),i.normalize(),r.normalize(),o),t.FromRotationMatrixToRef(o,n)},t.Slerp=function(e,i,r){var n=t.Identity();return t.SlerpToRef(e,i,r,n),n},t.SlerpToRef=function(t,e,i,r){var n,o,s=t._x*e._x+t._y*e._y+t._z*e._z+t._w*e._w,a=!1;if(s<0&&(a=!0,s=-s),s>.999999)o=1-i,n=a?-i:i;else{var h=Math.acos(s),c=1/Math.sin(h);o=Math.sin((1-i)*h)*c,n=a?-Math.sin(i*h)*c:Math.sin(i*h)*c}r.x=o*t._x+n*e._x,r.y=o*t._y+n*e._y,r.z=o*t._z+n*e._z,r.w=o*t._w+n*e._w},t.Hermite=function(e,i,r,n,o){var s=o*o,a=o*s,h=2*a-3*s+1,c=-2*a+3*s,u=a-2*s+o,l=a-s;return new t(e._x*h+r._x*c+i._x*u+n._x*l,e._y*h+r._y*c+i._y*u+n._y*l,e._z*h+r._z*c+i._z*u+n._z*l,e._w*h+r._w*c+i._w*u+n._w*l)},t}(),f=function(){function t(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,a.a.MatrixTrackPrecisionChange&&a.a.MatrixTrackedMatrices.push(this),this._m=new a.a.MatrixCurrentType(16),this._updateIdentityStatus(!1)}return Object.defineProperty(t,"Use64Bits",{get:function(){return a.a.MatrixUse64Bits},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"m",{get:function(){return this._m},enumerable:!1,configurable:!0}),t.prototype._markAsUpdated=function(){this.updateFlag=t._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},t.prototype._updateIdentityStatus=function(e,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=!0),this.updateFlag=t._updateFlagSeed++,this._isIdentity=e,this._isIdentity3x2=e||r,this._isIdentityDirty=!this._isIdentity&&i,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n},t.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity},t.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},t.prototype.determinant=function(){if(!0===this._isIdentity)return 1;var t=this._m,e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],s=t[5],a=t[6],h=t[7],c=t[8],u=t[9],l=t[10],f=t[11],d=t[12],p=t[13],_=t[14],g=t[15],m=l*g-_*f,y=u*g-p*f,b=u*_-p*l,v=c*g-d*f,M=c*_-l*d,O=c*p-d*u;return e*+(s*m-a*y+h*b)+i*-(o*m-a*v+h*M)+r*+(o*y-s*v+h*O)+n*-(o*b-s*M+a*O)},t.prototype.toArray=function(){return this._m},t.prototype.asArray=function(){return this._m},t.prototype.invert=function(){return this.invertToRef(this),this},t.prototype.reset=function(){return t.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},t.prototype.add=function(e){var i=new t;return this.addToRef(e,i),i},t.prototype.addToRef=function(t,e){for(var i=this._m,r=e._m,n=t.m,o=0;o<16;o++)r[o]=i[o]+n[o];return e._markAsUpdated(),this},t.prototype.addToSelf=function(t){for(var e=this._m,i=t.m,r=0;r<16;r++)e[r]+=i[r];return this._markAsUpdated(),this},t.prototype.invertToRef=function(e){if(!0===this._isIdentity)return t.IdentityToRef(e),this;var i=this._m,r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],h=i[5],c=i[6],u=i[7],l=i[8],f=i[9],d=i[10],p=i[11],_=i[12],g=i[13],m=i[14],y=i[15],b=d*y-m*p,v=f*y-g*p,M=f*m-g*d,O=l*y-_*p,A=l*m-d*_,P=l*g-_*f,x=+(h*b-c*v+u*M),T=-(a*b-c*O+u*A),I=+(a*v-h*O+u*P),R=-(a*M-h*A+c*P),C=r*x+n*T+o*I+s*R;if(0===C)return e.copyFrom(this),this;var D=1/C,S=c*y-m*u,E=h*y-g*u,w=h*m-g*c,F=a*y-_*u,B=a*m-_*c,N=a*g-_*h,L=c*p-d*u,k=h*p-f*u,U=h*d-f*c,V=a*p-l*u,j=a*d-l*c,z=a*f-l*h,K=-(n*b-o*v+s*M),W=+(r*b-o*O+s*A),G=-(r*v-n*O+s*P),Y=+(r*M-n*A+o*P),H=+(n*S-o*E+s*w),q=-(r*S-o*F+s*B),Q=+(r*E-n*F+s*N),X=-(r*w-n*B+o*N),Z=-(n*L-o*k+s*U),J=+(r*L-o*V+s*j),$=-(r*k-n*V+s*z),tt=+(r*U-n*j+o*z);return t.FromValuesToRef(x*D,K*D,H*D,Z*D,T*D,W*D,q*D,J*D,I*D,G*D,Q*D,$*D,R*D,Y*D,X*D,tt*D,e),this},t.prototype.addAtIndex=function(t,e){return this._m[t]+=e,this._markAsUpdated(),this},t.prototype.multiplyAtIndex=function(t,e){return this._m[t]*=e,this._markAsUpdated(),this},t.prototype.setTranslationFromFloats=function(t,e,i){return this._m[12]=t,this._m[13]=e,this._m[14]=i,this._markAsUpdated(),this},t.prototype.addTranslationFromFloats=function(t,e,i){return this._m[12]+=t,this._m[13]+=e,this._m[14]+=i,this._markAsUpdated(),this},t.prototype.setTranslation=function(t){return this.setTranslationFromFloats(t._x,t._y,t._z)},t.prototype.getTranslation=function(){return new c(this._m[12],this._m[13],this._m[14])},t.prototype.getTranslationToRef=function(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this},t.prototype.removeRotationAndScaling=function(){var e=this.m;return t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e[12],e[13],e[14],e[15],this),this._updateIdentityStatus(0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]),this},t.prototype.multiply=function(e){var i=new t;return this.multiplyToRef(e,i),i},t.prototype.copyFrom=function(t){t.copyToArray(this._m);var e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this},t.prototype.copyToArray=function(t,e){void 0===e&&(e=0);var i=this._m;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],this},t.prototype.multiplyToRef=function(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)},t.prototype.multiplyToArray=function(t,e,i){var r=this._m,n=t.m,o=r[0],s=r[1],a=r[2],h=r[3],c=r[4],u=r[5],l=r[6],f=r[7],d=r[8],p=r[9],_=r[10],g=r[11],m=r[12],y=r[13],b=r[14],v=r[15],M=n[0],O=n[1],A=n[2],P=n[3],x=n[4],T=n[5],I=n[6],R=n[7],C=n[8],D=n[9],S=n[10],E=n[11],w=n[12],F=n[13],B=n[14],N=n[15];return e[i]=o*M+s*x+a*C+h*w,e[i+1]=o*O+s*T+a*D+h*F,e[i+2]=o*A+s*I+a*S+h*B,e[i+3]=o*P+s*R+a*E+h*N,e[i+4]=c*M+u*x+l*C+f*w,e[i+5]=c*O+u*T+l*D+f*F,e[i+6]=c*A+u*I+l*S+f*B,e[i+7]=c*P+u*R+l*E+f*N,e[i+8]=d*M+p*x+_*C+g*w,e[i+9]=d*O+p*T+_*D+g*F,e[i+10]=d*A+p*I+_*S+g*B,e[i+11]=d*P+p*R+_*E+g*N,e[i+12]=m*M+y*x+b*C+v*w,e[i+13]=m*O+y*T+b*D+v*F,e[i+14]=m*A+y*I+b*S+v*B,e[i+15]=m*P+y*R+b*E+v*N,this},t.prototype.equals=function(t){var e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;var i=this.m,r=e.m;return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]},t.prototype.clone=function(){var e=new t;return e.copyFrom(this),e},t.prototype.getClassName=function(){return"Matrix"},t.prototype.getHashCode=function(){for(var t=0|this._m[0],e=1;e<16;e++)t=397*t^(0|this._m[e]);return t},t.prototype.decompose=function(e,i,r){if(this._isIdentity)return r&&r.setAll(0),e&&e.setAll(1),i&&i.copyFromFloats(0,0,0,1),!0;var n=this._m;if(r&&r.copyFromFloats(n[12],n[13],n[14]),(e=e||d.Vector3[0]).x=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),e.y=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),e.z=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),this.determinant()<=0&&(e.y*=-1),0===e._x||0===e._y||0===e._z)return i&&i.copyFromFloats(0,0,0,1),!1;if(i){var o=1/e._x,s=1/e._y,a=1/e._z;t.FromValuesToRef(n[0]*o,n[1]*o,n[2]*o,0,n[4]*s,n[5]*s,n[6]*s,0,n[8]*a,n[9]*a,n[10]*a,0,0,0,0,1,d.Matrix[0]),l.FromRotationMatrixToRef(d.Matrix[0],i)}return!0},t.prototype.getRow=function(t){if(t<0||t>3)return null;var e=4*t;return new u(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])},t.prototype.setRow=function(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)},t.prototype.transpose=function(){return t.Transpose(this)},t.prototype.transposeToRef=function(e){return t.TransposeToRef(this,e),this},t.prototype.setRowFromFloats=function(t,e,i,r,n){if(t<0||t>3)return this;var o=4*t;return this._m[o+0]=e,this._m[o+1]=i,this._m[o+2]=r,this._m[o+3]=n,this._markAsUpdated(),this},t.prototype.scale=function(e){var i=new t;return this.scaleToRef(e,i),i},t.prototype.scaleToRef=function(t,e){for(var i=0;i<16;i++)e._m[i]=this._m[i]*t;return e._markAsUpdated(),this},t.prototype.scaleAndAddToRef=function(t,e){for(var i=0;i<16;i++)e._m[i]+=this._m[i]*t;return e._markAsUpdated(),this},t.prototype.toNormalMatrix=function(e){var i=d.Matrix[0];this.invertToRef(i),i.transposeToRef(e);var r=e._m;t.FromValuesToRef(r[0],r[1],r[2],0,r[4],r[5],r[6],0,r[8],r[9],r[10],0,0,0,0,1,e)},t.prototype.getRotationMatrix=function(){var e=new t;return this.getRotationMatrixToRef(e),e},t.prototype.getRotationMatrixToRef=function(e){var i=d.Vector3[0];if(!this.decompose(i))return t.IdentityToRef(e),this;var r=this._m,n=1/i._x,o=1/i._y,s=1/i._z;return t.FromValuesToRef(r[0]*n,r[1]*n,r[2]*n,0,r[4]*o,r[5]*o,r[6]*o,0,r[8]*s,r[9]*s,r[10]*s,0,0,0,0,1,e),this},t.prototype.toggleModelMatrixHandInPlace=function(){var t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()},t.prototype.toggleProjectionMatrixHandInPlace=function(){var t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()},t.FromArray=function(e,i){void 0===i&&(i=0);var r=new t;return t.FromArrayToRef(e,i,r),r},t.FromArrayToRef=function(t,e,i){for(var r=0;r<16;r++)i._m[r]=t[r+e];i._markAsUpdated()},t.FromFloat32ArrayToRefScaled=function(t,e,i,r){for(var n=0;n<16;n++)r._m[n]=t[n+e]*i;r._markAsUpdated()},Object.defineProperty(t,"IdentityReadOnly",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),t.FromValuesToRef=function(t,e,i,r,n,o,s,a,h,c,u,l,f,d,p,_,g){var m=g._m;m[0]=t,m[1]=e,m[2]=i,m[3]=r,m[4]=n,m[5]=o,m[6]=s,m[7]=a,m[8]=h,m[9]=c,m[10]=u,m[11]=l,m[12]=f,m[13]=d,m[14]=p,m[15]=_,g._markAsUpdated()},t.FromValues=function(e,i,r,n,o,s,a,h,c,u,l,f,d,p,_,g){var m=new t,y=m._m;return y[0]=e,y[1]=i,y[2]=r,y[3]=n,y[4]=o,y[5]=s,y[6]=a,y[7]=h,y[8]=c,y[9]=u,y[10]=l,y[11]=f,y[12]=d,y[13]=p,y[14]=_,y[15]=g,m._markAsUpdated(),m},t.Compose=function(e,i,r){var n=new t;return t.ComposeToRef(e,i,r,n),n},t.ComposeToRef=function(t,e,i,r){var n=r._m,o=e._x,s=e._y,a=e._z,h=e._w,c=o+o,u=s+s,l=a+a,f=o*c,d=o*u,p=o*l,_=s*u,g=s*l,m=a*l,y=h*c,b=h*u,v=h*l,M=t._x,O=t._y,A=t._z;n[0]=(1-(_+m))*M,n[1]=(d+v)*M,n[2]=(p-b)*M,n[3]=0,n[4]=(d-v)*O,n[5]=(1-(f+m))*O,n[6]=(g+y)*O,n[7]=0,n[8]=(p+b)*A,n[9]=(g-y)*A,n[10]=(1-(f+_))*A,n[11]=0,n[12]=i._x,n[13]=i._y,n[14]=i._z,n[15]=1,r._markAsUpdated()},t.Identity=function(){var e=t.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return e._updateIdentityStatus(!0),e},t.IdentityToRef=function(e){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(!0)},t.Zero=function(){var e=t.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return e._updateIdentityStatus(!1),e},t.RotationX=function(e){var i=new t;return t.RotationXToRef(e,i),i},t.Invert=function(e){var i=new t;return e.invertToRef(i),i},t.RotationXToRef=function(e,i){var r=Math.sin(e),n=Math.cos(e);t.FromValuesToRef(1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1,i),i._updateIdentityStatus(1===n&&0===r)},t.RotationY=function(e){var i=new t;return t.RotationYToRef(e,i),i},t.RotationYToRef=function(e,i){var r=Math.sin(e),n=Math.cos(e);t.FromValuesToRef(n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1,i),i._updateIdentityStatus(1===n&&0===r)},t.RotationZ=function(e){var i=new t;return t.RotationZToRef(e,i),i},t.RotationZToRef=function(e,i){var r=Math.sin(e),n=Math.cos(e);t.FromValuesToRef(n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1,i),i._updateIdentityStatus(1===n&&0===r)},t.RotationAxis=function(e,i){var r=new t;return t.RotationAxisToRef(e,i,r),r},t.RotationAxisToRef=function(t,e,i){var r=Math.sin(-e),n=Math.cos(-e),o=1-n;t.normalize();var s=i._m;s[0]=t._x*t._x*o+n,s[1]=t._x*t._y*o-t._z*r,s[2]=t._x*t._z*o+t._y*r,s[3]=0,s[4]=t._y*t._x*o+t._z*r,s[5]=t._y*t._y*o+n,s[6]=t._y*t._z*o-t._x*r,s[7]=0,s[8]=t._z*t._x*o-t._y*r,s[9]=t._z*t._y*o+t._x*r,s[10]=t._z*t._z*o+n,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,i._markAsUpdated()},t.RotationAlignToRef=function(t,e,i){var r=c.Cross(e,t),n=c.Dot(e,t),o=1/(1+n),s=i._m;s[0]=r._x*r._x*o+n,s[1]=r._y*r._x*o-r._z,s[2]=r._z*r._x*o+r._y,s[3]=0,s[4]=r._x*r._y*o+r._z,s[5]=r._y*r._y*o+n,s[6]=r._z*r._y*o-r._x,s[7]=0,s[8]=r._x*r._z*o-r._y,s[9]=r._y*r._z*o+r._x,s[10]=r._z*r._z*o+n,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,i._markAsUpdated()},t.RotationYawPitchRoll=function(e,i,r){var n=new t;return t.RotationYawPitchRollToRef(e,i,r,n),n},t.RotationYawPitchRollToRef=function(t,e,i,r){l.RotationYawPitchRollToRef(t,e,i,d.Quaternion[0]),d.Quaternion[0].toRotationMatrix(r)},t.Scaling=function(e,i,r){var n=new t;return t.ScalingToRef(e,i,r,n),n},t.ScalingToRef=function(e,i,r,n){t.FromValuesToRef(e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1,n),n._updateIdentityStatus(1===e&&1===i&&1===r)},t.Translation=function(e,i,r){var n=new t;return t.TranslationToRef(e,i,r,n),n},t.TranslationToRef=function(e,i,r,n){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e,i,r,1,n),n._updateIdentityStatus(0===e&&0===i&&0===r)},t.Lerp=function(e,i,r){var n=new t;return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){for(var n=r._m,o=t.m,s=e.m,a=0;a<16;a++)n[a]=o[a]*(1-i)+s[a]*i;r._markAsUpdated()},t.DecomposeLerp=function(e,i,r){var n=new t;return t.DecomposeLerpToRef(e,i,r,n),n},t.DecomposeLerpToRef=function(e,i,r,n){var o=d.Vector3[0],s=d.Quaternion[0],a=d.Vector3[1];e.decompose(o,s,a);var h=d.Vector3[2],u=d.Quaternion[1],f=d.Vector3[3];i.decompose(h,u,f);var p=d.Vector3[4];c.LerpToRef(o,h,r,p);var _=d.Quaternion[2];l.SlerpToRef(s,u,r,_);var g=d.Vector3[5];c.LerpToRef(a,f,r,g),t.ComposeToRef(p,_,g,n)},t.LookAtLH=function(e,i,r){var n=new t;return t.LookAtLHToRef(e,i,r,n),n},t.LookAtLHToRef=function(e,i,r,n){var o=d.Vector3[0],s=d.Vector3[1],a=d.Vector3[2];i.subtractToRef(e,a),a.normalize(),c.CrossToRef(r,a,o);var h=o.lengthSquared();0===h?o.x=1:o.normalizeFromLength(Math.sqrt(h)),c.CrossToRef(a,o,s),s.normalize();var u=-c.Dot(o,e),l=-c.Dot(s,e),f=-c.Dot(a,e);t.FromValuesToRef(o._x,s._x,a._x,0,o._y,s._y,a._y,0,o._z,s._z,a._z,0,u,l,f,1,n)},t.LookAtRH=function(e,i,r){var n=new t;return t.LookAtRHToRef(e,i,r,n),n},t.LookAtRHToRef=function(e,i,r,n){var o=d.Vector3[0],s=d.Vector3[1],a=d.Vector3[2];e.subtractToRef(i,a),a.normalize(),c.CrossToRef(r,a,o);var h=o.lengthSquared();0===h?o.x=1:o.normalizeFromLength(Math.sqrt(h)),c.CrossToRef(a,o,s),s.normalize();var u=-c.Dot(o,e),l=-c.Dot(s,e),f=-c.Dot(a,e);t.FromValuesToRef(o._x,s._x,a._x,0,o._y,s._y,a._y,0,o._z,s._z,a._z,0,u,l,f,1,n)},t.OrthoLH=function(e,i,r,n){var o=new t;return t.OrthoLHToRef(e,i,r,n,o),o},t.OrthoLHToRef=function(e,i,r,n,o){var s=2/e,a=2/i,h=2/(n-r),c=-(n+r)/(n-r);t.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,h,0,0,0,c,1,o),o._updateIdentityStatus(1===s&&1===a&&1===h&&0===c)},t.OrthoOffCenterLH=function(e,i,r,n,o,s){var a=new t;return t.OrthoOffCenterLHToRef(e,i,r,n,o,s,a),a},t.OrthoOffCenterLHToRef=function(e,i,r,n,o,s,a){var h=2/(i-e),c=2/(n-r),u=2/(s-o),l=-(s+o)/(s-o),f=(e+i)/(e-i),d=(n+r)/(r-n);t.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,u,0,f,d,l,1,a),a._markAsUpdated()},t.OrthoOffCenterRH=function(e,i,r,n,o,s){var a=new t;return t.OrthoOffCenterRHToRef(e,i,r,n,o,s,a),a},t.OrthoOffCenterRHToRef=function(e,i,r,n,o,s,a){t.OrthoOffCenterLHToRef(e,i,r,n,o,s,a),a._m[10]*=-1},t.PerspectiveLH=function(e,i,r,n){var o=new t,s=2*r/e,a=2*r/i,h=(n+r)/(n-r),c=-2*n*r/(n-r);return t.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,h,1,0,0,c,0,o),o._updateIdentityStatus(!1),o},t.PerspectiveFovLH=function(e,i,r,n){var o=new t;return t.PerspectiveFovLHToRef(e,i,r,n,o),o},t.PerspectiveFovLHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=r,h=n,c=1/Math.tan(.5*e),u=s?c/i:c,l=s?c:c*i,f=(h+a)/(h-a),d=-2*h*a/(h-a);t.FromValuesToRef(u,0,0,0,0,l,0,0,0,0,f,1,0,0,d,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovReverseLHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=1/Math.tan(.5*e),h=s?a/i:a,c=s?a:a*i;t.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,-r,1,0,0,1,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovRH=function(e,i,r,n){var o=new t;return t.PerspectiveFovRHToRef(e,i,r,n,o),o},t.PerspectiveFovRHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=r,h=n,c=1/Math.tan(.5*e),u=s?c/i:c,l=s?c:c*i,f=-(h+a)/(h-a),d=-2*h*a/(h-a);t.FromValuesToRef(u,0,0,0,0,l,0,0,0,0,f,-1,0,0,d,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovReverseRHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=1/Math.tan(.5*e),h=s?a/i:a,c=s?a:a*i;t.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,-r,-1,0,0,-1,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovWebVRToRef=function(t,e,i,r,n){void 0===n&&(n=!1);var o=n?-1:1,s=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),h=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),u=2/(h+c),l=2/(s+a),f=r._m;f[0]=u,f[1]=f[2]=f[3]=f[4]=0,f[5]=l,f[6]=f[7]=0,f[8]=(h-c)*u*.5,f[9]=-(s-a)*l*.5,f[10]=-i/(e-i),f[11]=1*o,f[12]=f[13]=f[15]=0,f[14]=-2*i*e/(i-e),r._markAsUpdated()},t.GetFinalMatrix=function(e,i,r,n,o,s){var a=e.width,h=e.height,c=e.x,u=e.y,l=t.FromValues(a/2,0,0,0,0,-h/2,0,0,0,0,s-o,0,c+a/2,h/2+u,o,1),f=d.Matrix[0];return i.multiplyToRef(r,f),f.multiplyToRef(n,f),f.multiply(l)},t.GetAsMatrix2x2=function(t){var e=t.m,i=[e[0],e[1],e[4],e[5]];return a.a.MatrixUse64Bits?i:new Float32Array(i)},t.GetAsMatrix3x3=function(t){var e=t.m,i=[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]];return a.a.MatrixUse64Bits?i:new Float32Array(i)},t.Transpose=function(e){var i=new t;return t.TransposeToRef(e,i),i},t.TransposeToRef=function(t,e){var i=e._m,r=t.m;i[0]=r[0],i[1]=r[4],i[2]=r[8],i[3]=r[12],i[4]=r[1],i[5]=r[5],i[6]=r[9],i[7]=r[13],i[8]=r[2],i[9]=r[6],i[10]=r[10],i[11]=r[14],i[12]=r[3],i[13]=r[7],i[14]=r[11],i[15]=r[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)},t.Reflection=function(e){var i=new t;return t.ReflectionToRef(e,i),i},t.ReflectionToRef=function(e,i){e.normalize();var r=e.normal.x,n=e.normal.y,o=e.normal.z,s=-2*r,a=-2*n,h=-2*o;t.FromValuesToRef(s*r+1,a*r,h*r,0,s*n,a*n+1,h*n,0,s*o,a*o,h*o+1,0,s*e.d,a*e.d,h*e.d,1,i)},t.FromXYZAxesToRef=function(e,i,r,n){t.FromValuesToRef(e._x,e._y,e._z,0,i._x,i._y,i._z,0,r._x,r._y,r._z,0,0,0,0,1,n)},t.FromQuaternionToRef=function(t,e){var i=t._x*t._x,r=t._y*t._y,n=t._z*t._z,o=t._x*t._y,s=t._z*t._w,a=t._z*t._x,h=t._y*t._w,c=t._y*t._z,u=t._x*t._w;e._m[0]=1-2*(r+n),e._m[1]=2*(o+s),e._m[2]=2*(a-h),e._m[3]=0,e._m[4]=2*(o-s),e._m[5]=1-2*(n+i),e._m[6]=2*(c+u),e._m[7]=0,e._m[8]=2*(a+h),e._m[9]=2*(c-u),e._m[10]=1-2*(r+i),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()},t._updateFlagSeed=0,t._identityReadOnly=t.Identity(),t}(),d=function(){function t(){}return t.Vector3=o.a.BuildArray(6,c.Zero),t.Matrix=o.a.BuildArray(2,f.Identity),t.Quaternion=o.a.BuildArray(3,l.Zero),t}(),p=function(){function t(){}return t.Vector2=o.a.BuildArray(3,h.Zero),t.Vector3=o.a.BuildArray(13,c.Zero),t.Vector4=o.a.BuildArray(3,u.Zero),t.Quaternion=o.a.BuildArray(2,l.Zero),t.Matrix=o.a.BuildArray(8,f.Identity),t}();s.a.RegisteredTypes["BABYLON.Vector2"]=h,s.a.RegisteredTypes["BABYLON.Vector3"]=c,s.a.RegisteredTypes["BABYLON.Vector4"]=u,s.a.RegisteredTypes["BABYLON.Matrix"]=f},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.GetClass=function(t){return this.RegisteredTypes&&this.RegisteredTypes[t]?this.RegisteredTypes[t]:null},t.RegisteredTypes={},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return h})),i.d(e,"c",(function(){return c}));var r=i(46),n=i(60),o=i(85),s=i(35),a=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.r=t,this.g=e,this.b=i}return t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},t.prototype.getClassName=function(){return"Color3"},t.prototype.getHashCode=function(){var t=255*this.r|0;return t=397*(t=397*t^(255*this.g|0))^(255*this.b|0)},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.toColor4=function(t){return void 0===t&&(t=1),new h(this.r,this.g,this.b,t)},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},t.prototype.multiply=function(e){return new t(this.r*e.r,this.g*e.g,this.b*e.b)},t.prototype.multiplyToRef=function(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this},t.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},t.prototype.equalsFloats=function(t,e,i){return this.r===t&&this.g===e&&this.b===i},t.prototype.scale=function(e){return new t(this.r*e,this.g*e,this.b*e)},t.prototype.scaleToRef=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this},t.prototype.clampToRef=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=1),i.r=r.a.Clamp(this.r,t,e),i.g=r.a.Clamp(this.g,t,e),i.b=r.a.Clamp(this.b,t,e),this},t.prototype.add=function(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b)},t.prototype.addToRef=function(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this},t.prototype.subtract=function(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b)},t.prototype.subtractToRef=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},t.prototype.copyFromFloats=function(t,e,i){return this.r=t,this.g=e,this.b=i,this},t.prototype.set=function(t,e,i){return this.copyFromFloats(t,e,i)},t.prototype.toHexString=function(){var t=255*this.r|0,e=255*this.g|0,i=255*this.b|0;return"#"+r.a.ToHex(t)+r.a.ToHex(e)+r.a.ToHex(i)},t.prototype.toLinearSpace=function(){var e=new t;return this.toLinearSpaceToRef(e),e},t.prototype.toHSV=function(){var e=new t;return this.toHSVToRef(e),e},t.prototype.toHSVToRef=function(t){var e=this.r,i=this.g,r=this.b,n=Math.max(e,i,r),o=Math.min(e,i,r),s=0,a=0,h=n,c=n-o;0!==n&&(a=c/n),n!=o&&(n==e?(s=(i-r)/c,i<r&&(s+=6)):n==i?s=(r-e)/c+2:n==r&&(s=(e-i)/c+4),s*=60),t.r=s,t.g=a,t.b=h},t.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,n.c),t.g=Math.pow(this.g,n.c),t.b=Math.pow(this.b,n.c),this},t.prototype.toGammaSpace=function(){var e=new t;return this.toGammaSpaceToRef(e),e},t.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,n.b),t.g=Math.pow(this.g,n.b),t.b=Math.pow(this.b,n.b),this},t.HSVtoRGBToRef=function(t,e,i,r){var n=i*e,o=t/60,s=n*(1-Math.abs(o%2-1)),a=0,h=0,c=0;o>=0&&o<=1?(a=n,h=s):o>=1&&o<=2?(a=s,h=n):o>=2&&o<=3?(h=n,c=s):o>=3&&o<=4?(h=s,c=n):o>=4&&o<=5?(a=s,c=n):o>=5&&o<=6&&(a=n,c=s);var u=i-n;r.set(a+u,h+u,c+u)},t.FromHexString=function(e){if("#"!==e.substring(0,1)||7!==e.length)return new t(0,0,0);var i=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),n=parseInt(e.substring(5,7),16);return t.FromInts(i,r,n)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1],e[i+2])},t.FromArrayToRef=function(t,e,i){void 0===e&&(e=0),i.r=t[e],i.g=t[e+1],i.b=t[e+2]},t.FromInts=function(e,i,r){return new t(e/255,i/255,r/255)},t.Lerp=function(e,i,r){var n=new t(0,0,0);return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){r.r=t.r+(e.r-t.r)*i,r.g=t.g+(e.g-t.g)*i,r.b=t.b+(e.b-t.b)*i},t.Red=function(){return new t(1,0,0)},t.Green=function(){return new t(0,1,0)},t.Blue=function(){return new t(0,0,1)},t.Black=function(){return new t(0,0,0)},Object.defineProperty(t,"BlackReadOnly",{get:function(){return t._BlackReadOnly},enumerable:!1,configurable:!0}),t.White=function(){return new t(1,1,1)},t.Purple=function(){return new t(.5,0,.5)},t.Magenta=function(){return new t(1,0,1)},t.Yellow=function(){return new t(1,1,0)},t.Gray=function(){return new t(.5,.5,.5)},t.Teal=function(){return new t(0,1,1)},t.Random=function(){return new t(Math.random(),Math.random(),Math.random())},t._BlackReadOnly=t.Black(),t}(),h=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),this.r=t,this.g=e,this.b=i,this.a=r}return t.prototype.addInPlace=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},t.prototype.add=function(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)},t.prototype.subtract=function(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)},t.prototype.subtractToRef=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this},t.prototype.scale=function(e){return new t(this.r*e,this.g*e,this.b*e,this.a*e)},t.prototype.scaleToRef=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this},t.prototype.clampToRef=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=1),i.r=r.a.Clamp(this.r,t,e),i.g=r.a.Clamp(this.g,t,e),i.b=r.a.Clamp(this.b,t,e),i.a=r.a.Clamp(this.a,t,e),this},t.prototype.multiply=function(e){return new t(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)},t.prototype.multiplyToRef=function(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},t.prototype.getClassName=function(){return"Color4"},t.prototype.getHashCode=function(){var t=255*this.r|0;return t=397*(t=397*(t=397*t^(255*this.g|0))^(255*this.b|0))^(255*this.a|0)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.copyFromFloats=function(t,e,i,r){return this.r=t,this.g=e,this.b=i,this.a=r,this},t.prototype.set=function(t,e,i,r){return this.copyFromFloats(t,e,i,r)},t.prototype.toHexString=function(t){void 0===t&&(t=!1);var e=255*this.r|0,i=255*this.g|0,n=255*this.b|0;if(t)return"#"+r.a.ToHex(e)+r.a.ToHex(i)+r.a.ToHex(n);var o=255*this.a|0;return"#"+r.a.ToHex(e)+r.a.ToHex(i)+r.a.ToHex(n)+r.a.ToHex(o)},t.prototype.toLinearSpace=function(){var e=new t;return this.toLinearSpaceToRef(e),e},t.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,n.c),t.g=Math.pow(this.g,n.c),t.b=Math.pow(this.b,n.c),t.a=this.a,this},t.prototype.toGammaSpace=function(){var e=new t;return this.toGammaSpaceToRef(e),e},t.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,n.b),t.g=Math.pow(this.g,n.b),t.b=Math.pow(this.b,n.b),t.a=this.a,this},t.FromHexString=function(e){if("#"!==e.substring(0,1)||9!==e.length)return new t(0,0,0,0);var i=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),n=parseInt(e.substring(5,7),16),o=parseInt(e.substring(7,9),16);return t.FromInts(i,r,n,o)},t.Lerp=function(e,i,r){var n=new t(0,0,0,0);return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){r.r=t.r+(e.r-t.r)*i,r.g=t.g+(e.g-t.g)*i,r.b=t.b+(e.b-t.b)*i,r.a=t.a+(e.a-t.a)*i},t.FromColor3=function(e,i){return void 0===i&&(i=1),new t(e.r,e.g,e.b,i)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1],e[i+2],e[i+3])},t.FromArrayToRef=function(t,e,i){void 0===e&&(e=0),i.r=t[e],i.g=t[e+1],i.b=t[e+2],i.a=t[e+3]},t.FromInts=function(e,i,r,n){return new t(e/255,i/255,r/255,n/255)},t.CheckColors4=function(t,e){if(t.length===3*e){for(var i=[],r=0;r<t.length;r+=3){var n=r/3*4;i[n]=t[r],i[n+1]=t[r+1],i[n+2]=t[r+2],i[n+3]=1}return i}return t},t}(),c=function(){function t(){}return t.Color3=o.a.BuildArray(3,a.Black),t.Color4=o.a.BuildArray(3,(function(){return new h(0,0,0,0)})),t}();s.a.RegisteredTypes["BABYLON.Color3"]=a,s.a.RegisteredTypes["BABYLON.Color4"]=h},function(t,e,i){"use strict";i.d(e,"b",(function(){return f})),i.d(e,"c",(function(){return d})),i.d(e,"m",(function(){return p})),i.d(e,"e",(function(){return _})),i.d(e,"h",(function(){return g})),i.d(e,"n",(function(){return m})),i.d(e,"o",(function(){return y})),i.d(e,"k",(function(){return b})),i.d(e,"g",(function(){return v})),i.d(e,"f",(function(){return M})),i.d(e,"i",(function(){return O})),i.d(e,"l",(function(){return A})),i.d(e,"j",(function(){return P})),i.d(e,"d",(function(){return x})),i.d(e,"a",(function(){return T}));var r=i(105),n=i(34),o=i(5),s=i(36),a={},h={},c=function(t,e,i){var n=t();r.a&&r.a.AddTagsTo(n,e.tags);var o=u(n);for(var s in o){var a=o[s],h=e[s],c=a.type;if(null!=h&&"uniqueId"!==s)switch(c){case 0:case 6:case 11:n[s]=h;break;case 1:n[s]=i||h.isRenderTarget?h:h.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:n[s]=i?h:h.clone()}}return n};function u(t){var e=t.getClassName();if(h[e])return h[e];h[e]={};for(var i=h[e],r=t,n=e;n;){var o=a[n];for(var s in o)i[s]=o[s];var c=void 0,u=!1;do{if(!(c=Object.getPrototypeOf(r)).getClassName){u=!0;break}if(c.getClassName()!==n)break;r=c}while(c);if(u)break;n=c.getClassName(),r=c}return i}function l(t,e){return function(i,r){var n=function(t){var e=t.getClassName();return a[e]||(a[e]={}),a[e]}(i);n[r]||(n[r]={type:t,sourceName:e})}}function f(t,e){return void 0===e&&(e=null),function(t,e){return void 0===e&&(e=null),function(i,r){var n=e||"_"+r;Object.defineProperty(i,r,{get:function(){return this[n]},set:function(e){this[n]!==e&&(this[n]=e,i[t].apply(this))},enumerable:!0,configurable:!0})}}(t,e)}function d(t){return l(0,t)}function p(t){return l(1,t)}function _(t){return l(2,t)}function g(t){return l(3,t)}function m(t){return l(4,t)}function y(t){return l(5,t)}function b(t){return l(6,t)}function v(t){return l(7,t)}function M(t){return l(8,t)}function O(t){return l(9,t)}function A(t){return l(10,t)}function P(t){return l(12,t)}function x(t){return l(11,t)}var T=function(){function t(){}return t.AppendSerializedAnimations=function(t,e){if(t.animations){e.animations=[];for(var i=0;i<t.animations.length;i++){var r=t.animations[i];e.animations.push(r.serialize())}}},t.Serialize=function(t,e){e||(e={}),r.a&&(e.tags=r.a.GetTags(t));var i=u(t);for(var n in i){var o=i[n],s=o.sourceName||n,a=o.type,h=t[n];if(null!=h&&"uniqueId"!==n)switch(a){case 0:e[s]=h;break;case 1:e[s]=h.serialize();break;case 2:e[s]=h.asArray();break;case 3:e[s]=h.serialize();break;case 4:case 5:e[s]=h.asArray();break;case 6:e[s]=h.id;break;case 7:e[s]=h.serialize();break;case 8:e[s]=h.asArray();break;case 9:e[s]=h.serialize();break;case 10:e[s]=h.asArray();break;case 11:e[s]=h.id;case 12:e[s]=h.asArray()}}return e},t.Parse=function(e,i,o,a){void 0===a&&(a=null);var h=e();a||(a=""),r.a&&r.a.AddTagsTo(h,i.tags);var c=u(h);for(var l in c){var f=c[l],d=i[f.sourceName||l],p=f.type;if(null!=d&&"uniqueId"!==l){var _=h;switch(p){case 0:_[l]=d;break;case 1:o&&(_[l]=t._TextureParser(d,o,a));break;case 2:_[l]=s.a.FromArray(d);break;case 3:_[l]=t._FresnelParametersParser(d);break;case 4:_[l]=n.d.FromArray(d);break;case 5:_[l]=n.e.FromArray(d);break;case 6:o&&(_[l]=o.getLastMeshByID(d));break;case 7:_[l]=t._ColorCurvesParser(d);break;case 8:_[l]=s.b.FromArray(d);break;case 9:_[l]=t._ImageProcessingConfigurationParser(d);break;case 10:_[l]=n.b.FromArray(d);break;case 11:o&&(_[l]=o.getCameraByID(d));case 12:_[l]=n.a.FromArray(d)}}}return h},t.Clone=function(t,e){return c(t,e,!1)},t.Instanciate=function(t,e){return c(t,e,!0)},t._ImageProcessingConfigurationParser=function(t){throw o.a.WarnImport("ImageProcessingConfiguration")},t._FresnelParametersParser=function(t){throw o.a.WarnImport("FresnelParameters")},t._ColorCurvesParser=function(t){throw o.a.WarnImport("ColorCurves")},t._TextureParser=function(t,e,i){throw o.a.WarnImport("Texture")},t}()},function(t,e,i){"use strict";i.d(e,"b",(function(){return I})),i.d(e,"a",(function(){return E}));var r=i(3),n=i(0),o=i(41),s=i(59),a=i(105),h=i(34),c=i(36),u=i(47),l=i(40),f=i(43),d=i(108),p=i(50),_=i(90),g=i(63),m=i(49),y=i(99),b=i(143),v=i(37),M=i(1),O=i(35),A=i(5),P=i(48),x=i(205),T=i(12),I=function(){},R=function(){this.visibleInstances={},this.batchCache=new C,this.instancesBufferSize=2048},C=function(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=new Array,this.hardwareInstancedRendering=new Array},D=function(){this.instancesCount=0,this.matrixBuffer=null,this.matrixBufferSize=512,this.boundingVectors=[],this.worldMatrices=null},S=function(){this._areNormalsFrozen=!1,this._source=null,this.meshMap=null,this._preActivateId=-1,this._LODLevels=new Array,this._morphTargetManager=null},E=function(t){function e(i,r,n,o,h,c){void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===c&&(c=!0);var u=t.call(this,i,r)||this;if(u._internalMeshDataInfo=new S,u.delayLoadState=0,u.instances=new Array,u._creationDataStorage=null,u._geometry=null,u._instanceDataStorage=new R,u._thinInstanceDataStorage=new D,u._effectiveMaterial=null,u._shouldGenerateFlatShading=!1,u._originalBuilderSideOrientation=e.DEFAULTSIDE,u.overrideMaterialSideOrientation=null,r=u.getScene(),o){if(o._geometry&&o._geometry.applyToMesh(u),s.a.DeepCopy(o,u,["name","material","skeleton","instances","parent","uniqueId","source","metadata","morphTargetManager","hasInstances","source","worldMatrixInstancedBuffer","hasLODLevels","geometry","isBlocked","areNormalsFrozen","facetNb","isFacetDataEnabled","lightSources","useBones","isAnInstance","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","cloneMeshMap"],["_poseMatrix"]),u._internalMeshDataInfo._source=o,r.useClonedMeshMap&&(o._internalMeshDataInfo.meshMap||(o._internalMeshDataInfo.meshMap={}),o._internalMeshDataInfo.meshMap[u.uniqueId]=u),u._originalBuilderSideOrientation=o._originalBuilderSideOrientation,u._creationDataStorage=o._creationDataStorage,o._ranges){var l=o._ranges;for(var i in l)l.hasOwnProperty(i)&&l[i]&&u.createAnimationRange(i,l[i].from,l[i].to)}var f;if(o.metadata&&o.metadata.clone?u.metadata=o.metadata.clone():u.metadata=o.metadata,a.a&&a.a.HasTags(o)&&a.a.AddTagsTo(u,a.a.GetTags(o,!0)),u.setEnabled(o.isEnabled()),u.parent=o.parent,u.setPivotMatrix(o.getPivotMatrix()),u.id=i+"."+o.id,u.material=o.material,!h)for(var d=o.getDescendants(!0),p=0;p<d.length;p++){var _=d[p];_.clone&&_.clone(i+"."+_.name,u)}if(o.morphTargetManager&&(u.morphTargetManager=o.morphTargetManager),r.getPhysicsEngine){var g=r.getPhysicsEngine();if(c&&g){var m=g.getImpostorForPhysicsObject(o);m&&(u.physicsImpostor=m.clone(u))}}for(f=0;f<r.particleSystems.length;f++){var y=r.particleSystems[f];y.emitter===o&&y.clone(y.name,u)}u.refreshBoundingInfo(),u.computeWorldMatrix(!0)}return null!==n&&(u.parent=n),u._instanceDataStorage.hardwareInstancedRendering=u.getEngine().getCaps().instancedArrays,u}return Object(r.d)(e,t),e._GetDefaultSideOrientation=function(t){return t||e.FRONTSIDE},Object.defineProperty(e.prototype,"computeBonesUsingShaders",{get:function(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders},set:function(t){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==t&&(t&&this._internalMeshDataInfo._sourcePositions&&(this.setVerticesData(l.b.PositionKind,this._internalMeshDataInfo._sourcePositions.slice(),!0),this._internalMeshDataInfo._sourceNormals&&this.setVerticesData(l.b.NormalKind,this._internalMeshDataInfo._sourceNormals.slice(),!0)),this._internalAbstractMeshDataInfo._computeBonesUsingShaders=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeRenderObservable",{get:function(){return this._internalMeshDataInfo._onBeforeRenderObservable||(this._internalMeshDataInfo._onBeforeRenderObservable=new n.a),this._internalMeshDataInfo._onBeforeRenderObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeBindObservable",{get:function(){return this._internalMeshDataInfo._onBeforeBindObservable||(this._internalMeshDataInfo._onBeforeBindObservable=new n.a),this._internalMeshDataInfo._onBeforeBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onAfterRenderObservable",{get:function(){return this._internalMeshDataInfo._onAfterRenderObservable||(this._internalMeshDataInfo._onAfterRenderObservable=new n.a),this._internalMeshDataInfo._onAfterRenderObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeDrawObservable",{get:function(){return this._internalMeshDataInfo._onBeforeDrawObservable||(this._internalMeshDataInfo._onBeforeDrawObservable=new n.a),this._internalMeshDataInfo._onBeforeDrawObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeDraw",{set:function(t){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasInstances",{get:function(){return this.instances.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasThinInstances",{get:function(){var t;return(null!==(t=this._thinInstanceDataStorage.instancesCount)&&void 0!==t?t:0)>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"morphTargetManager",{get:function(){return this._internalMeshDataInfo._morphTargetManager},set:function(t){this._internalMeshDataInfo._morphTargetManager!==t&&(this._internalMeshDataInfo._morphTargetManager=t,this._syncGeometryWithMorphTargetManager())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._internalMeshDataInfo._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cloneMeshMap",{get:function(){return this._internalMeshDataInfo.meshMap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUnIndexed",{get:function(){return this._unIndexed},set:function(t){this._unIndexed!==t&&(this._unIndexed=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldMatrixInstancedBuffer",{get:function(){return this._instanceDataStorage.instancesData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"manualUpdateOfWorldMatrixInstancedBuffer",{get:function(){return this._instanceDataStorage.manualUpdate},set:function(t){this._instanceDataStorage.manualUpdate=t},enumerable:!1,configurable:!0}),e.prototype.instantiateHierarchy=function(t,e,i){void 0===t&&(t=null);var r=!(this.getTotalVertices()>0)||e&&e.doNotInstantiate?this.clone("Clone of "+(this.name||this.id),t||this.parent,!0):this.createInstance("instance of "+(this.name||this.id));r&&(r.parent=t||this.parent,r.position=this.position.clone(),r.scaling=this.scaling.clone(),this.rotationQuaternion?r.rotationQuaternion=this.rotationQuaternion.clone():r.rotation=this.rotation.clone(),i&&i(this,r));for(var n=0,o=this.getChildTransformNodes(!0);n<o.length;n++){o[n].instantiateHierarchy(r,e,i)}return r},e.prototype.getClassName=function(){return"Mesh"},Object.defineProperty(e.prototype,"_isMesh",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.toString=function(e){var i=t.prototype.toString.call(this,e);if(i+=", n vertices: "+this.getTotalVertices(),i+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(var r=0;r<this.animations.length;r++)i+=", animation[0]: "+this.animations[r].toString(e);if(e)if(this._geometry){var n=this.getIndices(),o=this.getVerticesData(l.b.PositionKind);o&&n&&(i+=", flat shading: "+(o.length/3===n.length?"YES":"NO"))}else i+=", flat shading: UNKNOWN";return i},e.prototype._unBindEffect=function(){t.prototype._unBindEffect.call(this);for(var e=0,i=this.instances;e<i.length;e++){i[e]._unBindEffect()}},Object.defineProperty(e.prototype,"hasLODLevels",{get:function(){return this._internalMeshDataInfo._LODLevels.length>0},enumerable:!1,configurable:!0}),e.prototype.getLODLevels=function(){return this._internalMeshDataInfo._LODLevels},e.prototype._sortLODLevels=function(){this._internalMeshDataInfo._LODLevels.sort((function(t,e){return t.distance<e.distance?1:t.distance>e.distance?-1:0}))},e.prototype.addLODLevel=function(t,e){if(e&&e._masterMesh)return M.a.Warn("You cannot use a mesh as LOD level twice"),this;var i=new x.a(t,e);return this._internalMeshDataInfo._LODLevels.push(i),e&&(e._masterMesh=this),this._sortLODLevels(),this},e.prototype.getLODLevelAtDistance=function(t){for(var e=this._internalMeshDataInfo,i=0;i<e._LODLevels.length;i++){var r=e._LODLevels[i];if(r.distance===t)return r.mesh}return null},e.prototype.removeLODLevel=function(t){for(var e=this._internalMeshDataInfo,i=0;i<e._LODLevels.length;i++)e._LODLevels[i].mesh===t&&(e._LODLevels.splice(i,1),t&&(t._masterMesh=null));return this._sortLODLevels(),this},e.prototype.getLOD=function(t,e){var i,r=this._internalMeshDataInfo;if(!r._LODLevels||0===r._LODLevels.length)return this;e?i=e:i=this.getBoundingInfo().boundingSphere;var n=i.centerWorld.subtract(t.globalPosition).length();if(r._LODLevels[r._LODLevels.length-1].distance>n)return this.onLODLevelSelection&&this.onLODLevelSelection(n,this,this),this;for(var o=0;o<r._LODLevels.length;o++){var s=r._LODLevels[o];if(s.distance<n){if(s.mesh){if(4===s.mesh.delayLoadState)return s.mesh._checkDelayState(),this;if(2===s.mesh.delayLoadState)return this;s.mesh._preActivate(),s.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)}return this.onLODLevelSelection&&this.onLODLevelSelection(n,this,s.mesh),s.mesh}}return this.onLODLevelSelection&&this.onLODLevelSelection(n,this,this),this},Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.getTotalVertices=function(){return null===this._geometry||void 0===this._geometry?0:this._geometry.getTotalVertices()},e.prototype.getVerticesData=function(t,e,i){return this._geometry?this._geometry.getVerticesData(t,e,i):null},e.prototype.getVertexBuffer=function(t){return this._geometry?this._geometry.getVertexBuffer(t):null},e.prototype.isVerticesDataPresent=function(t){return this._geometry?this._geometry.isVerticesDataPresent(t):!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)},e.prototype.isVertexBufferUpdatable=function(t){return this._geometry?this._geometry.isVertexBufferUpdatable(t):!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)},e.prototype.getVerticesDataKinds=function(){if(!this._geometry){var t=new Array;return this._delayInfo&&this._delayInfo.forEach((function(e){t.push(e)})),t}return this._geometry.getVerticesDataKinds()},e.prototype.getTotalIndices=function(){return this._geometry?this._geometry.getTotalIndices():0},e.prototype.getIndices=function(t,e){return this._geometry?this._geometry.getIndices(t,e):[]},Object.defineProperty(e.prototype,"isBlocked",{get:function(){return null!==this._masterMesh&&void 0!==this._masterMesh},enumerable:!1,configurable:!0}),e.prototype.isReady=function(e,i){var r,n,o,s,a,h;if(void 0===e&&(e=!1),void 0===i&&(i=!1),2===this.delayLoadState)return!1;if(!t.prototype.isReady.call(this,e))return!1;if(!this.subMeshes||0===this.subMeshes.length)return!0;if(!e)return!0;var c=this.getEngine(),u=this.getScene(),l=i||c.getCaps().instancedArrays&&(this.instances.length>0||this.hasThinInstances);this.computeWorldMatrix();var f=this.material||u.defaultMaterial;if(f)if(f._storeEffectOnSubMeshes)for(var d=0,p=this.subMeshes;d<p.length;d++){var _=(M=p[d]).getMaterial();if(_)if(_._storeEffectOnSubMeshes){if(!_.isReadyForSubMesh(this,M,l))return!1}else if(!_.isReady(this,l))return!1}else if(!f.isReady(this,l))return!1;for(var g=0,m=this.lightSources;g<m.length;g++){var y=m[g].getShadowGenerator();if(y&&(!(null===(r=y.getShadowMap())||void 0===r?void 0:r.renderList)||(null===(n=y.getShadowMap())||void 0===n?void 0:n.renderList)&&-1!==(null===(s=null===(o=y.getShadowMap())||void 0===o?void 0:o.renderList)||void 0===s?void 0:s.indexOf(this))))for(var b=0,v=this.subMeshes;b<v.length;b++){var M=v[b];if(!y.isReady(M,l,null!==(h=null===(a=M.getMaterial())||void 0===a?void 0:a.needAlphaBlendingForMesh(this))&&void 0!==h&&h))return!1}}for(var O=0,A=this._internalMeshDataInfo._LODLevels;O<A.length;O++){var P=A[O];if(P.mesh&&!P.mesh.isReady(l))return!1}return!0},Object.defineProperty(e.prototype,"areNormalsFrozen",{get:function(){return this._internalMeshDataInfo._areNormalsFrozen},enumerable:!1,configurable:!0}),e.prototype.freezeNormals=function(){return this._internalMeshDataInfo._areNormalsFrozen=!0,this},e.prototype.unfreezeNormals=function(){return this._internalMeshDataInfo._areNormalsFrozen=!1,this},Object.defineProperty(e.prototype,"overridenInstanceCount",{set:function(t){this._instanceDataStorage.overridenInstanceCount=t},enumerable:!1,configurable:!0}),e.prototype._preActivate=function(){var t=this._internalMeshDataInfo,e=this.getScene().getRenderId();return t._preActivateId===e||(t._preActivateId=e,this._instanceDataStorage.visibleInstances=null),this},e.prototype._preActivateForIntermediateRendering=function(t){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=t),this},e.prototype._registerInstanceForRenderId=function(t,e){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:e,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[e]||(void 0!==this._instanceDataStorage.previousRenderId&&this._instanceDataStorage.isFrozen&&(this._instanceDataStorage.visibleInstances[this._instanceDataStorage.previousRenderId]=null),this._instanceDataStorage.previousRenderId=e,this._instanceDataStorage.visibleInstances[e]=new Array),this._instanceDataStorage.visibleInstances[e].push(t),this},e.prototype._afterComputeWorldMatrix=function(){t.prototype._afterComputeWorldMatrix.call(this),this.hasThinInstances&&(this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1))},e.prototype._postActivate=function(){this.edgesShareWithInstances&&this.edgesRenderer&&this.edgesRenderer.isEnabled&&this._renderingGroup&&(this._renderingGroup._edgesRenderers.pushNoDuplicate(this.edgesRenderer),this.edgesRenderer.customInstances.push(this.getWorldMatrix()))},e.prototype.refreshBoundingInfo=function(t){if(void 0===t&&(t=!1),this._boundingInfo&&this._boundingInfo.isLocked)return this;var e=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getPositionData(t),e),this},e.prototype._createGlobalSubMesh=function(t){var e=this.getTotalVertices();if(!e||!this.getIndices())return null;if(this.subMeshes&&this.subMeshes.length>0){var i=this.getIndices();if(!i)return null;var r=i.length,n=!1;if(t)n=!0;else for(var o=0,s=this.subMeshes;o<s.length;o++){var a=s[o];if(a.indexStart+a.indexCount>r){n=!0;break}if(a.verticesStart+a.verticesCount>e){n=!0;break}}if(!n)return this.subMeshes[0]}return this.releaseSubMeshes(),new _.a(0,0,e,0,this.getTotalIndices(),this)},e.prototype.subdivide=function(t){if(!(t<1)){for(var e=this.getTotalIndices(),i=e/t|0,r=0;i%3!=0;)i++;this.releaseSubMeshes();for(var n=0;n<t&&!(r>=e);n++)_.a.CreateFromIndices(0,r,n===t-1?e-r:i,this),r+=i;this.synchronizeInstances()}},e.prototype.setVerticesData=function(t,e,i,r){if(void 0===i&&(i=!1),this._geometry)this._geometry.setVerticesData(t,e,i,r);else{var n=new f.a;n.set(e,t);var o=this.getScene();new d.a(d.a.RandomId(),o,n,i,this)}return this},e.prototype.removeVerticesData=function(t){this._geometry&&this._geometry.removeVerticesData(t)},e.prototype.markVerticesDataAsUpdatable=function(t,e){void 0===e&&(e=!0);var i=this.getVertexBuffer(t);i&&i.isUpdatable()!==e&&this.setVerticesData(t,this.getVerticesData(t),e)},e.prototype.setVerticesBuffer=function(t){return this._geometry||(this._geometry=d.a.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(t),this},e.prototype.updateVerticesData=function(t,e,i,r){return this._geometry?(r?(this.makeGeometryUnique(),this.updateVerticesData(t,e,i,!1)):this._geometry.updateVerticesData(t,e,i),this):this},e.prototype.updateMeshPositions=function(t,e){void 0===e&&(e=!0);var i=this.getVerticesData(l.b.PositionKind);if(!i)return this;if(t(i),this.updateVerticesData(l.b.PositionKind,i,!1,!1),e){var r=this.getIndices(),n=this.getVerticesData(l.b.NormalKind);if(!n)return this;f.a.ComputeNormals(i,r,n),this.updateVerticesData(l.b.NormalKind,n,!1,!1)}return this},e.prototype.makeGeometryUnique=function(){if(!this._geometry)return this;if(1===this._geometry.meshes.length)return this;var t=this._geometry,e=this._geometry.copy(d.a.RandomId());return t.releaseForMesh(this,!0),e.applyToMesh(this),this},e.prototype.setIndices=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!1),this._geometry)this._geometry.setIndices(t,e,i);else{var r=new f.a;r.indices=t;var n=this.getScene();new d.a(d.a.RandomId(),n,r,i,this)}return this},e.prototype.updateIndices=function(t,e,i){return void 0===i&&(i=!1),this._geometry?(this._geometry.updateIndices(t,e,i),this):this},e.prototype.toLeftHanded=function(){return this._geometry?(this._geometry.toLeftHanded(),this):this},e.prototype._bind=function(t,e,i){if(!this._geometry)return this;var r,n=this.getScene().getEngine();if(this._unIndexed)r=null;else switch(i){case m.a.PointFillMode:r=null;break;case m.a.WireFrameFillMode:r=t._getLinesIndexBuffer(this.getIndices(),n);break;default:case m.a.TriangleFillMode:r=this._geometry.getIndexBuffer()}return this._geometry._bind(e,r),this},e.prototype._draw=function(t,e,i){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeDrawObservable&&this._internalMeshDataInfo._onBeforeDrawObservable.notifyObservers(this);var r=this.getScene().getEngine();return this._unIndexed||e==m.a.PointFillMode?r.drawArraysType(e,t.verticesStart,t.verticesCount,i):e==m.a.WireFrameFillMode?r.drawElementsType(e,0,t._linesIndexCount,i):r.drawElementsType(e,t.indexStart,t.indexCount,i),this},e.prototype.registerBeforeRender=function(t){return this.onBeforeRenderObservable.add(t),this},e.prototype.unregisterBeforeRender=function(t){return this.onBeforeRenderObservable.removeCallback(t),this},e.prototype.registerAfterRender=function(t){return this.onAfterRenderObservable.add(t),this},e.prototype.unregisterAfterRender=function(t){return this.onAfterRenderObservable.removeCallback(t),this},e.prototype._getInstancesRenderList=function(t,e){if(void 0===e&&(e=!1),this._instanceDataStorage.isFrozen&&this._instanceDataStorage.previousBatch)return this._instanceDataStorage.previousBatch;var i=this.getScene(),r=i._isInIntermediateRendering(),n=r?this._internalAbstractMeshDataInfo._onlyForInstancesIntermediate:this._internalAbstractMeshDataInfo._onlyForInstances,o=this._instanceDataStorage.batchCache;if(o.mustReturn=!1,o.renderSelf[t]=e||!n&&this.isEnabled()&&this.isVisible,o.visibleInstances[t]=null,this._instanceDataStorage.visibleInstances&&!e){var s=this._instanceDataStorage.visibleInstances,a=i.getRenderId(),h=r?s.intermediateDefaultRenderId:s.defaultRenderId;o.visibleInstances[t]=s[a],!o.visibleInstances[t]&&h&&(o.visibleInstances[t]=s[h])}return o.hardwareInstancedRendering[t]=!e&&this._instanceDataStorage.hardwareInstancedRendering&&null!==o.visibleInstances[t]&&void 0!==o.visibleInstances[t],this._instanceDataStorage.previousBatch=o,o},e.prototype._renderWithInstances=function(t,e,i,r,n){var o=i.visibleInstances[t._id];if(!o)return this;for(var s=this._instanceDataStorage,a=s.instancesBufferSize,h=s.instancesBuffer,c=16*(o.length+1)*4;s.instancesBufferSize<c;)s.instancesBufferSize*=2;s.instancesData&&a==s.instancesBufferSize||(s.instancesData=new Float32Array(s.instancesBufferSize/4));var u=0,f=0,d=i.renderSelf[t._id],p=!h||a!==s.instancesBufferSize;if(this._instanceDataStorage.manualUpdate||s.isFrozen&&!p)f=(d?1:0)+o.length;else{var _=this._effectiveMesh.getWorldMatrix();if(d&&(_.copyToArray(s.instancesData,u),u+=16,f++),o)for(var g=0;g<o.length;g++){o[g].getWorldMatrix().copyToArray(s.instancesData,u),u+=16,f++}}return p?(h&&h.dispose(),h=new l.a(n,s.instancesData,!0,16,!1,!0),s.instancesBuffer=h,this.setVerticesBuffer(h.createVertexBuffer("world0",0,4)),this.setVerticesBuffer(h.createVertexBuffer("world1",4,4)),this.setVerticesBuffer(h.createVertexBuffer("world2",8,4)),this.setVerticesBuffer(h.createVertexBuffer("world3",12,4))):this._instanceDataStorage.isFrozen||h.updateDirectly(s.instancesData,0,f),this._processInstancedBuffers(o,d),this.getScene()._activeIndices.addCount(t.indexCount*f,!1),this._bind(t,r,e),this._draw(t,e,f),n.unbindInstanceAttributes(),this},e.prototype._renderWithThinInstances=function(t,e,i,r){var n,o,s=null!==(o=null===(n=this._thinInstanceDataStorage)||void 0===n?void 0:n.instancesCount)&&void 0!==o?o:0;this.getScene()._activeIndices.addCount(t.indexCount*s,!1),this._bind(t,i,e),this._draw(t,e,s),r.unbindInstanceAttributes()},e.prototype._processInstancedBuffers=function(t,e){},e.prototype._processRendering=function(t,e,i,r,n,o,s,a){var h=this.getScene(),c=h.getEngine();if(o&&e.getRenderingMesh().hasThinInstances)return this._renderWithThinInstances(e,r,i,c),this;if(o)this._renderWithInstances(e,r,n,i,c);else{var u=0;n.renderSelf[e._id]&&(s&&s(!1,t._effectiveMesh.getWorldMatrix(),a),u++,this._draw(e,r,this._instanceDataStorage.overridenInstanceCount));var l=n.visibleInstances[e._id];if(l){var f=l.length;u+=f;for(var d=0;d<f;d++){var p=l[d].getWorldMatrix();s&&s(!0,p,a),this._draw(e,r)}}h._activeIndices.addCount(e.indexCount*u,!1)}return this},e.prototype._rebuild=function(){this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null),t.prototype._rebuild.call(this)},e.prototype._freeze=function(){if(this.subMeshes){for(var t=0;t<this.subMeshes.length;t++)this._getInstancesRenderList(t);this._effectiveMaterial=null,this._instanceDataStorage.isFrozen=!0}},e.prototype._unFreeze=function(){this._instanceDataStorage.isFrozen=!1,this._instanceDataStorage.previousBatch=null},e.prototype.render=function(t,e,i){var r=this.getScene();if(this._internalAbstractMeshDataInfo._isActiveIntermediate?this._internalAbstractMeshDataInfo._isActiveIntermediate=!1:this._internalAbstractMeshDataInfo._isActive=!1,this._checkOcclusionQuery())return this;var n=this._getInstancesRenderList(t._id,!!i);if(n.mustReturn)return this;if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeRenderObservable&&this._internalMeshDataInfo._onBeforeRenderObservable.notifyObservers(this);var o,s=r.getEngine(),a=n.hardwareInstancedRendering[t._id]||t.getRenderingMesh().hasThinInstances,h=this._instanceDataStorage,c=t.getMaterial();if(!c)return this;if(!h.isFrozen||!this._effectiveMaterial||this._effectiveMaterial!==c){if(c._storeEffectOnSubMeshes){if(!c.isReadyForSubMesh(this,t,a))return this}else if(!c.isReady(this,a))return this;this._effectiveMaterial=c}e&&s.setAlphaMode(this._effectiveMaterial.alphaMode);for(var u=0,l=r._beforeRenderingMeshStage;u<l.length;u++){l[u].action(this,t,n)}if(!(o=this._effectiveMaterial._storeEffectOnSubMeshes?t.effect:this._effectiveMaterial.getEffect()))return this;r.prePassRenderer&&r.prePassRenderer.bindAttachmentsForEffect(o);var f,d=i||this._effectiveMesh;if(h.isFrozen||!this._effectiveMaterial.backFaceCulling&&null===this.overrideMaterialSideOrientation)f=h.sideOrientation;else{var p=d._getWorldMatrixDeterminant();null==(f=this.overrideMaterialSideOrientation)&&(f=this._effectiveMaterial.sideOrientation),p<0&&(f=f===m.a.ClockWiseSideOrientation?m.a.CounterClockWiseSideOrientation:m.a.ClockWiseSideOrientation),h.sideOrientation=f}var _=this._effectiveMaterial._preBind(o,f);this._effectiveMaterial.forceDepthWrite&&s.setDepthWrite(!0);var g=r.forcePointsCloud?m.a.PointFillMode:r.forceWireframe?m.a.WireFrameFillMode:this._effectiveMaterial.fillMode;this._internalMeshDataInfo._onBeforeBindObservable&&this._internalMeshDataInfo._onBeforeBindObservable.notifyObservers(this),a||this._bind(t,o,g);var y=d.getWorldMatrix();this._effectiveMaterial._storeEffectOnSubMeshes?this._effectiveMaterial.bindForSubMesh(y,this,t):this._effectiveMaterial.bind(y,this),!this._effectiveMaterial.backFaceCulling&&this._effectiveMaterial.separateCullingPass&&(s.setState(!0,this._effectiveMaterial.zOffset,!1,!_),this._processRendering(this,t,o,g,n,a,this._onBeforeDraw,this._effectiveMaterial),s.setState(!0,this._effectiveMaterial.zOffset,!1,_)),this._processRendering(this,t,o,g,n,a,this._onBeforeDraw,this._effectiveMaterial),this._effectiveMaterial.unbind();for(var b=0,v=r._afterRenderingMeshStage;b<v.length;b++){v[b].action(this,t,n)}return this._internalMeshDataInfo._onAfterRenderObservable&&this._internalMeshDataInfo._onAfterRenderObservable.notifyObservers(this),this},e.prototype._onBeforeDraw=function(t,e,i){t&&i&&i.bindOnlyWorldMatrix(e)},e.prototype.cleanMatrixWeights=function(){this.isVerticesDataPresent(l.b.MatricesWeightsKind)&&(this.isVerticesDataPresent(l.b.MatricesWeightsExtraKind)?this.normalizeSkinWeightsAndExtra():this.normalizeSkinFourWeights())},e.prototype.normalizeSkinFourWeights=function(){for(var t=this.getVerticesData(l.b.MatricesWeightsKind),e=t.length,i=0;i<e;i+=4){var r=t[i]+t[i+1]+t[i+2]+t[i+3];if(0===r)t[i]=1;else{var n=1/r;t[i]*=n,t[i+1]*=n,t[i+2]*=n,t[i+3]*=n}}this.setVerticesData(l.b.MatricesWeightsKind,t)},e.prototype.normalizeSkinWeightsAndExtra=function(){for(var t=this.getVerticesData(l.b.MatricesWeightsExtraKind),e=this.getVerticesData(l.b.MatricesWeightsKind),i=e.length,r=0;r<i;r+=4){var n=e[r]+e[r+1]+e[r+2]+e[r+3];if(0===(n+=t[r]+t[r+1]+t[r+2]+t[r+3]))e[r]=1;else{var o=1/n;e[r]*=o,e[r+1]*=o,e[r+2]*=o,e[r+3]*=o,t[r]*=o,t[r+1]*=o,t[r+2]*=o,t[r+3]*=o}}this.setVerticesData(l.b.MatricesWeightsKind,e),this.setVerticesData(l.b.MatricesWeightsKind,t)},e.prototype.validateSkinning=function(){var t=this.getVerticesData(l.b.MatricesWeightsExtraKind),e=this.getVerticesData(l.b.MatricesWeightsKind);if(null===e||null==this.skeleton)return{skinned:!1,valid:!0,report:"not skinned"};for(var i=e.length,r=0,n=0,o=0,s=0,a=null===t?4:8,h=new Array,c=0;c<=a;c++)h[c]=0;for(c=0;c<i;c+=4){for(var u=e[c],f=u,d=0===f?0:1,p=1;p<a;p++){var _=p<4?e[c+p]:t[c+p-4];_>u&&r++,0!==_&&d++,f+=_,u=_}if(h[d]++,d>o&&(o=d),0===f)n++;else{var g=1/f,m=0;for(p=0;p<a;p++)m+=p<4?Math.abs(e[c+p]-e[c+p]*g):Math.abs(t[c+p-4]-t[c+p-4]*g);m>.001&&s++}}var y=this.skeleton.bones.length,b=this.getVerticesData(l.b.MatricesIndicesKind),v=this.getVerticesData(l.b.MatricesIndicesExtraKind),M=0;for(c=0;c<i;c+=4)for(p=0;p<a;p++){var O=p<4?b[c+p]:v[c+p-4];(O>=y||O<0)&&M++}return{skinned:!0,valid:0===n&&0===s&&0===M,report:"Number of Weights = "+i/4+"\nMaximum influences = "+o+"\nMissing Weights = "+n+"\nNot Sorted = "+r+"\nNot Normalized = "+s+"\nWeightCounts = ["+h+"]\nNumber of bones = "+y+"\nBad Bone Indices = "+M}},e.prototype._checkDelayState=function(){var t=this.getScene();return this._geometry?this._geometry.load(t):4===this.delayLoadState&&(this.delayLoadState=2,this._queueLoad(t)),this},e.prototype._queueLoad=function(t){var e=this;t._addPendingData(this);var i=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata");return o.b.LoadFile(this.delayLoadingFile,(function(i){i instanceof ArrayBuffer?e._delayLoadingFunction(i,e):e._delayLoadingFunction(JSON.parse(i),e),e.instances.forEach((function(t){t.refreshBoundingInfo(),t._syncSubMeshes()})),e.delayLoadState=1,t._removePendingData(e)}),(function(){}),t.offlineProvider,i),this},e.prototype.isInFrustum=function(e){return 2!==this.delayLoadState&&(!!t.prototype.isInFrustum.call(this,e)&&(this._checkDelayState(),!0))},e.prototype.setMaterialByID=function(t){var e,i=this.getScene().materials;for(e=i.length-1;e>-1;e--)if(i[e].id===t)return this.material=i[e],this;var r=this.getScene().multiMaterials;for(e=r.length-1;e>-1;e--)if(r[e].id===t)return this.material=r[e],this;return this},e.prototype.getAnimatables=function(){var t=new Array;return this.material&&t.push(this.material),this.skeleton&&t.push(this.skeleton),t},e.prototype.bakeTransformIntoVertices=function(t){if(!this.isVerticesDataPresent(l.b.PositionKind))return this;var e=this.subMeshes.splice(0);this._resetPointsArrayCache();var i,r=this.getVerticesData(l.b.PositionKind),n=new Array;for(i=0;i<r.length;i+=3)h.e.TransformCoordinates(h.e.FromArray(r,i),t).toArray(n,i);if(this.setVerticesData(l.b.PositionKind,n,this.getVertexBuffer(l.b.PositionKind).isUpdatable()),this.isVerticesDataPresent(l.b.NormalKind)){for(r=this.getVerticesData(l.b.NormalKind),n=[],i=0;i<r.length;i+=3)h.e.TransformNormal(h.e.FromArray(r,i),t).normalize().toArray(n,i);this.setVerticesData(l.b.NormalKind,n,this.getVertexBuffer(l.b.NormalKind).isUpdatable())}return t.m[0]*t.m[5]*t.m[10]<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=e,this},e.prototype.bakeCurrentTransformIntoVertices=function(t){return void 0===t&&(t=!0),this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.resetLocalMatrix(t),this},Object.defineProperty(e.prototype,"_positions",{get:function(){return this._geometry?this._geometry._positions:null},enumerable:!1,configurable:!0}),e.prototype._resetPointsArrayCache=function(){return this._geometry&&this._geometry._resetPointsArrayCache(),this},e.prototype._generatePointsArray=function(){return!!this._geometry&&this._geometry._generatePointsArray()},e.prototype.clone=function(t,i,r,n){return void 0===t&&(t=""),void 0===i&&(i=null),void 0===n&&(n=!0),new e(t,this.getScene(),i,this,r,n)},e.prototype.dispose=function(e,i){void 0===i&&(i=!1),this.morphTargetManager=null,this._geometry&&this._geometry.releaseForMesh(this,!0);var r=this._internalMeshDataInfo;if(r._onBeforeDrawObservable&&r._onBeforeDrawObservable.clear(),r._onBeforeBindObservable&&r._onBeforeBindObservable.clear(),r._onBeforeRenderObservable&&r._onBeforeRenderObservable.clear(),r._onAfterRenderObservable&&r._onAfterRenderObservable.clear(),this._scene.useClonedMeshMap){if(r.meshMap)for(var n in r.meshMap){(a=r.meshMap[n])&&(a._internalMeshDataInfo._source=null,r.meshMap[n]=void 0)}r._source&&r._source._internalMeshDataInfo.meshMap&&(r._source._internalMeshDataInfo.meshMap[this.uniqueId]=void 0)}else for(var o=0,s=this.getScene().meshes;o<s.length;o++){var a;(a=s[o])._internalMeshDataInfo&&a._internalMeshDataInfo._source&&a._internalMeshDataInfo._source===this&&(a._internalMeshDataInfo._source=null)}r._source=null,this._disposeInstanceSpecificData(),this._disposeThinInstanceSpecificData(),t.prototype.dispose.call(this,e,i)},e.prototype._disposeInstanceSpecificData=function(){},e.prototype._disposeThinInstanceSpecificData=function(){},e.prototype.applyDisplacementMap=function(t,e,i,r,n,s,a){var h=this;void 0===a&&(a=!1);var c=this.getScene();return o.b.LoadImage(t,(function(t){var o=t.width,c=t.height,u=T.a.CreateCanvas(o,c).getContext("2d");u.drawImage(t,0,0);var l=u.getImageData(0,0,o,c).data;h.applyDisplacementMapFromBuffer(l,o,c,e,i,n,s,a),r&&r(h)}),(function(){}),c.offlineProvider),this},e.prototype.applyDisplacementMapFromBuffer=function(t,e,i,r,n,o,s,a){if(void 0===a&&(a=!1),!this.isVerticesDataPresent(l.b.PositionKind)||!this.isVerticesDataPresent(l.b.NormalKind)||!this.isVerticesDataPresent(l.b.UVKind))return M.a.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;var c=this.getVerticesData(l.b.PositionKind,!0,!0),u=this.getVerticesData(l.b.NormalKind),d=this.getVerticesData(l.b.UVKind),p=h.e.Zero(),_=h.e.Zero(),g=h.d.Zero();o=o||h.d.Zero(),s=s||new h.d(1,1);for(var m=0;m<c.length;m+=3){h.e.FromArrayToRef(c,m,p),h.e.FromArrayToRef(u,m,_),h.d.FromArrayToRef(d,m/3*2,g);var y=4*((Math.abs(g.x*s.x+o.x)*e%e|0)+(Math.abs(g.y*s.y+o.y)*i%i|0)*e),b=.3*(t[y]/255)+.59*(t[y+1]/255)+.11*(t[y+2]/255);_.normalize(),_.scaleInPlace(r+(n-r)*b),(p=p.add(_)).toArray(c,m)}return f.a.ComputeNormals(c,this.getIndices(),u),a?(this.setVerticesData(l.b.PositionKind,c),this.setVerticesData(l.b.NormalKind,u)):(this.updateVerticesData(l.b.PositionKind,c),this.updateVerticesData(l.b.NormalKind,u)),this},e.prototype.convertToFlatShadedMesh=function(){var t,e,i=this.getVerticesDataKinds(),r={},n={},o={},s=!1;for(t=0;t<i.length;t++){e=i[t];var a=this.getVertexBuffer(e);e!==l.b.NormalKind?(r[e]=a,n[e]=r[e].getData(),o[e]=[]):(s=a.isUpdatable(),i.splice(t,1),t--)}var c,u=this.subMeshes.slice(0),f=this.getIndices(),d=this.getTotalIndices();for(c=0;c<d;c++){var p=f[c];for(t=0;t<i.length;t++)for(var g=r[e=i[t]].getStrideSize(),m=0;m<g;m++)o[e].push(n[e][p*g+m])}var y=[],b=o[l.b.PositionKind];for(c=0;c<d;c+=3){f[c]=c,f[c+1]=c+1,f[c+2]=c+2;for(var v=h.e.FromArray(b,3*c),M=h.e.FromArray(b,3*(c+1)),O=h.e.FromArray(b,3*(c+2)),A=v.subtract(M),P=O.subtract(M),x=h.e.Normalize(h.e.Cross(A,P)),T=0;T<3;T++)y.push(x.x),y.push(x.y),y.push(x.z)}for(this.setIndices(f),this.setVerticesData(l.b.NormalKind,y,s),t=0;t<i.length;t++)e=i[t],this.setVerticesData(e,o[e],r[e].isUpdatable());this.releaseSubMeshes();for(var I=0;I<u.length;I++){var R=u[I];_.a.AddToMesh(R.materialIndex,R.indexStart,R.indexCount,R.indexStart,R.indexCount,this)}return this.synchronizeInstances(),this},e.prototype.convertToUnIndexedMesh=function(){var t,e,i=this.getVerticesDataKinds(),r={},n={},o={};for(t=0;t<i.length;t++){e=i[t];var s=this.getVertexBuffer(e);r[e]=s,n[e]=r[e].getData(),o[e]=[]}var a,h=this.subMeshes.slice(0),c=this.getIndices(),u=this.getTotalIndices();for(a=0;a<u;a++){var l=c[a];for(t=0;t<i.length;t++)for(var f=r[e=i[t]].getStrideSize(),d=0;d<f;d++)o[e].push(n[e][l*f+d])}for(a=0;a<u;a+=3)c[a]=a,c[a+1]=a+1,c[a+2]=a+2;for(this.setIndices(c),t=0;t<i.length;t++)e=i[t],this.setVerticesData(e,o[e],r[e].isUpdatable());this.releaseSubMeshes();for(var p=0;p<h.length;p++){var g=h[p];_.a.AddToMesh(g.materialIndex,g.indexStart,g.indexCount,g.indexStart,g.indexCount,this)}return this._unIndexed=!0,this.synchronizeInstances(),this},e.prototype.flipFaces=function(t){void 0===t&&(t=!1);var e,i,r=f.a.ExtractFromMesh(this);if(t&&this.isVerticesDataPresent(l.b.NormalKind)&&r.normals)for(e=0;e<r.normals.length;e++)r.normals[e]*=-1;if(r.indices)for(e=0;e<r.indices.length;e+=3)i=r.indices[e+1],r.indices[e+1]=r.indices[e+2],r.indices[e+2]=i;return r.applyToMesh(this,this.isVertexBufferUpdatable(l.b.PositionKind)),this},e.prototype.increaseVertices=function(t){var e=f.a.ExtractFromMesh(this),i=e.uvs,r=e.indices,n=e.positions,o=e.normals;if(null===r||null===n||null===o||null===i)M.a.Warn("VertexData contains null entries");else{for(var s,a,c=t+1,u=new Array,d=0;d<c+1;d++)u[d]=new Array;var p,_=new h.e(0,0,0),g=new h.e(0,0,0),m=new h.d(0,0),y=new Array,b=new Array,v=new Array,O=n.length,A=i.length;for(d=0;d<r.length;d+=3){b[0]=r[d],b[1]=r[d+1],b[2]=r[d+2];for(var P=0;P<3;P++)if(s=b[P],a=b[(P+1)%3],void 0===v[s]&&void 0===v[a]?(v[s]=new Array,v[a]=new Array):(void 0===v[s]&&(v[s]=new Array),void 0===v[a]&&(v[a]=new Array)),void 0===v[s][a]&&void 0===v[a][s]){v[s][a]=[],_.x=(n[3*a]-n[3*s])/c,_.y=(n[3*a+1]-n[3*s+1])/c,_.z=(n[3*a+2]-n[3*s+2])/c,g.x=(o[3*a]-o[3*s])/c,g.y=(o[3*a+1]-o[3*s+1])/c,g.z=(o[3*a+2]-o[3*s+2])/c,m.x=(i[2*a]-i[2*s])/c,m.y=(i[2*a+1]-i[2*s+1])/c,v[s][a].push(s);for(var x=1;x<c;x++)v[s][a].push(n.length/3),n[O]=n[3*s]+x*_.x,o[O++]=o[3*s]+x*g.x,n[O]=n[3*s+1]+x*_.y,o[O++]=o[3*s+1]+x*g.y,n[O]=n[3*s+2]+x*_.z,o[O++]=o[3*s+2]+x*g.z,i[A++]=i[2*s]+x*m.x,i[A++]=i[2*s+1]+x*m.y;v[s][a].push(a),v[a][s]=new Array,p=v[s][a].length;for(var T=0;T<p;T++)v[a][s][T]=v[s][a][p-1-T]}u[0][0]=r[d],u[1][0]=v[r[d]][r[d+1]][1],u[1][1]=v[r[d]][r[d+2]][1];for(x=2;x<c;x++){u[x][0]=v[r[d]][r[d+1]][x],u[x][x]=v[r[d]][r[d+2]][x],_.x=(n[3*u[x][x]]-n[3*u[x][0]])/x,_.y=(n[3*u[x][x]+1]-n[3*u[x][0]+1])/x,_.z=(n[3*u[x][x]+2]-n[3*u[x][0]+2])/x,g.x=(o[3*u[x][x]]-o[3*u[x][0]])/x,g.y=(o[3*u[x][x]+1]-o[3*u[x][0]+1])/x,g.z=(o[3*u[x][x]+2]-o[3*u[x][0]+2])/x,m.x=(i[2*u[x][x]]-i[2*u[x][0]])/x,m.y=(i[2*u[x][x]+1]-i[2*u[x][0]+1])/x;for(P=1;P<x;P++)u[x][P]=n.length/3,n[O]=n[3*u[x][0]]+P*_.x,o[O++]=o[3*u[x][0]]+P*g.x,n[O]=n[3*u[x][0]+1]+P*_.y,o[O++]=o[3*u[x][0]+1]+P*g.y,n[O]=n[3*u[x][0]+2]+P*_.z,o[O++]=o[3*u[x][0]+2]+P*g.z,i[A++]=i[2*u[x][0]]+P*m.x,i[A++]=i[2*u[x][0]+1]+P*m.y}u[c]=v[r[d+1]][r[d+2]],y.push(u[0][0],u[1][0],u[1][1]);for(x=1;x<c;x++){for(P=0;P<x;P++)y.push(u[x][P],u[x+1][P],u[x+1][P+1]),y.push(u[x][P],u[x+1][P+1],u[x][P+1]);y.push(u[x][P],u[x+1][P],u[x+1][P+1])}}e.indices=y,e.applyToMesh(this,this.isVertexBufferUpdatable(l.b.PositionKind))}},e.prototype.forceSharedVertices=function(){var t=f.a.ExtractFromMesh(this),e=t.uvs,i=t.indices,r=t.positions,n=t.colors;if(void 0===i||void 0===r||null===i||null===r)M.a.Warn("VertexData contains empty entries");else{for(var o,s,a=new Array,h=new Array,c=new Array,u=new Array,d=new Array,p=0,_={},g=0;g<i.length;g+=3){s=[i[g],i[g+1],i[g+2]],d=new Array;for(var m=0;m<3;m++){d[m]="";for(var y=0;y<3;y++)Math.abs(r[3*s[m]+y])<1e-8&&(r[3*s[m]+y]=0),d[m]+=r[3*s[m]+y]+"|"}if(d[0]!=d[1]&&d[0]!=d[2]&&d[1]!=d[2])for(m=0;m<3;m++){if(void 0===(o=_[d[m]])){_[d[m]]=p,o=p++;for(y=0;y<3;y++)a.push(r[3*s[m]+y]);if(null!=n)for(y=0;y<4;y++)u.push(n[4*s[m]+y]);if(null!=e)for(y=0;y<2;y++)c.push(e[2*s[m]+y])}h.push(o)}}var b=new Array;f.a.ComputeNormals(a,h,b),t.positions=a,t.indices=h,t.normals=b,null!=e&&(t.uvs=c),null!=n&&(t.colors=u),t.applyToMesh(this,this.isVertexBufferUpdatable(l.b.PositionKind))}},e._instancedMeshFactory=function(t,e){throw A.a.WarnImport("InstancedMesh")},e._PhysicsImpostorParser=function(t,e,i){throw A.a.WarnImport("PhysicsImpostor")},e.prototype.createInstance=function(t){var i=this.geometry;if(i&&i.meshes.length>1)for(var r=0,n=i.meshes.slice(0);r<n.length;r++){var o=n[r];o!==this&&o.makeGeometryUnique()}return e._instancedMeshFactory(t,this)},e.prototype.synchronizeInstances=function(){this._geometry&&1!==this._geometry.meshes.length&&this.instances.length&&this.makeGeometryUnique();for(var t=0;t<this.instances.length;t++){this.instances[t]._syncSubMeshes()}return this},e.prototype.optimizeIndices=function(t){var e=this,i=this.getIndices(),r=this.getVerticesData(l.b.PositionKind);if(!r||!i)return this;for(var n=new Array,s=0;s<r.length;s+=3)n.push(h.e.FromArray(r,s));var a=new Array;return o.a.SyncAsyncForLoop(n.length,40,(function(t){for(var e=n.length-1-t,i=n[e],r=0;r<e;++r){var o=n[r];if(i.equals(o)){a[e]=r;break}}}),(function(){for(var r=0;r<i.length;++r)i[r]=a[i[r]]||i[r];var n=e.subMeshes.slice(0);e.setIndices(i),e.subMeshes=n,t&&t(e)})),this},e.prototype.serialize=function(t){t.name=this.name,t.id=this.id,t.uniqueId=this.uniqueId,t.type=this.getClassName(),a.a&&a.a.HasTags(this)&&(t.tags=a.a.GetTags(this)),t.position=this.position.asArray(),this.rotationQuaternion?t.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(t.rotation=this.rotation.asArray()),t.scaling=this.scaling.asArray(),this._postMultiplyPivotMatrix?t.pivotMatrix=this.getPivotMatrix().asArray():t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(!1),t.isVisible=this.isVisible,t.infiniteDistance=this.infiniteDistance,t.pickable=this.isPickable,t.receiveShadows=this.receiveShadows,t.billboardMode=this.billboardMode,t.visibility=this.visibility,t.checkCollisions=this.checkCollisions,t.isBlocker=this.isBlocker,t.overrideMaterialSideOrientation=this.overrideMaterialSideOrientation,this.parent&&(t.parentId=this.parent.id),t.isUnIndexed=this.isUnIndexed;var e=this._geometry;if(e){var i=e.id;t.geometryId=i,t.subMeshes=[];for(var r=0;r<this.subMeshes.length;r++){var n=this.subMeshes[r];t.subMeshes.push({materialIndex:n.materialIndex,verticesStart:n.verticesStart,verticesCount:n.verticesCount,indexStart:n.indexStart,indexCount:n.indexCount})}}(this.material?this.material.doNotSerialize||(t.materialId=this.material.id):this.material=null,this.morphTargetManager&&(t.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(t.skeletonId=this.skeleton.id,t.numBoneInfluencers=this.numBoneInfluencers),this.getScene()._getComponent(P.a.NAME_PHYSICSENGINE))&&((h=this.getPhysicsImpostor())&&(t.physicsMass=h.getParam("mass"),t.physicsFriction=h.getParam("friction"),t.physicsRestitution=h.getParam("mass"),t.physicsImpostor=h.type));this.metadata&&(t.metadata=this.metadata),t.instances=[];for(var o=0;o<this.instances.length;o++){var s=this.instances[o];if(!s.doNotSerialize){var h,c={name:s.name,id:s.id,isEnabled:s.isEnabled(!1),isVisible:s.isVisible,isPickable:s.isPickable,checkCollisions:s.checkCollisions,position:s.position.asArray(),scaling:s.scaling.asArray()};if(s.parent&&(c.parentId=s.parent.id),s.rotationQuaternion?c.rotationQuaternion=s.rotationQuaternion.asArray():s.rotation&&(c.rotation=s.rotation.asArray()),this.getScene()._getComponent(P.a.NAME_PHYSICSENGINE))(h=s.getPhysicsImpostor())&&(c.physicsMass=h.getParam("mass"),c.physicsFriction=h.getParam("friction"),c.physicsRestitution=h.getParam("mass"),c.physicsImpostor=h.type);s.metadata&&(c.metadata=s.metadata),t.instances.push(c),v.a.AppendSerializedAnimations(s,c),c.ranges=s.serializeAnimationRanges()}}if(this._thinInstanceDataStorage.instancesCount&&this._thinInstanceDataStorage.matrixData&&(t.thinInstances={instancesCount:this._thinInstanceDataStorage.instancesCount,matrixData:Array.from(this._thinInstanceDataStorage.matrixData),matrixBufferSize:this._thinInstanceDataStorage.matrixBufferSize},this._userThinInstanceBuffersStorage)){var u={data:{},sizes:{},strides:{}};for(var l in this._userThinInstanceBuffersStorage.data)u.data[l]=Array.from(this._userThinInstanceBuffersStorage.data[l]),u.sizes[l]=this._userThinInstanceBuffersStorage.sizes[l],u.strides[l]=this._userThinInstanceBuffersStorage.strides[l];t.thinInstances.userThinInstance=u}v.a.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t.layerMask=this.layerMask,t.alphaIndex=this.alphaIndex,t.hasVertexAlpha=this.hasVertexAlpha,t.overlayAlpha=this.overlayAlpha,t.overlayColor=this.overlayColor.asArray(),t.renderOverlay=this.renderOverlay,t.applyFog=this.applyFog,this.actionManager&&(t.actions=this.actionManager.serialize(this.name))},e.prototype._syncGeometryWithMorphTargetManager=function(){if(this.geometry){this._markSubMeshesAsAttributesDirty();var t=this._internalMeshDataInfo._morphTargetManager;if(t&&t.vertexCount){if(t.vertexCount!==this.getTotalVertices())return M.a.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),void(this.morphTargetManager=null);for(var e=0;e<t.numInfluencers;e++){var i=t.getActiveTarget(e),r=i.getPositions();if(!r)return void M.a.Error("Invalid morph target. Target must have positions.");this.geometry.setVerticesData(l.b.PositionKind+e,r,!1,3);var n=i.getNormals();n&&this.geometry.setVerticesData(l.b.NormalKind+e,n,!1,3);var o=i.getTangents();o&&this.geometry.setVerticesData(l.b.TangentKind+e,o,!1,3);var s=i.getUVs();s&&this.geometry.setVerticesData(l.b.UVKind+"_"+e,s,!1,2)}}else for(e=0;this.geometry.isVerticesDataPresent(l.b.PositionKind+e);)this.geometry.removeVerticesData(l.b.PositionKind+e),this.geometry.isVerticesDataPresent(l.b.NormalKind+e)&&this.geometry.removeVerticesData(l.b.NormalKind+e),this.geometry.isVerticesDataPresent(l.b.TangentKind+e)&&this.geometry.removeVerticesData(l.b.TangentKind+e),this.geometry.isVerticesDataPresent(l.b.UVKind+e)&&this.geometry.removeVerticesData(l.b.UVKind+"_"+e),e++}},e.Parse=function(t,i,r){var n;if((n=t.type&&"GroundMesh"===t.type?e._GroundMeshParser(t,i):new e(t.name,i)).id=t.id,a.a&&a.a.AddTagsTo(n,t.tags),n.position=h.e.FromArray(t.position),void 0!==t.metadata&&(n.metadata=t.metadata),t.rotationQuaternion?n.rotationQuaternion=h.b.FromArray(t.rotationQuaternion):t.rotation&&(n.rotation=h.e.FromArray(t.rotation)),n.scaling=h.e.FromArray(t.scaling),t.localMatrix?n.setPreTransformMatrix(h.a.FromArray(t.localMatrix)):t.pivotMatrix&&n.setPivotMatrix(h.a.FromArray(t.pivotMatrix)),n.setEnabled(t.isEnabled),n.isVisible=t.isVisible,n.infiniteDistance=t.infiniteDistance,n.showBoundingBox=t.showBoundingBox,n.showSubMeshesBoundingBox=t.showSubMeshesBoundingBox,void 0!==t.applyFog&&(n.applyFog=t.applyFog),void 0!==t.pickable&&(n.isPickable=t.pickable),void 0!==t.alphaIndex&&(n.alphaIndex=t.alphaIndex),n.receiveShadows=t.receiveShadows,n.billboardMode=t.billboardMode,void 0!==t.visibility&&(n.visibility=t.visibility),n.checkCollisions=t.checkCollisions,n.overrideMaterialSideOrientation=t.overrideMaterialSideOrientation,void 0!==t.isBlocker&&(n.isBlocker=t.isBlocker),n._shouldGenerateFlatShading=t.useFlatShading,t.freezeWorldMatrix&&(n._waitingData.freezeWorldMatrix=t.freezeWorldMatrix),t.parentId&&(n._waitingParentId=t.parentId),void 0!==t.actions&&(n._waitingData.actions=t.actions),void 0!==t.overlayAlpha&&(n.overlayAlpha=t.overlayAlpha),void 0!==t.overlayColor&&(n.overlayColor=c.a.FromArray(t.overlayColor)),void 0!==t.renderOverlay&&(n.renderOverlay=t.renderOverlay),n.isUnIndexed=!!t.isUnIndexed,n.hasVertexAlpha=t.hasVertexAlpha,t.delayLoadingFile?(n.delayLoadState=4,n.delayLoadingFile=r+t.delayLoadingFile,n._boundingInfo=new g.a(h.e.FromArray(t.boundingBoxMinimum),h.e.FromArray(t.boundingBoxMaximum)),t._binaryInfo&&(n._binaryInfo=t._binaryInfo),n._delayInfo=[],t.hasUVs&&n._delayInfo.push(l.b.UVKind),t.hasUVs2&&n._delayInfo.push(l.b.UV2Kind),t.hasUVs3&&n._delayInfo.push(l.b.UV3Kind),t.hasUVs4&&n._delayInfo.push(l.b.UV4Kind),t.hasUVs5&&n._delayInfo.push(l.b.UV5Kind),t.hasUVs6&&n._delayInfo.push(l.b.UV6Kind),t.hasColors&&n._delayInfo.push(l.b.ColorKind),t.hasMatricesIndices&&n._delayInfo.push(l.b.MatricesIndicesKind),t.hasMatricesWeights&&n._delayInfo.push(l.b.MatricesWeightsKind),n._delayLoadingFunction=d.a._ImportGeometry,b.a.ForceFullSceneLoadingForIncremental&&n._checkDelayState()):d.a._ImportGeometry(t,n),t.materialId?n.setMaterialByID(t.materialId):n.material=null,t.morphTargetManagerId>-1&&(n.morphTargetManager=i.getMorphTargetManagerById(t.morphTargetManagerId)),void 0!==t.skeletonId&&null!==t.skeletonId&&(n.skeleton=i.getLastSkeletonByID(t.skeletonId),t.numBoneInfluencers&&(n.numBoneInfluencers=t.numBoneInfluencers)),t.animations){for(var o=0;o<t.animations.length;o++){var s=t.animations[o];(m=O.a.GetClass("BABYLON.Animation"))&&n.animations.push(m.Parse(s))}u.a.ParseAnimationRanges(n,t,i)}if(t.autoAnimate&&i.beginAnimation(n,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),t.layerMask&&!isNaN(t.layerMask)?n.layerMask=Math.abs(parseInt(t.layerMask)):n.layerMask=268435455,t.physicsImpostor&&e._PhysicsImpostorParser(i,n,t),t.lodMeshIds&&(n._waitingData.lods={ids:t.lodMeshIds,distances:t.lodDistances?t.lodDistances:null,coverages:t.lodCoverages?t.lodCoverages:null}),t.instances)for(var f=0;f<t.instances.length;f++){var p=t.instances[f],_=n.createInstance(p.name);if(p.id&&(_.id=p.id),a.a&&(p.tags?a.a.AddTagsTo(_,p.tags):a.a.AddTagsTo(_,t.tags)),_.position=h.e.FromArray(p.position),void 0!==p.metadata&&(_.metadata=p.metadata),p.parentId&&(_._waitingParentId=p.parentId),void 0!==p.isEnabled&&null!==p.isEnabled&&_.setEnabled(p.isEnabled),void 0!==p.isVisible&&null!==p.isVisible&&(_.isVisible=p.isVisible),void 0!==p.isPickable&&null!==p.isPickable&&(_.isPickable=p.isPickable),p.rotationQuaternion?_.rotationQuaternion=h.b.FromArray(p.rotationQuaternion):p.rotation&&(_.rotation=h.e.FromArray(p.rotation)),_.scaling=h.e.FromArray(p.scaling),null!=p.checkCollisions&&null!=p.checkCollisions&&(_.checkCollisions=p.checkCollisions),null!=p.pickable&&null!=p.pickable&&(_.isPickable=p.pickable),null!=p.showBoundingBox&&null!=p.showBoundingBox&&(_.showBoundingBox=p.showBoundingBox),null!=p.showSubMeshesBoundingBox&&null!=p.showSubMeshesBoundingBox&&(_.showSubMeshesBoundingBox=p.showSubMeshesBoundingBox),null!=p.alphaIndex&&null!=p.showSubMeshesBoundingBox&&(_.alphaIndex=p.alphaIndex),p.physicsImpostor&&e._PhysicsImpostorParser(i,_,p),p.animations){for(o=0;o<p.animations.length;o++){var m;s=p.animations[o],(m=O.a.GetClass("BABYLON.Animation"))&&_.animations.push(m.Parse(s))}u.a.ParseAnimationRanges(_,p,i),p.autoAnimate&&i.beginAnimation(_,p.autoAnimateFrom,p.autoAnimateTo,p.autoAnimateLoop,p.autoAnimateSpeed||1)}}if(t.thinInstances){var y=t.thinInstances;if(y.matrixData?(n.thinInstanceSetBuffer("matrix",new Float32Array(y.matrixData),16,!1),n._thinInstanceDataStorage.matrixBufferSize=y.matrixBufferSize,n._thinInstanceDataStorage.instancesCount=y.instancesCount):n._thinInstanceDataStorage.matrixBufferSize=y.matrixBufferSize,t.thinInstances.userThinInstance){var v=t.thinInstances.userThinInstance;for(var M in v.data)n.thinInstanceSetBuffer(M,new Float32Array(v.data[M]),v.strides[M],!1),n._userThinInstanceBuffersStorage.sizes[M]=v.sizes[M]}}return n},e.CreateRibbon=function(t,e,i,r,n,o,s,a,h){throw A.a.WarnImport("MeshBuilder")},e.CreateDisc=function(t,e,i,r,n,o){throw void 0===r&&(r=null),A.a.WarnImport("MeshBuilder")},e.CreateBox=function(t,e,i,r,n){throw void 0===i&&(i=null),A.a.WarnImport("MeshBuilder")},e.CreateSphere=function(t,e,i,r,n,o){throw A.a.WarnImport("MeshBuilder")},e.CreateHemisphere=function(t,e,i,r){throw A.a.WarnImport("MeshBuilder")},e.CreateCylinder=function(t,e,i,r,n,o,s,a,h){throw A.a.WarnImport("MeshBuilder")},e.CreateTorus=function(t,e,i,r,n,o,s){throw A.a.WarnImport("MeshBuilder")},e.CreateTorusKnot=function(t,e,i,r,n,o,s,a,h,c){throw A.a.WarnImport("MeshBuilder")},e.CreateLines=function(t,e,i,r,n){throw void 0===i&&(i=null),void 0===r&&(r=!1),void 0===n&&(n=null),A.a.WarnImport("MeshBuilder")},e.CreateDashedLines=function(t,e,i,r,n,o,s,a){throw void 0===o&&(o=null),A.a.WarnImport("MeshBuilder")},e.CreatePolygon=function(t,e,i,r,n,o,s){throw void 0===s&&(s=earcut),A.a.WarnImport("MeshBuilder")},e.ExtrudePolygon=function(t,e,i,r,n,o,s,a){throw void 0===a&&(a=earcut),A.a.WarnImport("MeshBuilder")},e.ExtrudeShape=function(t,e,i,r,n,o,s,a,h,c){throw void 0===s&&(s=null),A.a.WarnImport("MeshBuilder")},e.ExtrudeShapeCustom=function(t,e,i,r,n,o,s,a,h,c,u,l){throw A.a.WarnImport("MeshBuilder")},e.CreateLathe=function(t,e,i,r,n,o,s){throw A.a.WarnImport("MeshBuilder")},e.CreatePlane=function(t,e,i,r,n){throw A.a.WarnImport("MeshBuilder")},e.CreateGround=function(t,e,i,r,n,o){throw A.a.WarnImport("MeshBuilder")},e.CreateTiledGround=function(t,e,i,r,n,o,s,a,h){throw A.a.WarnImport("MeshBuilder")},e.CreateGroundFromHeightMap=function(t,e,i,r,n,o,s,a,h,c,u){throw A.a.WarnImport("MeshBuilder")},e.CreateTube=function(t,e,i,r,n,o,s,a,h,c){throw A.a.WarnImport("MeshBuilder")},e.CreatePolyhedron=function(t,e,i){throw A.a.WarnImport("MeshBuilder")},e.CreateIcoSphere=function(t,e,i){throw A.a.WarnImport("MeshBuilder")},e.CreateDecal=function(t,e,i,r,n,o){throw A.a.WarnImport("MeshBuilder")},e.CreateCapsule=function(t,e,i){throw A.a.WarnImport("MeshBuilder")},e.prototype.setPositionsForCPUSkinning=function(){var t=this._internalMeshDataInfo;if(!t._sourcePositions){var e=this.getVerticesData(l.b.PositionKind);if(!e)return t._sourcePositions;t._sourcePositions=new Float32Array(e),this.isVertexBufferUpdatable(l.b.PositionKind)||this.setVerticesData(l.b.PositionKind,e,!0)}return t._sourcePositions},e.prototype.setNormalsForCPUSkinning=function(){var t=this._internalMeshDataInfo;if(!t._sourceNormals){var e=this.getVerticesData(l.b.NormalKind);if(!e)return t._sourceNormals;t._sourceNormals=new Float32Array(e),this.isVertexBufferUpdatable(l.b.NormalKind)||this.setVerticesData(l.b.NormalKind,e,!0)}return t._sourceNormals},e.prototype.applySkeleton=function(t){if(!this.geometry)return this;if(this.geometry._softwareSkinningFrameId==this.getScene().getFrameId())return this;if(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),!this.isVerticesDataPresent(l.b.PositionKind))return this;if(!this.isVerticesDataPresent(l.b.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(l.b.MatricesWeightsKind))return this;var e=this.isVerticesDataPresent(l.b.NormalKind),i=this._internalMeshDataInfo;if(!i._sourcePositions){var r=this.subMeshes.slice();this.setPositionsForCPUSkinning(),this.subMeshes=r}e&&!i._sourceNormals&&this.setNormalsForCPUSkinning();var n=this.getVerticesData(l.b.PositionKind);if(!n)return this;n instanceof Float32Array||(n=new Float32Array(n));var o=this.getVerticesData(l.b.NormalKind);if(e){if(!o)return this;o instanceof Float32Array||(o=new Float32Array(o))}var s=this.getVerticesData(l.b.MatricesIndicesKind),a=this.getVerticesData(l.b.MatricesWeightsKind);if(!a||!s)return this;for(var c,u=this.numBoneInfluencers>4,f=u?this.getVerticesData(l.b.MatricesIndicesExtraKind):null,d=u?this.getVerticesData(l.b.MatricesWeightsExtraKind):null,p=t.getTransformMatrices(this),_=h.e.Zero(),g=new h.a,m=new h.a,y=0,b=0;b<n.length;b+=3,y+=4){var v;for(c=0;c<4;c++)(v=a[y+c])>0&&(h.a.FromFloat32ArrayToRefScaled(p,Math.floor(16*s[y+c]),v,m),g.addToSelf(m));if(u)for(c=0;c<4;c++)(v=d[y+c])>0&&(h.a.FromFloat32ArrayToRefScaled(p,Math.floor(16*f[y+c]),v,m),g.addToSelf(m));h.e.TransformCoordinatesFromFloatsToRef(i._sourcePositions[b],i._sourcePositions[b+1],i._sourcePositions[b+2],g,_),_.toArray(n,b),e&&(h.e.TransformNormalFromFloatsToRef(i._sourceNormals[b],i._sourceNormals[b+1],i._sourceNormals[b+2],g,_),_.toArray(o,b)),g.reset()}return this.updateVerticesData(l.b.PositionKind,n),e&&this.updateVerticesData(l.b.NormalKind,o),this},e.MinMax=function(t){var e=null,i=null;return t.forEach((function(t){var r=t.getBoundingInfo().boundingBox;e&&i?(e.minimizeInPlace(r.minimumWorld),i.maximizeInPlace(r.maximumWorld)):(e=r.minimumWorld,i=r.maximumWorld)})),e&&i?{min:e,max:i}:{min:h.e.Zero(),max:h.e.Zero()}},e.Center=function(t){var i=t instanceof Array?e.MinMax(t):t;return h.e.Center(i.min,i.max)},e.MergeMeshes=function(t,i,r,n,o,s){var a;if(void 0===i&&(i=!0),!r){var h=0;for(a=0;a<t.length;a++)if(t[a]&&(h+=t[a].getTotalVertices())>=65536)return M.a.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}if(s){var c,u,l=null;o=!1}var d,p=new Array,g=new Array,m=null,b=new Array,v=null;for(a=0;a<t.length;a++)if(t[a]){var O=t[a];if(O.isAnInstance)return M.a.Warn("Cannot merge instance meshes."),null;var A=O.computeWorldMatrix(!0);if((d=f.a.ExtractFromMesh(O,!0,!0)).transform(A),m?m.merge(d,r):(m=d,v=O),o&&b.push(O.getTotalIndices()),s)if(O.material){var P=O.material;if(P instanceof y.a){for(u=0;u<P.subMaterials.length;u++)p.indexOf(P.subMaterials[u])<0&&p.push(P.subMaterials[u]);for(c=0;c<O.subMeshes.length;c++)g.push(p.indexOf(P.subMaterials[O.subMeshes[c].materialIndex])),b.push(O.subMeshes[c].indexCount)}else for(p.indexOf(P)<0&&p.push(P),c=0;c<O.subMeshes.length;c++)g.push(p.indexOf(P)),b.push(O.subMeshes[c].indexCount)}else for(c=0;c<O.subMeshes.length;c++)g.push(0),b.push(O.subMeshes[c].indexCount)}if(v=v,n||(n=new e(v.name+"_merged",v.getScene())),m.applyToMesh(n),n.checkCollisions=v.checkCollisions,n.overrideMaterialSideOrientation=v.overrideMaterialSideOrientation,i)for(a=0;a<t.length;a++)t[a]&&t[a].dispose();if(o||s){n.releaseSubMeshes(),a=0;for(var x=0;a<b.length;)_.a.CreateFromIndices(0,x,b[a],n),x+=b[a],a++}if(s){for((l=new y.a(v.name+"_merged",v.getScene())).subMaterials=p,c=0;c<n.subMeshes.length;c++)n.subMeshes[c].materialIndex=g[c];n.material=l}else n.material=v.material;return n},e.prototype.addInstance=function(t){t._indexInSourceMeshInstanceArray=this.instances.length,this.instances.push(t)},e.prototype.removeInstance=function(t){var e=t._indexInSourceMeshInstanceArray;if(-1!=e){if(e!==this.instances.length-1){var i=this.instances[this.instances.length-1];this.instances[e]=i,i._indexInSourceMeshInstanceArray=e}t._indexInSourceMeshInstanceArray=-1,this.instances.pop()}},e.FRONTSIDE=f.a.FRONTSIDE,e.BACKSIDE=f.a.BACKSIDE,e.DOUBLESIDE=f.a.DOUBLESIDE,e.DEFAULTSIDE=f.a.DEFAULTSIDE,e.NO_CAP=0,e.CAP_START=1,e.CAP_END=2,e.CAP_ALL=3,e.NO_FLIP=0,e.FLIP_TILE=1,e.ROTATE_TILE=2,e.FLIP_ROW=3,e.ROTATE_ROW=4,e.FLIP_N_ROTATE_TILE=5,e.FLIP_N_ROTATE_ROW=6,e.CENTER=0,e.LEFT=1,e.RIGHT=2,e.TOP=3,e.BOTTOM=4,e._GroundMeshParser=function(t,e){throw A.a.WarnImport("GroundMesh")},e}(p.a);O.a.RegisteredTypes["BABYLON.Mesh"]=E},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var r=i(3),n=i(37),o=i(0),s=i(34),a=i(71),h=i(35),c=i(5),u=i(197),l=i(229),f=i(89),d=i(11),p=function(t){function e(i,r,n,s,a,h,c,l,f,d,p){void 0===n&&(n=!1),void 0===s&&(s=!0),void 0===a&&(a=e.TRILINEAR_SAMPLINGMODE),void 0===h&&(h=null),void 0===c&&(c=null),void 0===l&&(l=null),void 0===f&&(f=!1);var _=t.call(this,r)||this;_.url=null,_.uOffset=0,_.vOffset=0,_.uScale=1,_.vScale=1,_.uAng=0,_.vAng=0,_.wAng=0,_.uRotationCenter=.5,_.vRotationCenter=.5,_.wRotationCenter=.5,_.inspectableCustomProperties=null,_._noMipmap=!1,_._invertY=!1,_._rowGenerationMatrix=null,_._cachedTextureMatrix=null,_._projectionModeMatrix=null,_._t0=null,_._t1=null,_._t2=null,_._cachedUOffset=-1,_._cachedVOffset=-1,_._cachedUScale=0,_._cachedVScale=0,_._cachedUAng=-1,_._cachedVAng=-1,_._cachedWAng=-1,_._cachedProjectionMatrixId=-1,_._cachedCoordinatesMode=-1,_._initialSamplingMode=e.BILINEAR_SAMPLINGMODE,_._buffer=null,_._deleteBuffer=!1,_._format=null,_._delayedOnLoad=null,_._delayedOnError=null,_.onLoadObservable=new o.a,_._isBlocking=!0,_.name=i||"",_.url=i,_._noMipmap=n,_._invertY=s,_._initialSamplingMode=a,_._buffer=l,_._deleteBuffer=f,_._mimeType=p,d&&(_._format=d);var g=_.getScene(),m=_._getEngine();if(!m)return _;m.onBeforeTextureInitObservable.notifyObservers(_);var y=function(){_._texture&&(_._texture._invertVScale&&(_.vScale*=-1,_.vOffset+=1),null!==_._texture._cachedWrapU&&(_.wrapU=_._texture._cachedWrapU,_._texture._cachedWrapU=null),null!==_._texture._cachedWrapV&&(_.wrapV=_._texture._cachedWrapV,_._texture._cachedWrapV=null),null!==_._texture._cachedWrapR&&(_.wrapR=_._texture._cachedWrapR,_._texture._cachedWrapR=null)),_.onLoadObservable.hasObservers()&&_.onLoadObservable.notifyObservers(_),h&&h(),!_.isBlocking&&g&&g.resetCachedMaterial()};return _.url?(_._texture=_._getFromCache(_.url,n,a,s),_._texture?_._texture.isReady?u.a.SetImmediate((function(){return y()})):_._texture.onLoadedObservable.add(y):g&&g.useDelayedTextureLoading?(_.delayLoadState=4,_._delayedOnLoad=y,_._delayedOnError=c):(_._texture=m.createTexture(_.url,n,s,g,a,y,c,_._buffer,void 0,_._format,null,p),f&&(_._buffer=null)),_):(_._delayedOnLoad=y,_._delayedOnError=c,_)}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mimeType",{get:function(){return this._mimeType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(t){this._isBlocking=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"invertY",{get:function(){return this._invertY},enumerable:!1,configurable:!0}),e.prototype.updateURL=function(t,e,i){void 0===e&&(e=null),this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1)),this.name&&!d.a.StartsWith(this.name,"data:")||(this.name=t),this.url=t,this._buffer=e,this.delayLoadState=4,i&&(this._delayedOnLoad=i),this.delayLoad()},e.prototype.delayLoad=function(){if(4===this.delayLoadState){var t=this.getScene();t&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY),this._texture?this._delayedOnLoad&&(this._texture.isReady?u.a.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=t.getEngine().createTexture(this.url,this._noMipmap,this._invertY,t,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,null,this._mimeType),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}},e.prototype._prepareRowForTextureGeneration=function(t,e,i,r){t*=this._cachedUScale,e*=this._cachedVScale,t-=this.uRotationCenter*this._cachedUScale,e-=this.vRotationCenter*this._cachedVScale,i-=this.wRotationCenter,s.e.TransformCoordinatesFromFloatsToRef(t,e,i,this._rowGenerationMatrix,r),r.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,r.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,r.z+=this.wRotationCenter},e.prototype.getTextureMatrix=function(t){var e=this;if(void 0===t&&(t=1),this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*t===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*t,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedTextureMatrix||(this._cachedTextureMatrix=s.a.Zero(),this._rowGenerationMatrix=new s.a,this._t0=s.e.Zero(),this._t1=s.e.Zero(),this._t2=s.e.Zero()),s.a.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),s.a.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix);var i=this.getScene();return i?(i.markAllMaterialsAsDirty(1,(function(t){return t.hasTexture(e)})),this._cachedTextureMatrix):this._cachedTextureMatrix},e.prototype.getReflectionTextureMatrix=function(){var t=this,i=this.getScene();if(!i)return this._cachedTextureMatrix;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode){if(this.coordinatesMode!==e.PROJECTION_MODE)return this._cachedTextureMatrix;if(this._cachedProjectionMatrixId===i.getProjectionMatrix().updateFlag)return this._cachedTextureMatrix}switch(this._cachedTextureMatrix||(this._cachedTextureMatrix=s.a.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=s.a.Zero()),this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case e.PLANAR_MODE:s.a.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix[0]=this.uScale,this._cachedTextureMatrix[5]=this.vScale,this._cachedTextureMatrix[12]=this.uOffset,this._cachedTextureMatrix[13]=this.vOffset;break;case e.PROJECTION_MODE:s.a.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var r=i.getProjectionMatrix();this._cachedProjectionMatrixId=r.updateFlag,r.multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:s.a.IdentityToRef(this._cachedTextureMatrix)}return i.markAllMaterialsAsDirty(1,(function(e){return-1!==e.getActiveTextures().indexOf(t)})),this._cachedTextureMatrix},e.prototype.clone=function(){var t=this;return n.a.Clone((function(){return new e(t._texture?t._texture.url:null,t.getScene(),t._noMipmap,t._invertY,t.samplingMode,void 0,void 0,t._texture?t._texture._buffer:void 0)}),this)},e.prototype.serialize=function(){var i=this.name;e.SerializeBuffers||d.a.StartsWith(this.name,"data:")&&(this.name=""),d.a.StartsWith(this.name,"data:")&&this.url===this.name&&(this.url="");var r=t.prototype.serialize.call(this);return r?(e.SerializeBuffers&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(r.base64String=this._buffer,r.name=r.name.replace("data:","")):this.url&&d.a.StartsWith(this.url,"data:")&&this._buffer instanceof Uint8Array&&(r.base64String="data:image/png;base64,"+d.a.EncodeArrayBufferToBase64(this._buffer))),r.invertY=this._invertY,r.samplingMode=this.samplingMode,this.name=i,r):null},e.prototype.getClassName=function(){return"Texture"},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null},e.Parse=function(t,i,r){if(t.customType){var o=l.a.Instantiate(t.customType).Parse(t,i,r);return t.samplingMode&&o.updateSamplingMode&&o._samplingMode&&o._samplingMode!==t.samplingMode&&o.updateSamplingMode(t.samplingMode),o}if(t.isCube&&!t.isRenderTarget)return e._CubeTextureParser(t,i,r);if(!t.name&&!t.isRenderTarget)return null;var s=n.a.Parse((function(){var n,o=!0;if(t.noMipmap&&(o=!1),t.mirrorPlane){var s=e._CreateMirror(t.name,t.renderTargetSize,i,o);return s._waitingRenderList=t.renderList,s.mirrorPlane=f.a.FromArray(t.mirrorPlane),s}if(t.isRenderTarget){var a=null;if(t.isCube){if(i.reflectionProbes)for(var h=0;h<i.reflectionProbes.length;h++){var c=i.reflectionProbes[h];if(c.name===t.name)return c.cubeTexture}}else(a=e._CreateRenderTargetTexture(t.name,t.renderTargetSize,i,o))._waitingRenderList=t.renderList;return a}if(t.base64String)n=e.CreateFromBase64String(t.base64String,t.name,i,!o,t.invertY);else{var u=void 0;u=t.name&&t.name.indexOf("://")>0?t.name:r+t.name,(d.a.StartsWith(t.url,"data:")||e.UseSerializedUrlIfAny&&t.url)&&(u=t.url),n=new e(u,i,!o,t.invertY)}return n}),t,i);if(s&&s._texture&&(s._texture._cachedWrapU=null,s._texture._cachedWrapV=null,s._texture._cachedWrapR=null),t.samplingMode){var a=t.samplingMode;s&&s.samplingMode!==a&&s.updateSamplingMode(a)}if(s&&t.animations)for(var c=0;c<t.animations.length;c++){var u=t.animations[c],p=h.a.GetClass("BABYLON.Animation");p&&s.animations.push(p.Parse(u))}return s},e.CreateFromBase64String=function(t,i,r,n,o,s,a,h,c){return void 0===s&&(s=e.TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===h&&(h=null),void 0===c&&(c=5),new e("data:"+i,r,n,o,s,a,h,t,!1,c)},e.LoadFromDataString=function(t,i,r,n,o,s,a,h,c,u){return void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!0),void 0===a&&(a=e.TRILINEAR_SAMPLINGMODE),void 0===h&&(h=null),void 0===c&&(c=null),void 0===u&&(u=5),"data:"!==t.substr(0,5)&&(t="data:"+t),new e(t,r,o,s,a,h,c,i,n,u)},e.SerializeBuffers=!0,e._CubeTextureParser=function(t,e,i){throw c.a.WarnImport("CubeTexture")},e._CreateMirror=function(t,e,i,r){throw c.a.WarnImport("MirrorTexture")},e._CreateRenderTargetTexture=function(t,e,i,r){throw c.a.WarnImport("RenderTargetTexture")},e.NEAREST_SAMPLINGMODE=1,e.NEAREST_NEAREST_MIPLINEAR=8,e.BILINEAR_SAMPLINGMODE=2,e.LINEAR_LINEAR_MIPNEAREST=11,e.TRILINEAR_SAMPLINGMODE=3,e.LINEAR_LINEAR_MIPLINEAR=3,e.NEAREST_NEAREST_MIPNEAREST=4,e.NEAREST_LINEAR_MIPNEAREST=5,e.NEAREST_LINEAR_MIPLINEAR=6,e.NEAREST_LINEAR=7,e.NEAREST_NEAREST=1,e.LINEAR_NEAREST_MIPNEAREST=9,e.LINEAR_NEAREST_MIPLINEAR=10,e.LINEAR_LINEAR=2,e.LINEAR_NEAREST=12,e.EXPLICIT_MODE=0,e.SPHERICAL_MODE=1,e.PLANAR_MODE=2,e.CUBIC_MODE=3,e.PROJECTION_MODE=4,e.SKYBOX_MODE=5,e.INVCUBIC_MODE=6,e.EQUIRECTANGULAR_MODE=7,e.FIXED_EQUIRECTANGULAR_MODE=8,e.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,e.CLAMP_ADDRESSMODE=0,e.WRAP_ADDRESSMODE=1,e.MIRROR_ADDRESSMODE=2,e.UseSerializedUrlIfAny=!1,Object(r.c)([Object(n.c)()],e.prototype,"url",void 0),Object(r.c)([Object(n.c)()],e.prototype,"uOffset",void 0),Object(r.c)([Object(n.c)()],e.prototype,"vOffset",void 0),Object(r.c)([Object(n.c)()],e.prototype,"uScale",void 0),Object(r.c)([Object(n.c)()],e.prototype,"vScale",void 0),Object(r.c)([Object(n.c)()],e.prototype,"uAng",void 0),Object(r.c)([Object(n.c)()],e.prototype,"vAng",void 0),Object(r.c)([Object(n.c)()],e.prototype,"wAng",void 0),Object(r.c)([Object(n.c)()],e.prototype,"uRotationCenter",void 0),Object(r.c)([Object(n.c)()],e.prototype,"vRotationCenter",void 0),Object(r.c)([Object(n.c)()],e.prototype,"wRotationCenter",void 0),Object(r.c)([Object(n.c)()],e.prototype,"isBlocking",null),e}(a.a);h.a.RegisteredTypes["BABYLON.Texture"]=p,n.a._TextureParser=p.Parse},function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return n}));var r=function(){function t(t,e,i,r,n,o,s,a){void 0===r&&(r=0),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),t.getScene?this._engine=t.getScene().getEngine():this._engine=t,this._updatable=i,this._instanced=o,this._divisor=a||1,this._data=e,this.byteStride=s?r:r*Float32Array.BYTES_PER_ELEMENT,n||this.create()}return t.prototype.createVertexBuffer=function(t,e,i,r,o,s,a){void 0===s&&(s=!1);var h=s?e:e*Float32Array.BYTES_PER_ELEMENT,c=r?s?r:r*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new n(this._engine,this,t,this._updatable,!0,c,void 0===o?this._instanced:o,h,i,void 0,void 0,!0,this._divisor||a)},t.prototype.isUpdatable=function(){return this._updatable},t.prototype.getData=function(){return this._data},t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},t.prototype.create=function(t){void 0===t&&(t=null),!t&&this._buffer||(t=t||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,t),this._data=t):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(t),this._data=t):this._buffer=this._engine.createVertexBuffer(t))},t.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},t.prototype.update=function(t){this.create(t)},t.prototype.updateDirectly=function(t,e,i,r){void 0===r&&(r=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,t,r?e:e*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),this._data=null)},t.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)},t}(),n=function(){function t(e,i,n,o,s,a,h,c,u,l,f,d,p){if(void 0===f&&(f=!1),void 0===d&&(d=!1),void 0===p&&(p=1),i instanceof r?(this._buffer=i,this._ownsBuffer=!1):(this._buffer=new r(e,i,o,a,s,h,d),this._ownsBuffer=!0),this._kind=n,null==l){var _=this.getData();this.type=t.FLOAT,_ instanceof Int8Array?this.type=t.BYTE:_ instanceof Uint8Array?this.type=t.UNSIGNED_BYTE:_ instanceof Int16Array?this.type=t.SHORT:_ instanceof Uint16Array?this.type=t.UNSIGNED_SHORT:_ instanceof Int32Array?this.type=t.INT:_ instanceof Uint32Array&&(this.type=t.UNSIGNED_INT)}else this.type=l;var g=t.GetTypeByteLength(this.type);d?(this._size=u||(a?a/g:t.DeduceStride(n)),this.byteStride=a||this._buffer.byteStride||this._size*g,this.byteOffset=c||0):(this._size=u||a||t.DeduceStride(n),this.byteStride=a?a*g:this._buffer.byteStride||this._size*g,this.byteOffset=(c||0)*g),this.normalized=f,this._instanced=void 0!==h&&h,this._instanceDivisor=h?p:0}return Object.defineProperty(t.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(t){this._instanceDivisor=t,this._instanced=0!=t},enumerable:!1,configurable:!0}),t.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},t.prototype.getKind=function(){return this._kind},t.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},t.prototype.getData=function(){return this._buffer.getData()},t.prototype.getBuffer=function(){return this._buffer.getBuffer()},t.prototype.getStrideSize=function(){return this.byteStride/t.GetTypeByteLength(this.type)},t.prototype.getOffset=function(){return this.byteOffset/t.GetTypeByteLength(this.type)},t.prototype.getSize=function(){return this._size},t.prototype.getIsInstanced=function(){return this._instanced},t.prototype.getInstanceDivisor=function(){return this._instanceDivisor},t.prototype.create=function(t){this._buffer.create(t)},t.prototype.update=function(t){this._buffer.update(t)},t.prototype.updateDirectly=function(t,e,i){void 0===i&&(i=!1),this._buffer.updateDirectly(t,e,void 0,i)},t.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},t.prototype.forEach=function(e,i){t.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,i)},t.DeduceStride=function(e){switch(e){case t.UVKind:case t.UV2Kind:case t.UV3Kind:case t.UV4Kind:case t.UV5Kind:case t.UV6Kind:return 2;case t.NormalKind:case t.PositionKind:return 3;case t.ColorKind:case t.MatricesIndicesKind:case t.MatricesIndicesExtraKind:case t.MatricesWeightsKind:case t.MatricesWeightsExtraKind:case t.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}},t.GetTypeByteLength=function(e){switch(e){case t.BYTE:case t.UNSIGNED_BYTE:return 1;case t.SHORT:case t.UNSIGNED_SHORT:return 2;case t.INT:case t.UNSIGNED_INT:case t.FLOAT:return 4;default:throw new Error("Invalid type '"+e+"'")}},t.ForEach=function(e,i,r,n,o,s,a,h){if(e instanceof Array)for(var c=i/4,u=r/4,l=0;l<s;l+=n){for(var f=0;f<n;f++)h(e[c+f],l+f);c+=u}else{var d=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),p=t.GetTypeByteLength(o);for(l=0;l<s;l+=n){var _=i;for(f=0;f<n;f++){h(t._GetFloatValue(d,o,_,a),l+f),_+=p}i+=r}}},t._GetFloatValue=function(e,i,r,n){switch(i){case t.BYTE:var o=e.getInt8(r);return n&&(o=Math.max(o/127,-1)),o;case t.UNSIGNED_BYTE:o=e.getUint8(r);return n&&(o/=255),o;case t.SHORT:o=e.getInt16(r,!0);return n&&(o=Math.max(o/32767,-1)),o;case t.UNSIGNED_SHORT:o=e.getUint16(r,!0);return n&&(o/=65535),o;case t.INT:return e.getInt32(r,!0);case t.UNSIGNED_INT:return e.getUint32(r,!0);case t.FLOAT:return e.getFloat32(r,!0);default:throw new Error("Invalid component type "+i)}},t.BYTE=5120,t.UNSIGNED_BYTE=5121,t.SHORT=5122,t.UNSIGNED_SHORT=5123,t.INT=5124,t.UNSIGNED_INT=5125,t.FLOAT=5126,t.PositionKind="position",t.NormalKind="normal",t.TangentKind="tangent",t.UVKind="uv",t.UV2Kind="uv2",t.UV3Kind="uv3",t.UV4Kind="uv4",t.UV5Kind="uv5",t.UV6Kind="uv6",t.ColorKind="color",t.MatricesIndicesKind="matricesIndices",t.MatricesWeightsKind="matricesWeights",t.MatricesIndicesExtraKind="matricesIndicesExtra",t.MatricesWeightsExtraKind="matricesWeightsExtra",t}()},function(t,e,i){"use strict";i.d(e,"b",(function(){return g})),i.d(e,"a",(function(){return m}));var r=i(0),n=i(2),o=i(1),s=i(59),a=i(8),h=i(5),c=i(78),u=i(6),l=i(120),f=i(196),d=i(197),p=i(229),_=i(198),g=function(){function t(){}return Object.defineProperty(t,"BaseUrl",{get:function(){return l.a.BaseUrl},set:function(t){l.a.BaseUrl=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DefaultRetryStrategy",{get:function(){return l.a.DefaultRetryStrategy},set:function(t){l.a.DefaultRetryStrategy=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CorsBehavior",{get:function(){return l.a.CorsBehavior},set:function(t){l.a.CorsBehavior=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UseFallbackTexture",{get:function(){return u.a.UseFallbackTexture},set:function(t){u.a.UseFallbackTexture=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"RegisteredExternalClasses",{get:function(){return p.a.RegisteredExternalClasses},set:function(t){p.a.RegisteredExternalClasses=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fallbackTexture",{get:function(){return u.a.FallbackTexture},set:function(t){u.a.FallbackTexture=t},enumerable:!1,configurable:!0}),t.FetchToRef=function(t,e,i,r,n,o){var s=4*((Math.abs(t)*i%i|0)+(Math.abs(e)*r%r|0)*i);o.r=n[s]/255,o.g=n[s+1]/255,o.b=n[s+2]/255,o.a=n[s+3]/255},t.Mix=function(t,e,i){return t*(1-i)+e*i},t.Instantiate=function(t){return p.a.Instantiate(t)},t.Slice=function(t,e,i){return t.slice?t.slice(e,i):Array.prototype.slice.call(t,e,i)},t.SetImmediate=function(t){d.a.SetImmediate(t)},t.IsExponentOfTwo=function(t){var e=1;do{e*=2}while(e<t);return e===t},t.FloatRound=function(e){return Math.fround?Math.fround(e):t._tmpFloatArray[0]=e},t.GetFilename=function(t){var e=t.lastIndexOf("/");return e<0?t:t.substring(e+1)},t.GetFolderPath=function(t,e){void 0===e&&(e=!1);var i=t.lastIndexOf("/");return i<0?e?t:"":t.substring(0,i+1)},t.ToDegrees=function(t){return 180*t/Math.PI},t.ToRadians=function(t){return t*Math.PI/180},t.MakeArray=function(t,e){return!0===e||void 0!==t&&null!=t?Array.isArray(t)?t:[t]:null},t.GetPointerPrefix=function(t){var e="pointer";return n.a.IsWindowObjectExist()&&!window.PointerEvent&&n.a.IsNavigatorAvailable()&&!navigator.pointerEnabled&&(e="mouse"),!t._badDesktopOS||t._badOS||document&&"ontouchend"in document||(e="mouse"),e},t.SetCorsBehavior=function(t,e){l.a.SetCorsBehavior(t,e)},t.CleanUrl=function(t){return t=t.replace(/#/gm,"%23")},Object.defineProperty(t,"PreprocessUrl",{get:function(){return l.a.PreprocessUrl},set:function(t){l.a.PreprocessUrl=t},enumerable:!1,configurable:!0}),t.LoadImage=function(t,e,i,r,n){return l.a.LoadImage(t,e,i,r,n)},t.LoadFile=function(t,e,i,r,n,o){return l.a.LoadFile(t,e,i,r,n,o)},t.LoadFileAsync=function(t,e){return void 0===e&&(e=!0),new Promise((function(i,r){l.a.LoadFile(t,(function(t){i(t)}),void 0,void 0,e,(function(t,e){r(e)}))}))},t.LoadScript=function(t,e,i,r){if(n.a.IsWindowObjectExist()){var o=document.getElementsByTagName("head")[0],s=document.createElement("script");s.setAttribute("type","text/javascript"),s.setAttribute("src",t),r&&(s.id=r),s.onload=function(){e&&e()},s.onerror=function(e){i&&i("Unable to load script '"+t+"'",e)},o.appendChild(s)}},t.LoadScriptAsync=function(t,e){var i=this;return new Promise((function(e,r){i.LoadScript(t,(function(){e()}),(function(t,e){r(e)}))}))},t.ReadFileAsDataURL=function(t,e,i){var n=new FileReader,o={onCompleteObservable:new r.a,abort:function(){return n.abort()}};return n.onloadend=function(t){o.onCompleteObservable.notifyObservers(o)},n.onload=function(t){e(t.target.result)},n.onprogress=i,n.readAsDataURL(t),o},t.ReadFile=function(t,e,i,r,n){return l.a.ReadFile(t,e,i,r,n)},t.FileAsURL=function(t){var e=new Blob([t]);return(window.URL||window.webkitURL).createObjectURL(e)},t.Format=function(t,e){return void 0===e&&(e=2),t.toFixed(e)},t.DeepCopy=function(t,e,i,r){s.a.DeepCopy(t,e,i,r)},t.IsEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},t.RegisterTopRootEvents=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];t.addEventListener(r.name,r.handler,!1);try{window.parent&&window.parent.addEventListener(r.name,r.handler,!1)}catch(t){}}},t.UnregisterTopRootEvents=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];t.removeEventListener(r.name,r.handler);try{t.parent&&t.parent.removeEventListener(r.name,r.handler)}catch(t){}}},t.DumpFramebuffer=function(e,i,r,n,o,s){void 0===o&&(o="image/png");for(var a=4*e,h=i/2,c=r.readPixels(0,0,e,i),u=0;u<h;u++)for(var l=0;l<a;l++){var f=l+u*a,d=l+(i-u-1)*a,p=c[f];c[f]=c[d],c[d]=p}t._ScreenshotCanvas||(t._ScreenshotCanvas=document.createElement("canvas")),t._ScreenshotCanvas.width=e,t._ScreenshotCanvas.height=i;var _=t._ScreenshotCanvas.getContext("2d");if(_){var g=_.createImageData(e,i);g.data.set(c),_.putImageData(g,0,0),t.EncodeScreenshotCanvasData(n,o,s)}},t.ToBlob=function(t,e,i){void 0===i&&(i="image/png"),t.toBlob||(t.toBlob=function(t,e,i){var r=this;setTimeout((function(){for(var n=atob(r.toDataURL(e,i).split(",")[1]),o=n.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=n.charCodeAt(a);t(new Blob([s]))}))}),t.toBlob((function(t){e(t)}),i)},t.EncodeScreenshotCanvasData=function(e,i,r){(void 0===i&&(i="image/png"),e)?e(t._ScreenshotCanvas.toDataURL(i)):this.ToBlob(t._ScreenshotCanvas,(function(e){if("download"in document.createElement("a")){if(!r){var i=new Date,n=(i.getFullYear()+"-"+(i.getMonth()+1)).slice(2)+"-"+i.getDate()+"_"+i.getHours()+"-"+("0"+i.getMinutes()).slice(-2);r="screenshot_"+n+".png"}t.Download(e,r)}else{var o=URL.createObjectURL(e),s=window.open("");if(!s)return;var a=s.document.createElement("img");a.onload=function(){URL.revokeObjectURL(o)},a.src=o,s.document.body.appendChild(a)}}),i)},t.Download=function(t,e){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(t,e);else{var i=window.URL.createObjectURL(t),r=document.createElement("a");document.body.appendChild(r),r.style.display="none",r.href=i,r.download=e,r.addEventListener("click",(function(){r.parentElement&&r.parentElement.removeChild(r)})),r.click(),window.URL.revokeObjectURL(i)}},t.CreateScreenshot=function(t,e,i,r,n){throw void 0===n&&(n="image/png"),h.a.WarnImport("ScreenshotTools")},t.CreateScreenshotAsync=function(t,e,i,r){throw void 0===r&&(r="image/png"),h.a.WarnImport("ScreenshotTools")},t.CreateScreenshotUsingRenderTarget=function(t,e,i,r,n,o,s,a){throw void 0===n&&(n="image/png"),void 0===o&&(o=1),void 0===s&&(s=!1),h.a.WarnImport("ScreenshotTools")},t.CreateScreenshotUsingRenderTargetAsync=function(t,e,i,r,n,o,s){throw void 0===r&&(r="image/png"),void 0===n&&(n=1),void 0===o&&(o=!1),h.a.WarnImport("ScreenshotTools")},t.RandomId=function(){return _.a.RandomId()},t.IsBase64=function(t){return!(t.length<5)&&"data:"===t.substr(0,5)},t.DecodeBase64=function(t){for(var e=atob(t.split(",")[1]),i=e.length,r=new Uint8Array(new ArrayBuffer(i)),n=0;n<i;n++)r[n]=e.charCodeAt(n);return r.buffer},t.GetAbsoluteUrl=function(t){var e=document.createElement("a");return e.href=t,e.href},Object.defineProperty(t,"errorsCount",{get:function(){return o.a.errorsCount},enumerable:!1,configurable:!0}),t.Log=function(t){o.a.Log(t)},t.Warn=function(t){o.a.Warn(t)},t.Error=function(t){o.a.Error(t)},Object.defineProperty(t,"LogCache",{get:function(){return o.a.LogCache},enumerable:!1,configurable:!0}),t.ClearLogCache=function(){o.a.ClearLogCache()},Object.defineProperty(t,"LogLevels",{set:function(t){o.a.LogLevels=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PerformanceLogLevel",{set:function(e){return(e&t.PerformanceUserMarkLogLevel)===t.PerformanceUserMarkLogLevel?(t.StartPerformanceCounter=t._StartUserMark,void(t.EndPerformanceCounter=t._EndUserMark)):(e&t.PerformanceConsoleLogLevel)===t.PerformanceConsoleLogLevel?(t.StartPerformanceCounter=t._StartPerformanceConsole,void(t.EndPerformanceCounter=t._EndPerformanceConsole)):(t.StartPerformanceCounter=t._StartPerformanceCounterDisabled,void(t.EndPerformanceCounter=t._EndPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),t._StartPerformanceCounterDisabled=function(t,e){},t._EndPerformanceCounterDisabled=function(t,e){},t._StartUserMark=function(e,i){if(void 0===i&&(i=!0),!t._performance){if(!n.a.IsWindowObjectExist())return;t._performance=window.performance}i&&t._performance.mark&&t._performance.mark(e+"-Begin")},t._EndUserMark=function(e,i){void 0===i&&(i=!0),i&&t._performance.mark&&(t._performance.mark(e+"-End"),t._performance.measure(e,e+"-Begin",e+"-End"))},t._StartPerformanceConsole=function(e,i){void 0===i&&(i=!0),i&&(t._StartUserMark(e,i),console.time&&console.time(e))},t._EndPerformanceConsole=function(e,i){void 0===i&&(i=!0),i&&(t._EndUserMark(e,i),console.timeEnd(e))},Object.defineProperty(t,"Now",{get:function(){return a.a.Now},enumerable:!1,configurable:!0}),t.GetClassName=function(t,e){void 0===e&&(e=!1);var i=null;if(!e&&t.getClassName)i=t.getClassName();else{if(t instanceof Object)i=(e?t:Object.getPrototypeOf(t)).constructor.__bjsclassName__;i||(i=typeof t)}return i},t.First=function(t,e){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(e(n))return n}return null},t.getFullClassName=function(t,e){void 0===e&&(e=!1);var i=null,r=null;if(!e&&t.getClassName)i=t.getClassName();else{if(t instanceof Object){var n=e?t:Object.getPrototypeOf(t);i=n.constructor.__bjsclassName__,r=n.constructor.__bjsmoduleName__}i||(i=typeof t)}return i?(null!=r?r+".":"")+i:null},t.DelayAsync=function(t){return new Promise((function(e){setTimeout((function(){e()}),t)}))},t.IsSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.UseCustomRequestHeaders=!1,t.CustomRequestHeaders=c.a.CustomRequestHeaders,t._tmpFloatArray=new Float32Array(1),t.GetDOMTextContent=n.a.GetDOMTextContent,t.NoneLogLevel=o.a.NoneLogLevel,t.MessageLogLevel=o.a.MessageLogLevel,t.WarningLogLevel=o.a.WarningLogLevel,t.ErrorLogLevel=o.a.ErrorLogLevel,t.AllLogLevel=o.a.AllLogLevel,t.IsWindowObjectExist=n.a.IsWindowObjectExist,t.PerformanceNoneLogLevel=0,t.PerformanceUserMarkLogLevel=1,t.PerformanceConsoleLogLevel=2,t.StartPerformanceCounter=t._StartPerformanceCounterDisabled,t.EndPerformanceCounter=t._EndPerformanceCounterDisabled,t}();var m=function(){function t(t,e,i,r){void 0===r&&(r=0),this.iterations=t,this.index=r-1,this._done=!1,this._fn=e,this._successCallback=i}return t.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},t.prototype.breakLoop=function(){this._done=!0,this._successCallback()},t.Run=function(e,i,r,n){void 0===n&&(n=0);var o=new t(e,i,r,n);return o.executeNext(),o},t.SyncAsyncForLoop=function(e,i,r,n,o,s){return void 0===s&&(s=0),t.Run(Math.ceil(e/i),(function(t){o&&o()?t.breakLoop():setTimeout((function(){for(var n=0;n<i;++n){var s=t.index*i+n;if(s>=e)break;if(r(s),o&&o()){t.breakLoop();break}}t.executeNext()}),s)}),n)},t}();u.a.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z",f.a.Apply()},,function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var r=i(34),n=i(40),o=i(5),s=i(36),a=i(1),h=function(){function t(){}return t.prototype.set=function(t,e){switch(t.length||a.a.Warn("Setting vertex data kind '"+e+"' with an empty array"),e){case n.b.PositionKind:this.positions=t;break;case n.b.NormalKind:this.normals=t;break;case n.b.TangentKind:this.tangents=t;break;case n.b.UVKind:this.uvs=t;break;case n.b.UV2Kind:this.uvs2=t;break;case n.b.UV3Kind:this.uvs3=t;break;case n.b.UV4Kind:this.uvs4=t;break;case n.b.UV5Kind:this.uvs5=t;break;case n.b.UV6Kind:this.uvs6=t;break;case n.b.ColorKind:this.colors=t;break;case n.b.MatricesIndicesKind:this.matricesIndices=t;break;case n.b.MatricesWeightsKind:this.matricesWeights=t;break;case n.b.MatricesIndicesExtraKind:this.matricesIndicesExtra=t;break;case n.b.MatricesWeightsExtraKind:this.matricesWeightsExtra=t}},t.prototype.applyToMesh=function(t,e){return this._applyTo(t,e),this},t.prototype.applyToGeometry=function(t,e){return this._applyTo(t,e),this},t.prototype.updateMesh=function(t){return this._update(t),this},t.prototype.updateGeometry=function(t){return this._update(t),this},t.prototype._applyTo=function(t,e){return void 0===e&&(e=!1),this.positions&&t.setVerticesData(n.b.PositionKind,this.positions,e),this.normals&&t.setVerticesData(n.b.NormalKind,this.normals,e),this.tangents&&t.setVerticesData(n.b.TangentKind,this.tangents,e),this.uvs&&t.setVerticesData(n.b.UVKind,this.uvs,e),this.uvs2&&t.setVerticesData(n.b.UV2Kind,this.uvs2,e),this.uvs3&&t.setVerticesData(n.b.UV3Kind,this.uvs3,e),this.uvs4&&t.setVerticesData(n.b.UV4Kind,this.uvs4,e),this.uvs5&&t.setVerticesData(n.b.UV5Kind,this.uvs5,e),this.uvs6&&t.setVerticesData(n.b.UV6Kind,this.uvs6,e),this.colors&&t.setVerticesData(n.b.ColorKind,this.colors,e),this.matricesIndices&&t.setVerticesData(n.b.MatricesIndicesKind,this.matricesIndices,e),this.matricesWeights&&t.setVerticesData(n.b.MatricesWeightsKind,this.matricesWeights,e),this.matricesIndicesExtra&&t.setVerticesData(n.b.MatricesIndicesExtraKind,this.matricesIndicesExtra,e),this.matricesWeightsExtra&&t.setVerticesData(n.b.MatricesWeightsExtraKind,this.matricesWeightsExtra,e),this.indices?t.setIndices(this.indices,null,e):t.setIndices([],null),this},t.prototype._update=function(t,e,i){return this.positions&&t.updateVerticesData(n.b.PositionKind,this.positions,e,i),this.normals&&t.updateVerticesData(n.b.NormalKind,this.normals,e,i),this.tangents&&t.updateVerticesData(n.b.TangentKind,this.tangents,e,i),this.uvs&&t.updateVerticesData(n.b.UVKind,this.uvs,e,i),this.uvs2&&t.updateVerticesData(n.b.UV2Kind,this.uvs2,e,i),this.uvs3&&t.updateVerticesData(n.b.UV3Kind,this.uvs3,e,i),this.uvs4&&t.updateVerticesData(n.b.UV4Kind,this.uvs4,e,i),this.uvs5&&t.updateVerticesData(n.b.UV5Kind,this.uvs5,e,i),this.uvs6&&t.updateVerticesData(n.b.UV6Kind,this.uvs6,e,i),this.colors&&t.updateVerticesData(n.b.ColorKind,this.colors,e,i),this.matricesIndices&&t.updateVerticesData(n.b.MatricesIndicesKind,this.matricesIndices,e,i),this.matricesWeights&&t.updateVerticesData(n.b.MatricesWeightsKind,this.matricesWeights,e,i),this.matricesIndicesExtra&&t.updateVerticesData(n.b.MatricesIndicesExtraKind,this.matricesIndicesExtra,e,i),this.matricesWeightsExtra&&t.updateVerticesData(n.b.MatricesWeightsExtraKind,this.matricesWeightsExtra,e,i),this.indices&&t.setIndices(this.indices,null),this},t.prototype.transform=function(t){var e,i=t.m[0]*t.m[5]*t.m[10]<0,n=r.e.Zero();if(this.positions){var o=r.e.Zero();for(e=0;e<this.positions.length;e+=3)r.e.FromArrayToRef(this.positions,e,o),r.e.TransformCoordinatesToRef(o,t,n),this.positions[e]=n.x,this.positions[e+1]=n.y,this.positions[e+2]=n.z}if(this.normals){var s=r.e.Zero();for(e=0;e<this.normals.length;e+=3)r.e.FromArrayToRef(this.normals,e,s),r.e.TransformNormalToRef(s,t,n),this.normals[e]=n.x,this.normals[e+1]=n.y,this.normals[e+2]=n.z}if(this.tangents){var a=r.f.Zero(),h=r.f.Zero();for(e=0;e<this.tangents.length;e+=4)r.f.FromArrayToRef(this.tangents,e,a),r.f.TransformNormalToRef(a,t,h),this.tangents[e]=h.x,this.tangents[e+1]=h.y,this.tangents[e+2]=h.z,this.tangents[e+3]=h.w}if(i&&this.indices)for(e=0;e<this.indices.length;e+=3){var c=this.indices[e+1];this.indices[e+1]=this.indices[e+2],this.indices[e+2]=c}return this},t.prototype.merge=function(t,e){if(void 0===e&&(e=!1),this._validate(),t._validate(),!this.normals!=!t.normals||!this.tangents!=!t.tangents||!this.uvs!=!t.uvs||!this.uvs2!=!t.uvs2||!this.uvs3!=!t.uvs3||!this.uvs4!=!t.uvs4||!this.uvs5!=!t.uvs5||!this.uvs6!=!t.uvs6||!this.colors!=!t.colors||!this.matricesIndices!=!t.matricesIndices||!this.matricesWeights!=!t.matricesWeights||!this.matricesIndicesExtra!=!t.matricesIndicesExtra||!this.matricesWeightsExtra!=!t.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes");if(t.indices){this.indices||(this.indices=[]);var i=this.positions?this.positions.length/3:0;if(void 0!==this.indices.BYTES_PER_ELEMENT){var r=this.indices.length+t.indices.length,n=e||this.indices instanceof Uint32Array?new Uint32Array(r):new Uint16Array(r);n.set(this.indices);for(var o=this.indices.length,s=0;s<t.indices.length;s++)n[o+s]=t.indices[s]+i;this.indices=n}else for(s=0;s<t.indices.length;s++)this.indices.push(t.indices[s]+i)}return this.positions=this._mergeElement(this.positions,t.positions),this.normals=this._mergeElement(this.normals,t.normals),this.tangents=this._mergeElement(this.tangents,t.tangents),this.uvs=this._mergeElement(this.uvs,t.uvs),this.uvs2=this._mergeElement(this.uvs2,t.uvs2),this.uvs3=this._mergeElement(this.uvs3,t.uvs3),this.uvs4=this._mergeElement(this.uvs4,t.uvs4),this.uvs5=this._mergeElement(this.uvs5,t.uvs5),this.uvs6=this._mergeElement(this.uvs6,t.uvs6),this.colors=this._mergeElement(this.colors,t.colors),this.matricesIndices=this._mergeElement(this.matricesIndices,t.matricesIndices),this.matricesWeights=this._mergeElement(this.matricesWeights,t.matricesWeights),this.matricesIndicesExtra=this._mergeElement(this.matricesIndicesExtra,t.matricesIndicesExtra),this.matricesWeightsExtra=this._mergeElement(this.matricesWeightsExtra,t.matricesWeightsExtra),this},t.prototype._mergeElement=function(t,e){if(!t)return e;if(!e)return t;var i=e.length+t.length,r=t instanceof Float32Array,n=e instanceof Float32Array;if(r){var o=new Float32Array(i);return o.set(t),o.set(e,t.length),o}if(n){var s=t.slice(0),a=0;for(i=e.length;a<i;a++)s.push(e[a]);return s}return t.concat(e)},t.prototype._validate=function(){if(!this.positions)throw new Error("Positions are required");var t=function(t,e){var i=n.b.DeduceStride(t);if(e.length%i!=0)throw new Error("The "+t+"s array count must be a multiple of "+i);return e.length/i},e=t(n.b.PositionKind,this.positions),i=function(i,r){var n=t(i,r);if(n!==e)throw new Error("The "+i+"s element count ("+n+") does not match the positions count ("+e+")")};this.normals&&i(n.b.NormalKind,this.normals),this.tangents&&i(n.b.TangentKind,this.tangents),this.uvs&&i(n.b.UVKind,this.uvs),this.uvs2&&i(n.b.UV2Kind,this.uvs2),this.uvs3&&i(n.b.UV3Kind,this.uvs3),this.uvs4&&i(n.b.UV4Kind,this.uvs4),this.uvs5&&i(n.b.UV5Kind,this.uvs5),this.uvs6&&i(n.b.UV6Kind,this.uvs6),this.colors&&i(n.b.ColorKind,this.colors),this.matricesIndices&&i(n.b.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&i(n.b.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&i(n.b.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&i(n.b.MatricesWeightsExtraKind,this.matricesWeightsExtra)},t.prototype.serialize=function(){var t=this.serialize();return this.positions&&(t.positions=this.positions),this.normals&&(t.normals=this.normals),this.tangents&&(t.tangents=this.tangents),this.uvs&&(t.uvs=this.uvs),this.uvs2&&(t.uvs2=this.uvs2),this.uvs3&&(t.uvs3=this.uvs3),this.uvs4&&(t.uvs4=this.uvs4),this.uvs5&&(t.uvs5=this.uvs5),this.uvs6&&(t.uvs6=this.uvs6),this.colors&&(t.colors=this.colors),this.matricesIndices&&(t.matricesIndices=this.matricesIndices,t.matricesIndices._isExpanded=!0),this.matricesWeights&&(t.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(t.matricesIndicesExtra=this.matricesIndicesExtra,t.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(t.matricesWeightsExtra=this.matricesWeightsExtra),t.indices=this.indices,t},t.ExtractFromMesh=function(e,i,r){return t._ExtractFrom(e,i,r)},t.ExtractFromGeometry=function(e,i,r){return t._ExtractFrom(e,i,r)},t._ExtractFrom=function(e,i,r){var o=new t;return e.isVerticesDataPresent(n.b.PositionKind)&&(o.positions=e.getVerticesData(n.b.PositionKind,i,r)),e.isVerticesDataPresent(n.b.NormalKind)&&(o.normals=e.getVerticesData(n.b.NormalKind,i,r)),e.isVerticesDataPresent(n.b.TangentKind)&&(o.tangents=e.getVerticesData(n.b.TangentKind,i,r)),e.isVerticesDataPresent(n.b.UVKind)&&(o.uvs=e.getVerticesData(n.b.UVKind,i,r)),e.isVerticesDataPresent(n.b.UV2Kind)&&(o.uvs2=e.getVerticesData(n.b.UV2Kind,i,r)),e.isVerticesDataPresent(n.b.UV3Kind)&&(o.uvs3=e.getVerticesData(n.b.UV3Kind,i,r)),e.isVerticesDataPresent(n.b.UV4Kind)&&(o.uvs4=e.getVerticesData(n.b.UV4Kind,i,r)),e.isVerticesDataPresent(n.b.UV5Kind)&&(o.uvs5=e.getVerticesData(n.b.UV5Kind,i,r)),e.isVerticesDataPresent(n.b.UV6Kind)&&(o.uvs6=e.getVerticesData(n.b.UV6Kind,i,r)),e.isVerticesDataPresent(n.b.ColorKind)&&(o.colors=e.getVerticesData(n.b.ColorKind,i,r)),e.isVerticesDataPresent(n.b.MatricesIndicesKind)&&(o.matricesIndices=e.getVerticesData(n.b.MatricesIndicesKind,i,r)),e.isVerticesDataPresent(n.b.MatricesWeightsKind)&&(o.matricesWeights=e.getVerticesData(n.b.MatricesWeightsKind,i,r)),e.isVerticesDataPresent(n.b.MatricesIndicesExtraKind)&&(o.matricesIndicesExtra=e.getVerticesData(n.b.MatricesIndicesExtraKind,i,r)),e.isVerticesDataPresent(n.b.MatricesWeightsExtraKind)&&(o.matricesWeightsExtra=e.getVerticesData(n.b.MatricesWeightsExtraKind,i,r)),o.indices=e.getIndices(i,r),o},t.CreateRibbon=function(t){throw o.a.WarnImport("ribbonBuilder")},t.CreateBox=function(t){throw o.a.WarnImport("boxBuilder")},t.CreateTiledBox=function(t){throw o.a.WarnImport("tiledBoxBuilder")},t.CreateTiledPlane=function(t){throw o.a.WarnImport("tiledPlaneBuilder")},t.CreateSphere=function(t){throw o.a.WarnImport("sphereBuilder")},t.CreateCylinder=function(t){throw o.a.WarnImport("cylinderBuilder")},t.CreateTorus=function(t){throw o.a.WarnImport("torusBuilder")},t.CreateLineSystem=function(t){throw o.a.WarnImport("linesBuilder")},t.CreateDashedLines=function(t){throw o.a.WarnImport("linesBuilder")},t.CreateGround=function(t){throw o.a.WarnImport("groundBuilder")},t.CreateTiledGround=function(t){throw o.a.WarnImport("groundBuilder")},t.CreateGroundFromHeightMap=function(t){throw o.a.WarnImport("groundBuilder")},t.CreatePlane=function(t){throw o.a.WarnImport("planeBuilder")},t.CreateDisc=function(t){throw o.a.WarnImport("discBuilder")},t.CreatePolygon=function(t,e,i,r,n,s,a){throw o.a.WarnImport("polygonBuilder")},t.CreateIcoSphere=function(t){throw o.a.WarnImport("icoSphereBuilder")},t.CreatePolyhedron=function(t){throw o.a.WarnImport("polyhedronBuilder")},t.CreateCapsule=function(t){throw void 0===t&&(t={orientation:r.e.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}),o.a.WarnImport("capsuleBuilder")},t.CreateTorusKnot=function(t){throw o.a.WarnImport("torusKnotBuilder")},t.ComputeNormals=function(t,e,i,n){var o=0,s=0,a=0,h=0,c=0,u=0,l=0,f=0,d=0,p=0,_=0,g=0,m=0,y=0,b=0,v=0,M=0,O=0,A=0,P=0,x=!1,T=!1,I=!1,R=!1,C=1,D=0,S=null;if(n&&(x=!!n.facetNormals,T=!!n.facetPositions,I=!!n.facetPartitioning,C=!0===n.useRightHandedSystem?-1:1,D=n.ratio||0,R=!!n.depthSort,S=n.distanceTo,R)){void 0===S&&(S=r.e.Zero());var E=n.depthSortedFacets}var w=0,F=0,B=0,N=0;if(I&&n&&n.bbSize){var L=0,k=0,U=0,V=0,j=0,z=0,K=0,W=0,G=0,Y=0,H=0,q=0,Q=0,X=0,Z=0,J=0,$=n.bbSize.x>n.bbSize.y?n.bbSize.x:n.bbSize.y;$=$>n.bbSize.z?$:n.bbSize.z,w=n.subDiv.X*D/n.bbSize.x,F=n.subDiv.Y*D/n.bbSize.y,B=n.subDiv.Z*D/n.bbSize.z,N=n.subDiv.max*n.subDiv.max,n.facetPartitioning.length=0}for(o=0;o<t.length;o++)i[o]=0;var tt=e.length/3|0;for(o=0;o<tt;o++){if(m=(g=3*e[3*o])+1,y=g+2,v=(b=3*e[3*o+1])+1,M=b+2,A=(O=3*e[3*o+2])+1,P=O+2,s=t[g]-t[b],a=t[m]-t[v],h=t[y]-t[M],c=t[O]-t[b],u=t[A]-t[v],f=C*(a*(l=t[P]-t[M])-h*u),d=C*(h*c-s*l),p=C*(s*u-a*c),f/=_=0===(_=Math.sqrt(f*f+d*d+p*p))?1:_,d/=_,p/=_,x&&n&&(n.facetNormals[o].x=f,n.facetNormals[o].y=d,n.facetNormals[o].z=p),T&&n&&(n.facetPositions[o].x=(t[g]+t[b]+t[O])/3,n.facetPositions[o].y=(t[m]+t[v]+t[A])/3,n.facetPositions[o].z=(t[y]+t[M]+t[P])/3),I&&n&&(L=Math.floor((n.facetPositions[o].x-n.bInfo.minimum.x*D)*w),k=Math.floor((n.facetPositions[o].y-n.bInfo.minimum.y*D)*F),U=Math.floor((n.facetPositions[o].z-n.bInfo.minimum.z*D)*B),V=Math.floor((t[g]-n.bInfo.minimum.x*D)*w),j=Math.floor((t[m]-n.bInfo.minimum.y*D)*F),z=Math.floor((t[y]-n.bInfo.minimum.z*D)*B),K=Math.floor((t[b]-n.bInfo.minimum.x*D)*w),W=Math.floor((t[v]-n.bInfo.minimum.y*D)*F),G=Math.floor((t[M]-n.bInfo.minimum.z*D)*B),Y=Math.floor((t[O]-n.bInfo.minimum.x*D)*w),H=Math.floor((t[A]-n.bInfo.minimum.y*D)*F),q=Math.floor((t[P]-n.bInfo.minimum.z*D)*B),X=V+n.subDiv.max*j+N*z,Z=K+n.subDiv.max*W+N*G,J=Y+n.subDiv.max*H+N*q,Q=L+n.subDiv.max*k+N*U,n.facetPartitioning[Q]=n.facetPartitioning[Q]?n.facetPartitioning[Q]:new Array,n.facetPartitioning[X]=n.facetPartitioning[X]?n.facetPartitioning[X]:new Array,n.facetPartitioning[Z]=n.facetPartitioning[Z]?n.facetPartitioning[Z]:new Array,n.facetPartitioning[J]=n.facetPartitioning[J]?n.facetPartitioning[J]:new Array,n.facetPartitioning[X].push(o),Z!=X&&n.facetPartitioning[Z].push(o),J!=Z&&J!=X&&n.facetPartitioning[J].push(o),Q!=X&&Q!=Z&&Q!=J&&n.facetPartitioning[Q].push(o)),R&&n&&n.facetPositions){var et=E[o];et.ind=3*o,et.sqDistance=r.e.DistanceSquared(n.facetPositions[o],S)}i[g]+=f,i[m]+=d,i[y]+=p,i[b]+=f,i[v]+=d,i[M]+=p,i[O]+=f,i[A]+=d,i[P]+=p}for(o=0;o<i.length/3;o++)f=i[3*o],d=i[3*o+1],p=i[3*o+2],f/=_=0===(_=Math.sqrt(f*f+d*d+p*p))?1:_,d/=_,p/=_,i[3*o]=f,i[3*o+1]=d,i[3*o+2]=p},t._ComputeSides=function(e,i,n,o,s,a,h){var c,u,l=n.length,f=o.length;switch(e=e||t.DEFAULTSIDE){case t.FRONTSIDE:break;case t.BACKSIDE:var d;for(c=0;c<l;c+=3)d=n[c],n[c]=n[c+2],n[c+2]=d;for(u=0;u<f;u++)o[u]=-o[u];break;case t.DOUBLESIDE:for(var p=i.length,_=p/3,g=0;g<p;g++)i[p+g]=i[g];for(c=0;c<l;c+=3)n[c+l]=n[c+2]+_,n[c+1+l]=n[c+1]+_,n[c+2+l]=n[c]+_;for(u=0;u<f;u++)o[f+u]=-o[u];var m=s.length,y=0;for(y=0;y<m;y++)s[y+m]=s[y];for(a=a||new r.f(0,0,1,1),h=h||new r.f(0,0,1,1),y=0,c=0;c<m/2;c++)s[y]=a.x+(a.z-a.x)*s[y],s[y+1]=a.y+(a.w-a.y)*s[y+1],s[y+m]=h.x+(h.z-h.x)*s[y+m],s[y+m+1]=h.y+(h.w-h.y)*s[y+m+1],y+=2}},t.ImportVertexData=function(e,i){var r=new t,o=e.positions;o&&r.set(o,n.b.PositionKind);var a=e.normals;a&&r.set(a,n.b.NormalKind);var h=e.tangents;h&&r.set(h,n.b.TangentKind);var c=e.uvs;c&&r.set(c,n.b.UVKind);var u=e.uv2s;u&&r.set(u,n.b.UV2Kind);var l=e.uv3s;l&&r.set(l,n.b.UV3Kind);var f=e.uv4s;f&&r.set(f,n.b.UV4Kind);var d=e.uv5s;d&&r.set(d,n.b.UV5Kind);var p=e.uv6s;p&&r.set(p,n.b.UV6Kind);var _=e.colors;_&&r.set(s.b.CheckColors4(_,o.length/3),n.b.ColorKind);var g=e.matricesIndices;g&&r.set(g,n.b.MatricesIndicesKind);var m=e.matricesWeights;m&&r.set(m,n.b.MatricesWeightsKind);var y=e.indices;y&&(r.indices=y),i.setAllVerticesData(r,e.updatable)},t.FRONTSIDE=0,t.BACKSIDE=1,t.DOUBLESIDE=2,t.DEFAULTSIDE=0,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return L}));var r=i(3),n=i(41),o=i(8),s=i(0),a=i(68),h=i(165),c=i(105),u=i(34),l=i(69),f=i(50),d=i(45),p=i(64),_=i(79),g=i(122),m=i(70),y=i(97),b=i(137),v=i(141),M=i(142),O=i(48),A=i(2),P=i(1),x=i(6),T=i(5),I=i(58),R=i(162),C=i(107),D=function(){function t(){this._singleClick=!1,this._doubleClick=!1,this._hasSwiped=!1,this._ignore=!1}return Object.defineProperty(t.prototype,"singleClick",{get:function(){return this._singleClick},set:function(t){this._singleClick=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doubleClick",{get:function(){return this._doubleClick},set:function(t){this._doubleClick=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSwiped",{get:function(){return this._hasSwiped},set:function(t){this._hasSwiped=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ignore",{get:function(){return this._ignore},set:function(t){this._ignore=t},enumerable:!1,configurable:!0}),t}(),S=function(){function t(t){this._alreadyAttached=!1,this._wheelEventName="",this._meshPickProceed=!1,this._currentPickResult=null,this._previousPickResult=null,this._totalPointersPressed=0,this._doubleClickOccured=!1,this._pointerX=0,this._pointerY=0,this._startingPointerPosition=new u.d(0,0),this._previousStartingPointerPosition=new u.d(0,0),this._startingPointerTime=0,this._previousStartingPointerTime=0,this._pointerCaptures={},this._meshUnderPointerId=[],this._scene=t}return Object.defineProperty(t.prototype,"meshUnderPointer",{get:function(){return this._pointerOverMesh},enumerable:!1,configurable:!0}),t.prototype.getMeshUnderPointerByPointerId=function(t){return this._meshUnderPointerId[t]},Object.defineProperty(t.prototype,"unTranslatedPointer",{get:function(){return new u.d(this._unTranslatedPointerX,this._unTranslatedPointerY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointerX",{get:function(){return this._pointerX},set:function(t){this._pointerX=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointerY",{get:function(){return this._pointerY},set:function(t){this._pointerY=t},enumerable:!1,configurable:!0}),t.prototype._updatePointerPosition=function(t){var e=this._scene.getEngine().getInputElementClientRect();e&&(this._pointerX=t.clientX-e.left,this._pointerY=t.clientY-e.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)},t.prototype._processPointerMove=function(t,e){var i=this._scene,r=i.getEngine(),n=r.getInputElement();if(n){n.tabIndex=r.canvasTabIndex,i.doNotHandleCursors||(n.style.cursor=i.defaultCursor);var o=!!(t&&t.hit&&t.pickedMesh);o?(i.setPointerOverMesh(t.pickedMesh,e.pointerId),this._pointerOverMesh&&this._pointerOverMesh.actionManager&&this._pointerOverMesh.actionManager.hasPointerTriggers&&(i.doNotHandleCursors||(this._pointerOverMesh.actionManager.hoverCursor?n.style.cursor=this._pointerOverMesh.actionManager.hoverCursor:n.style.cursor=i.hoverCursor))):i.setPointerOverMesh(null,e.pointerId);for(var s=0,a=i._pointerMoveStage;s<a.length;s++){t=a[s].action(this._unTranslatedPointerX,this._unTranslatedPointerY,t,o,n)}if(t){var h=e.type===this._wheelEventName?I.a.POINTERWHEEL:I.a.POINTERMOVE;if(i.onPointerMove&&i.onPointerMove(e,t,h),i.onPointerObservable.hasObservers()){var c=new I.b(h,e,t);this._setRayOnPointerInfo(c),i.onPointerObservable.notifyObservers(c,h)}}}},t.prototype._setRayOnPointerInfo=function(t){var e=this._scene;t.pickInfo&&!t.pickInfo._pickingUnavailable&&(t.pickInfo.ray||(t.pickInfo.ray=e.createPickingRay(t.event.offsetX,t.event.offsetY,u.a.Identity(),e.activeCamera)))},t.prototype._checkPrePointerObservable=function(t,e,i){var r=this._scene,n=new I.c(i,e,this._unTranslatedPointerX,this._unTranslatedPointerY);return t&&(n.ray=t.ray),r.onPrePointerObservable.notifyObservers(n,i),!!n.skipOnPointerObservable},t.prototype.simulatePointerMove=function(t,e){var i=new PointerEvent("pointermove",e);this._checkPrePointerObservable(t,i,I.a.POINTERMOVE)||this._processPointerMove(t,i)},t.prototype.simulatePointerDown=function(t,e){var i=new PointerEvent("pointerdown",e);this._checkPrePointerObservable(t,i,I.a.POINTERDOWN)||this._processPointerDown(t,i)},t.prototype._processPointerDown=function(e,i){var r=this,n=this._scene;if(e&&e.hit&&e.pickedMesh){this._pickedDownMesh=e.pickedMesh;var o=e.pickedMesh._getActionManagerForTrigger();if(o){if(o.hasPickTriggers)switch(o.processTrigger(5,b.a.CreateNew(e.pickedMesh,i)),i.button){case 0:o.processTrigger(2,b.a.CreateNew(e.pickedMesh,i));break;case 1:o.processTrigger(4,b.a.CreateNew(e.pickedMesh,i));break;case 2:o.processTrigger(3,b.a.CreateNew(e.pickedMesh,i))}o.hasSpecificTrigger(8)&&window.setTimeout((function(){var e=n.pick(r._unTranslatedPointerX,r._unTranslatedPointerY,(function(t){return t.isPickable&&t.isVisible&&t.isReady()&&t.actionManager&&t.actionManager.hasSpecificTrigger(8)&&t==r._pickedDownMesh}),!1,n.cameraToUseForPointers);e&&e.hit&&e.pickedMesh&&o&&0!==r._totalPointersPressed&&Date.now()-r._startingPointerTime>t.LongPressDelay&&!r._isPointerSwiping()&&(r._startingPointerTime=0,o.processTrigger(8,b.a.CreateNew(e.pickedMesh,i)))}),t.LongPressDelay)}}else for(var s=0,a=n._pointerDownStage;s<a.length;s++){e=a[s].action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,i)}if(e){var h=I.a.POINTERDOWN;if(n.onPointerDown&&n.onPointerDown(i,e,h),n.onPointerObservable.hasObservers()){var c=new I.b(h,i,e);this._setRayOnPointerInfo(c),n.onPointerObservable.notifyObservers(c,h)}}},t.prototype._isPointerSwiping=function(){return Math.abs(this._startingPointerPosition.x-this._pointerX)>t.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>t.DragMovementThreshold},t.prototype.simulatePointerUp=function(t,e,i){var r=new PointerEvent("pointerup",e),n=new D;i?n.doubleClick=!0:n.singleClick=!0,this._checkPrePointerObservable(t,r,I.a.POINTERUP)||this._processPointerUp(t,r,n)},t.prototype._processPointerUp=function(t,e,i){var r=this._scene;if(t&&t&&t.pickedMesh){if(this._pickedUpMesh=t.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(r.onPointerPick&&r.onPointerPick(e,t),i.singleClick&&!i.ignore&&r.onPointerObservable.hasObservers())){var n=I.a.POINTERPICK,o=new I.b(n,e,t);this._setRayOnPointerInfo(o),r.onPointerObservable.notifyObservers(o,n)}var s=t.pickedMesh._getActionManagerForTrigger();if(s&&!i.ignore){s.processTrigger(7,b.a.CreateNew(t.pickedMesh,e)),!i.hasSwiped&&i.singleClick&&s.processTrigger(1,b.a.CreateNew(t.pickedMesh,e));var a=t.pickedMesh._getActionManagerForTrigger(6);i.doubleClick&&a&&a.processTrigger(6,b.a.CreateNew(t.pickedMesh,e))}}else if(!i.ignore)for(var h=0,c=r._pointerUpStage;h<c.length;h++){t=c[h].action(this._unTranslatedPointerX,this._unTranslatedPointerY,t,e)}if(this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh){var u=this._pickedDownMesh._getActionManagerForTrigger(16);u&&u.processTrigger(16,b.a.CreateNew(this._pickedDownMesh,e))}var l=0;if(r.onPointerObservable.hasObservers()){if(!i.ignore&&!i.hasSwiped&&(i.singleClick&&r.onPointerObservable.hasSpecificMask(I.a.POINTERTAP)?l=I.a.POINTERTAP:i.doubleClick&&r.onPointerObservable.hasSpecificMask(I.a.POINTERDOUBLETAP)&&(l=I.a.POINTERDOUBLETAP),l)){o=new I.b(l,e,t);this._setRayOnPointerInfo(o),r.onPointerObservable.notifyObservers(o,l)}if(!i.ignore){l=I.a.POINTERUP;o=new I.b(l,e,t);this._setRayOnPointerInfo(o),r.onPointerObservable.notifyObservers(o,l)}}r.onPointerUp&&!i.ignore&&r.onPointerUp(e,t,l)},t.prototype.isPointerCaptured=function(t){return void 0===t&&(t=0),this._pointerCaptures[t]},t.prototype.attachControl=function(e,i,r,o){var s=this;void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===o&&(o=null);var a=this._scene;if(o||(o=a.getEngine().getInputElement()),o){this._alreadyAttached&&this.detachControl();var h,c=a.getEngine();this._initActionManager=function(t,e){if(!s._meshPickProceed){var i=a.pick(s._unTranslatedPointerX,s._unTranslatedPointerY,a.pointerDownPredicate,!1,a.cameraToUseForPointers);s._currentPickResult=i,i&&(t=i.hit&&i.pickedMesh?i.pickedMesh._getActionManagerForTrigger():null),s._meshPickProceed=!0}return t},this._delayedSimpleClick=function(e,i,r){(Date.now()-s._previousStartingPointerTime>t.DoubleClickDelay&&!s._doubleClickOccured||e!==s._previousButtonPressed)&&(s._doubleClickOccured=!1,i.singleClick=!0,i.ignore=!1,r(i,s._currentPickResult))},this._initClickEvent=function(e,i,r,n){var o=new D;s._currentPickResult=null;var a=null,h=e.hasSpecificMask(I.a.POINTERPICK)||i.hasSpecificMask(I.a.POINTERPICK)||e.hasSpecificMask(I.a.POINTERTAP)||i.hasSpecificMask(I.a.POINTERTAP)||e.hasSpecificMask(I.a.POINTERDOUBLETAP)||i.hasSpecificMask(I.a.POINTERDOUBLETAP);!h&&R.a&&(a=s._initActionManager(a,o))&&(h=a.hasPickTriggers);var c=!1;if(h){var u=r.button;if(o.hasSwiped=s._isPointerSwiping(),!o.hasSwiped){var l=!t.ExclusiveDoubleClickMode;l||(l=!e.hasSpecificMask(I.a.POINTERDOUBLETAP)&&!i.hasSpecificMask(I.a.POINTERDOUBLETAP))&&!R.a.HasSpecificTrigger(6)&&(a=s._initActionManager(a,o))&&(l=!a.hasSpecificTrigger(6)),l?(Date.now()-s._previousStartingPointerTime>t.DoubleClickDelay||u!==s._previousButtonPressed)&&(o.singleClick=!0,n(o,s._currentPickResult),c=!0):(s._previousDelayedSimpleClickTimeout=s._delayedSimpleClickTimeout,s._delayedSimpleClickTimeout=window.setTimeout(s._delayedSimpleClick.bind(s,u,o,n),t.DoubleClickDelay));var f=e.hasSpecificMask(I.a.POINTERDOUBLETAP)||i.hasSpecificMask(I.a.POINTERDOUBLETAP);!f&&R.a.HasSpecificTrigger(6)&&(a=s._initActionManager(a,o))&&(f=a.hasSpecificTrigger(6)),f&&(u===s._previousButtonPressed&&Date.now()-s._previousStartingPointerTime<t.DoubleClickDelay&&!s._doubleClickOccured?(o.hasSwiped||s._isPointerSwiping()?(s._doubleClickOccured=!1,s._previousStartingPointerTime=s._startingPointerTime,s._previousStartingPointerPosition.x=s._startingPointerPosition.x,s._previousStartingPointerPosition.y=s._startingPointerPosition.y,s._previousButtonPressed=u,t.ExclusiveDoubleClickMode?(s._previousDelayedSimpleClickTimeout&&clearTimeout(s._previousDelayedSimpleClickTimeout),s._previousDelayedSimpleClickTimeout=s._delayedSimpleClickTimeout,n(o,s._previousPickResult)):n(o,s._currentPickResult)):(s._previousStartingPointerTime=0,s._doubleClickOccured=!0,o.doubleClick=!0,o.ignore=!1,t.ExclusiveDoubleClickMode&&s._previousDelayedSimpleClickTimeout&&clearTimeout(s._previousDelayedSimpleClickTimeout),s._previousDelayedSimpleClickTimeout=s._delayedSimpleClickTimeout,n(o,s._currentPickResult)),c=!0):(s._doubleClickOccured=!1,s._previousStartingPointerTime=s._startingPointerTime,s._previousStartingPointerPosition.x=s._startingPointerPosition.x,s._previousStartingPointerPosition.y=s._startingPointerPosition.y,s._previousButtonPressed=u))}}c||n(o,s._currentPickResult)},this._onPointerMove=function(t){if(void 0===t.pointerId&&(t.pointerId=0),s._updatePointerPosition(t),!s._checkPrePointerObservable(null,t,t.type===s._wheelEventName?I.a.POINTERWHEEL:I.a.POINTERMOVE)&&(a.cameraToUseForPointers||a.activeCamera)){a.pointerMovePredicate||(a.pointerMovePredicate=function(t){return t.isPickable&&t.isVisible&&t.isReady()&&t.isEnabled()&&(t.enablePointerMoveEvents||a.constantlyUpdateMeshUnderPointer||null!=t._getActionManagerForTrigger())&&(!a.cameraToUseForPointers||0!=(a.cameraToUseForPointers.layerMask&t.layerMask))});var e=a.pick(s._unTranslatedPointerX,s._unTranslatedPointerY,a.pointerMovePredicate,!1,a.cameraToUseForPointers);s._processPointerMove(e,t)}},this._onPointerDown=function(t){if(s._totalPointersPressed++,s._pickedDownMesh=null,s._meshPickProceed=!1,void 0===t.pointerId&&(t.pointerId=0),s._updatePointerPosition(t),a.preventDefaultOnPointerDown&&o&&(t.preventDefault(),o.focus()),s._startingPointerPosition.x=s._pointerX,s._startingPointerPosition.y=s._pointerY,s._startingPointerTime=Date.now(),!s._checkPrePointerObservable(null,t,I.a.POINTERDOWN)&&(a.cameraToUseForPointers||a.activeCamera)){s._pointerCaptures[t.pointerId]=!0,a.pointerDownPredicate||(a.pointerDownPredicate=function(t){return t.isPickable&&t.isVisible&&t.isReady()&&t.isEnabled()&&(!a.cameraToUseForPointers||0!=(a.cameraToUseForPointers.layerMask&t.layerMask))}),s._pickedDownMesh=null;var e=a.pick(s._unTranslatedPointerX,s._unTranslatedPointerY,a.pointerDownPredicate,!1,a.cameraToUseForPointers);s._processPointerDown(e,t)}},this._onPointerUp=function(t){0!==s._totalPointersPressed&&(s._totalPointersPressed--,s._pickedUpMesh=null,s._meshPickProceed=!1,void 0===t.pointerId&&(t.pointerId=0),s._updatePointerPosition(t),a.preventDefaultOnPointerUp&&o&&(t.preventDefault(),o.focus()),s._initClickEvent(a.onPrePointerObservable,a.onPointerObservable,t,(function(e,i){if(a.onPrePointerObservable.hasObservers()&&!e.ignore){if(!e.hasSwiped){if(e.singleClick&&a.onPrePointerObservable.hasSpecificMask(I.a.POINTERTAP)&&s._checkPrePointerObservable(null,t,I.a.POINTERTAP))return;if(e.doubleClick&&a.onPrePointerObservable.hasSpecificMask(I.a.POINTERDOUBLETAP)&&s._checkPrePointerObservable(null,t,I.a.POINTERDOUBLETAP))return}if(s._checkPrePointerObservable(null,t,I.a.POINTERUP))return}s._pointerCaptures[t.pointerId]&&(s._pointerCaptures[t.pointerId]=!1,(a.cameraToUseForPointers||a.activeCamera)&&(a.pointerUpPredicate||(a.pointerUpPredicate=function(t){return t.isPickable&&t.isVisible&&t.isReady()&&t.isEnabled()&&(!a.cameraToUseForPointers||0!=(a.cameraToUseForPointers.layerMask&t.layerMask))}),!s._meshPickProceed&&(R.a&&R.a.HasTriggers||a.onPointerObservable.hasObservers())&&s._initActionManager(null,e),i||(i=s._currentPickResult),s._processPointerUp(i,t,e),s._previousPickResult=s._currentPickResult))})))},this._onKeyDown=function(t){var e=C.a.KEYDOWN;if(a.onPreKeyboardObservable.hasObservers()){var i=new C.c(e,t);if(a.onPreKeyboardObservable.notifyObservers(i,e),i.skipOnPointerObservable)return}if(a.onKeyboardObservable.hasObservers()){i=new C.b(e,t);a.onKeyboardObservable.notifyObservers(i,e)}a.actionManager&&a.actionManager.processTrigger(14,b.a.CreateNewFromScene(a,t))},this._onKeyUp=function(t){var e=C.a.KEYUP;if(a.onPreKeyboardObservable.hasObservers()){var i=new C.c(e,t);if(a.onPreKeyboardObservable.notifyObservers(i,e),i.skipOnPointerObservable)return}if(a.onKeyboardObservable.hasObservers()){i=new C.b(e,t);a.onKeyboardObservable.notifyObservers(i,e)}a.actionManager&&a.actionManager.processTrigger(15,b.a.CreateNewFromScene(a,t))},this._onCanvasFocusObserver=c.onCanvasFocusObservable.add((h=function(){o&&(o.addEventListener("keydown",s._onKeyDown,!1),o.addEventListener("keyup",s._onKeyUp,!1))},document.activeElement===o&&h(),h)),this._onCanvasBlurObserver=c.onCanvasBlurObservable.add((function(){o&&(o.removeEventListener("keydown",s._onKeyDown),o.removeEventListener("keyup",s._onKeyUp))}));var u=n.b.GetPointerPrefix(c);if(r&&(o.addEventListener(u+"move",this._onPointerMove,!1),this._wheelEventName="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",o.addEventListener(this._wheelEventName,this._onPointerMove,!1)),i&&o.addEventListener(u+"down",this._onPointerDown,!1),e){var l=a.getEngine().getHostWindow();l&&l.addEventListener(u+"up",this._onPointerUp,!1)}this._alreadyAttached=!0}},t.prototype.detachControl=function(){var t=this._scene.getEngine().getInputElement(),e=this._scene.getEngine(),i=n.b.GetPointerPrefix(e);t&&this._alreadyAttached&&(t.removeEventListener(i+"move",this._onPointerMove),t.removeEventListener(this._wheelEventName,this._onPointerMove),t.removeEventListener(i+"down",this._onPointerDown),window.removeEventListener(i+"up",this._onPointerUp),this._onCanvasBlurObserver&&e.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onCanvasFocusObserver&&e.onCanvasFocusObservable.remove(this._onCanvasFocusObserver),t.removeEventListener("keydown",this._onKeyDown),t.removeEventListener("keyup",this._onKeyUp),this._scene.doNotHandleCursors||(t.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1)},t.prototype.setPointerOverMesh=function(t,e){if(void 0===e&&(e=0),e<0&&(e=0),this._meshUnderPointerId[e]!==t){var i,r=this._meshUnderPointerId[e];r&&(i=r._getActionManagerForTrigger(10))&&i.processTrigger(10,b.a.CreateNew(r,void 0,{pointerId:e})),this._meshUnderPointerId[e]=t,this._pointerOverMesh=t,(r=this._meshUnderPointerId[e])&&(i=r._getActionManagerForTrigger(9))&&i.processTrigger(9,b.a.CreateNew(r,void 0,{pointerId:e}))}},t.prototype.getPointerOverMesh=function(){return this._pointerOverMesh},t.DragMovementThreshold=10,t.LongPressDelay=500,t.DoubleClickDelay=300,t.ExclusiveDoubleClickMode=!1,t}(),E=i(15),w=i(36),F=i(140),B=i(230),N=i(120),L=function(t){function e(i,n){var o=t.call(this)||this;o._inputManager=new S(o),o.cameraToUseForPointers=null,o._isScene=!0,o._blockEntityCollection=!1,o.autoClear=!0,o.autoClearDepthAndStencil=!0,o.clearColor=new w.b(.2,.2,.3,1),o.ambientColor=new w.a(0,0,0),o._environmentIntensity=1,o._forceWireframe=!1,o._skipFrustumClipping=!1,o._forcePointsCloud=!1,o.animationsEnabled=!0,o._animationPropertiesOverride=null,o.useConstantAnimationDeltaTime=!1,o.constantlyUpdateMeshUnderPointer=!1,o.hoverCursor="pointer",o.defaultCursor="",o.doNotHandleCursors=!1,o.preventDefaultOnPointerDown=!0,o.preventDefaultOnPointerUp=!0,o.metadata=null,o.reservedDataStore=null,o.disableOfflineSupportExceptionRules=new Array,o.onDisposeObservable=new s.a,o._onDisposeObserver=null,o.onBeforeRenderObservable=new s.a,o._onBeforeRenderObserver=null,o.onAfterRenderObservable=new s.a,o.onAfterRenderCameraObservable=new s.a,o._onAfterRenderObserver=null,o.onBeforeAnimationsObservable=new s.a,o.onAfterAnimationsObservable=new s.a,o.onBeforeDrawPhaseObservable=new s.a,o.onAfterDrawPhaseObservable=new s.a,o.onReadyObservable=new s.a,o.onBeforeCameraRenderObservable=new s.a,o._onBeforeCameraRenderObserver=null,o.onAfterCameraRenderObservable=new s.a,o._onAfterCameraRenderObserver=null,o.onBeforeActiveMeshesEvaluationObservable=new s.a,o.onAfterActiveMeshesEvaluationObservable=new s.a,o.onBeforeParticlesRenderingObservable=new s.a,o.onAfterParticlesRenderingObservable=new s.a,o.onDataLoadedObservable=new s.a,o.onNewCameraAddedObservable=new s.a,o.onCameraRemovedObservable=new s.a,o.onNewLightAddedObservable=new s.a,o.onLightRemovedObservable=new s.a,o.onNewGeometryAddedObservable=new s.a,o.onGeometryRemovedObservable=new s.a,o.onNewTransformNodeAddedObservable=new s.a,o.onTransformNodeRemovedObservable=new s.a,o.onNewMeshAddedObservable=new s.a,o.onMeshRemovedObservable=new s.a,o.onNewSkeletonAddedObservable=new s.a,o.onSkeletonRemovedObservable=new s.a,o.onNewMaterialAddedObservable=new s.a,o.onMaterialRemovedObservable=new s.a,o.onNewTextureAddedObservable=new s.a,o.onTextureRemovedObservable=new s.a,o.onBeforeRenderTargetsRenderObservable=new s.a,o.onAfterRenderTargetsRenderObservable=new s.a,o.onBeforeStepObservable=new s.a,o.onAfterStepObservable=new s.a,o.onActiveCameraChanged=new s.a,o.onBeforeRenderingGroupObservable=new s.a,o.onAfterRenderingGroupObservable=new s.a,o.onMeshImportedObservable=new s.a,o.onAnimationFileImportedObservable=new s.a,o._registeredForLateAnimationBindings=new a.b(256),o.onPrePointerObservable=new s.a,o.onPointerObservable=new s.a,o.onPreKeyboardObservable=new s.a,o.onKeyboardObservable=new s.a,o._useRightHandedSystem=!1,o._timeAccumulator=0,o._currentStepId=0,o._currentInternalStep=0,o._fogEnabled=!0,o._fogMode=e.FOGMODE_NONE,o.fogColor=new w.a(.2,.2,.3),o.fogDensity=.1,o.fogStart=0,o.fogEnd=1e3,o.prePass=!1,o._shadowsEnabled=!0,o._lightsEnabled=!0,o.activeCameras=new Array,o._texturesEnabled=!0,o.physicsEnabled=!0,o.particlesEnabled=!0,o.spritesEnabled=!0,o._skeletonsEnabled=!0,o.lensFlaresEnabled=!0,o.collisionsEnabled=!0,o.gravity=new u.e(0,-9.807,0),o.postProcessesEnabled=!0,o.renderTargetsEnabled=!0,o.dumpNextRenderTargets=!1,o.customRenderTargets=new Array,o.importedMeshesFiles=new Array,o.probesEnabled=!0,o._meshesForIntersections=new a.b(256),o.proceduralTexturesEnabled=!0,o._totalVertices=new E.a,o._activeIndices=new E.a,o._activeParticles=new E.a,o._activeBones=new E.a,o._animationTime=0,o.animationTimeScale=1,o._renderId=0,o._frameId=0,o._executeWhenReadyTimeoutId=-1,o._intermediateRendering=!1,o._viewUpdateFlag=-1,o._projectionUpdateFlag=-1,o._toBeDisposed=new Array(256),o._activeRequests=new Array,o._pendingData=new Array,o._isDisposed=!1,o.dispatchAllSubMeshesOfActiveMeshes=!1,o._activeMeshes=new a.a(256),o._processedMaterials=new a.a(256),o._renderTargets=new a.b(256),o._activeParticleSystems=new a.a(256),o._activeSkeletons=new a.b(32),o._softwareSkinnedMeshes=new a.b(32),o._activeAnimatables=new Array,o._transformMatrix=u.a.Zero(),o.requireLightSorting=!1,o._components=[],o._serializableComponents=[],o._transientComponents=[],o._beforeCameraUpdateStage=O.b.Create(),o._beforeClearStage=O.b.Create(),o._gatherRenderTargetsStage=O.b.Create(),o._gatherActiveCameraRenderTargetsStage=O.b.Create(),o._isReadyForMeshStage=O.b.Create(),o._beforeEvaluateActiveMeshStage=O.b.Create(),o._evaluateSubMeshStage=O.b.Create(),o._activeMeshStage=O.b.Create(),o._cameraDrawRenderTargetStage=O.b.Create(),o._beforeCameraDrawStage=O.b.Create(),o._beforeRenderTargetDrawStage=O.b.Create(),o._beforeRenderingGroupDrawStage=O.b.Create(),o._beforeRenderingMeshStage=O.b.Create(),o._afterRenderingMeshStage=O.b.Create(),o._afterRenderingGroupDrawStage=O.b.Create(),o._afterCameraDrawStage=O.b.Create(),o._afterRenderTargetDrawStage=O.b.Create(),o._afterRenderStage=O.b.Create(),o._pointerMoveStage=O.b.Create(),o._pointerDownStage=O.b.Create(),o._pointerUpStage=O.b.Create(),o.geometriesByUniqueId=null,o._defaultMeshCandidates={data:[],length:0},o._defaultSubMeshCandidates={data:[],length:0},o._preventFreeActiveMeshesAndRenderingGroups=!1,o._activeMeshesFrozen=!1,o._skipEvaluateActiveMeshesCompletely=!1,o._allowPostProcessClearColor=!0,o.getDeterministicFrameTime=function(){return o._engine.getTimeStep()},o._blockMaterialDirtyMechanism=!1;var h=Object(r.a)({useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1},n);return o._engine=i||x.a.LastCreatedEngine,h.virtual||(x.a._LastCreatedScene=o,o._engine.scenes.push(o)),o._uid=null,o._renderingManager=new M.a(o),v.a&&(o.postProcessManager=new v.a(o)),A.a.IsWindowObjectExist()&&o.attachControl(),o._createUbo(),_.a&&(o._imageProcessingConfiguration=new _.a),o.setDefaultCandidateProviders(),h.useGeometryUniqueIdsMap&&(o.geometriesByUniqueId={}),o.useMaterialMeshMap=h.useMaterialMeshMap,o.useClonedMeshMap=h.useClonedMeshMap,n&&n.virtual||o._engine.onNewSceneAddedObservable.notifyObservers(o),o}return Object(r.d)(e,t),e.DefaultMaterialFactory=function(t){throw T.a.WarnImport("StandardMaterial")},e.CollisionCoordinatorFactory=function(){throw T.a.WarnImport("DefaultCollisionCoordinator")},Object.defineProperty(e.prototype,"environmentTexture",{get:function(){return this._environmentTexture},set:function(t){this._environmentTexture!==t&&(this._environmentTexture=t,this.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"environmentIntensity",{get:function(){return this._environmentIntensity},set:function(t){this._environmentIntensity!==t&&(this._environmentIntensity=t,this.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"imageProcessingConfiguration",{get:function(){return this._imageProcessingConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forceWireframe",{get:function(){return this._forceWireframe},set:function(t){this._forceWireframe!==t&&(this._forceWireframe=t,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skipFrustumClipping",{get:function(){return this._skipFrustumClipping},set:function(t){this._skipFrustumClipping!==t&&(this._skipFrustumClipping=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forcePointsCloud",{get:function(){return this._forcePointsCloud},set:function(t){this._forcePointsCloud!==t&&(this._forcePointsCloud=t,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animationPropertiesOverride",{get:function(){return this._animationPropertiesOverride},set:function(t){this._animationPropertiesOverride=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"beforeRender",{set:function(t){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),t&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"afterRender",{set:function(t){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),t&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"beforeCameraRender",{set:function(t){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"afterCameraRender",{set:function(t){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unTranslatedPointer",{get:function(){return this._inputManager.unTranslatedPointer},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DragMovementThreshold",{get:function(){return S.DragMovementThreshold},set:function(t){S.DragMovementThreshold=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LongPressDelay",{get:function(){return S.LongPressDelay},set:function(t){S.LongPressDelay=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DoubleClickDelay",{get:function(){return S.DoubleClickDelay},set:function(t){S.DoubleClickDelay=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExclusiveDoubleClickMode",{get:function(){return S.ExclusiveDoubleClickMode},set:function(t){S.ExclusiveDoubleClickMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useRightHandedSystem",{get:function(){return this._useRightHandedSystem},set:function(t){this._useRightHandedSystem!==t&&(this._useRightHandedSystem=t,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),e.prototype.setStepId=function(t){this._currentStepId=t},e.prototype.getStepId=function(){return this._currentStepId},e.prototype.getInternalStep=function(){return this._currentInternalStep},Object.defineProperty(e.prototype,"fogEnabled",{get:function(){return this._fogEnabled},set:function(t){this._fogEnabled!==t&&(this._fogEnabled=t,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fogMode",{get:function(){return this._fogMode},set:function(t){this._fogMode!==t&&(this._fogMode=t,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowsEnabled",{get:function(){return this._shadowsEnabled},set:function(t){this._shadowsEnabled!==t&&(this._shadowsEnabled=t,this.markAllMaterialsAsDirty(2))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightsEnabled",{get:function(){return this._lightsEnabled},set:function(t){this._lightsEnabled!==t&&(this._lightsEnabled=t,this.markAllMaterialsAsDirty(2))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeCamera",{get:function(){return this._activeCamera},set:function(t){t!==this._activeCamera&&(this._activeCamera=t,this.onActiveCameraChanged.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultMaterial",{get:function(){return this._defaultMaterial||(this._defaultMaterial=e.DefaultMaterialFactory(this)),this._defaultMaterial},set:function(t){this._defaultMaterial=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texturesEnabled",{get:function(){return this._texturesEnabled},set:function(t){this._texturesEnabled!==t&&(this._texturesEnabled=t,this.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skeletonsEnabled",{get:function(){return this._skeletonsEnabled},set:function(t){this._skeletonsEnabled!==t&&(this._skeletonsEnabled=t,this.markAllMaterialsAsDirty(8))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionCoordinator",{get:function(){return this._collisionCoordinator||(this._collisionCoordinator=e.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frustumPlanes",{get:function(){return this._frustumPlanes},enumerable:!1,configurable:!0}),e.prototype._registerTransientComponents=function(){if(this._transientComponents.length>0){for(var t=0,e=this._transientComponents;t<e.length;t++){e[t].register()}this._transientComponents=[]}},e.prototype._addComponent=function(t){this._components.push(t),this._transientComponents.push(t);var e=t;e.addFromContainer&&e.serialize&&this._serializableComponents.push(e)},e.prototype._getComponent=function(t){for(var e=0,i=this._components;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},e.prototype.getClassName=function(){return"Scene"},e.prototype._getDefaultMeshCandidates=function(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates},e.prototype._getDefaultSubMeshCandidates=function(t){return this._defaultSubMeshCandidates.data=t.subMeshes,this._defaultSubMeshCandidates.length=t.subMeshes.length,this._defaultSubMeshCandidates},e.prototype.setDefaultCandidateProviders=function(){this.getActiveMeshCandidates=this._getDefaultMeshCandidates.bind(this),this.getActiveSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getIntersectingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getCollidingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this)},Object.defineProperty(e.prototype,"meshUnderPointer",{get:function(){return this._inputManager.meshUnderPointer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointerX",{get:function(){return this._inputManager.pointerX},set:function(t){this._inputManager.pointerX=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointerY",{get:function(){return this._inputManager.pointerY},set:function(t){this._inputManager.pointerY=t},enumerable:!1,configurable:!0}),e.prototype.getCachedMaterial=function(){return this._cachedMaterial},e.prototype.getCachedEffect=function(){return this._cachedEffect},e.prototype.getCachedVisibility=function(){return this._cachedVisibility},e.prototype.isCachedMaterialInvalid=function(t,e,i){return void 0===i&&(i=1),this._cachedEffect!==e||this._cachedMaterial!==t||this._cachedVisibility!==i},e.prototype.getEngine=function(){return this._engine},e.prototype.getTotalVertices=function(){return this._totalVertices.current},Object.defineProperty(e.prototype,"totalVerticesPerfCounter",{get:function(){return this._totalVertices},enumerable:!1,configurable:!0}),e.prototype.getActiveIndices=function(){return this._activeIndices.current},Object.defineProperty(e.prototype,"totalActiveIndicesPerfCounter",{get:function(){return this._activeIndices},enumerable:!1,configurable:!0}),e.prototype.getActiveParticles=function(){return this._activeParticles.current},Object.defineProperty(e.prototype,"activeParticlesPerfCounter",{get:function(){return this._activeParticles},enumerable:!1,configurable:!0}),e.prototype.getActiveBones=function(){return this._activeBones.current},Object.defineProperty(e.prototype,"activeBonesPerfCounter",{get:function(){return this._activeBones},enumerable:!1,configurable:!0}),e.prototype.getActiveMeshes=function(){return this._activeMeshes},e.prototype.getAnimationRatio=function(){return void 0!==this._animationRatio?this._animationRatio:1},e.prototype.getRenderId=function(){return this._renderId},e.prototype.getFrameId=function(){return this._frameId},e.prototype.incrementRenderId=function(){this._renderId++},e.prototype._createUbo=function(){this._sceneUbo=new g.a(this._engine,void 0,!0),this._sceneUbo.addUniform("viewProjection",16),this._sceneUbo.addUniform("view",16)},e.prototype.simulatePointerMove=function(t,e){return this._inputManager.simulatePointerMove(t,e),this},e.prototype.simulatePointerDown=function(t,e){return this._inputManager.simulatePointerDown(t,e),this},e.prototype.simulatePointerUp=function(t,e,i){return this._inputManager.simulatePointerUp(t,e,i),this},e.prototype.isPointerCaptured=function(t){return void 0===t&&(t=0),this._inputManager.isPointerCaptured(t)},e.prototype.attachControl=function(t,e,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this._inputManager.attachControl(t,e,i)},e.prototype.detachControl=function(){this._inputManager.detachControl()},e.prototype.isReady=function(){if(this._isDisposed)return!1;var t,e=this.getEngine();if(!e.areAllEffectsReady())return!1;if(this._pendingData.length>0)return!1;for(t=0;t<this.meshes.length;t++){var i=this.meshes[t];if(i.isEnabled()&&(i.subMeshes&&0!==i.subMeshes.length)){if(!i.isReady(!0))return!1;for(var r=i.hasThinInstances||"InstancedMesh"===i.getClassName()||"InstancedLinesMesh"===i.getClassName()||e.getCaps().instancedArrays&&i.instances.length>0,n=0,o=this._isReadyForMeshStage;n<o.length;n++){if(!o[n].action(i,r))return!1}}}for(t=0;t<this.geometries.length;t++){if(2===this.geometries[t].delayLoadState)return!1}if(this.activeCameras&&this.activeCameras.length>0)for(var s=0,a=this.activeCameras;s<a.length;s++){if(!a[s].isReady(!0))return!1}else if(this.activeCamera&&!this.activeCamera.isReady(!0))return!1;for(var h=0,c=this.particleSystems;h<c.length;h++){if(!c[h].isReady())return!1}return!0},e.prototype.resetCachedMaterial=function(){this._cachedMaterial=null,this._cachedEffect=null,this._cachedVisibility=null},e.prototype.registerBeforeRender=function(t){this.onBeforeRenderObservable.add(t)},e.prototype.unregisterBeforeRender=function(t){this.onBeforeRenderObservable.removeCallback(t)},e.prototype.registerAfterRender=function(t){this.onAfterRenderObservable.add(t)},e.prototype.unregisterAfterRender=function(t){this.onAfterRenderObservable.removeCallback(t)},e.prototype._executeOnceBeforeRender=function(t){var e=this,i=function(){t(),setTimeout((function(){e.unregisterBeforeRender(i)}))};this.registerBeforeRender(i)},e.prototype.executeOnceBeforeRender=function(t,e){var i=this;void 0!==e?setTimeout((function(){i._executeOnceBeforeRender(t)}),e):this._executeOnceBeforeRender(t)},e.prototype._addPendingData=function(t){this._pendingData.push(t)},e.prototype._removePendingData=function(t){var e=this.isLoading,i=this._pendingData.indexOf(t);-1!==i&&this._pendingData.splice(i,1),e&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)},e.prototype.getWaitingItemsCount=function(){return this._pendingData.length},Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._pendingData.length>0},enumerable:!1,configurable:!0}),e.prototype.executeWhenReady=function(t){var e=this;this.onReadyObservable.add(t),-1===this._executeWhenReadyTimeoutId&&(this._executeWhenReadyTimeoutId=setTimeout((function(){e._checkIsReady()}),150))},e.prototype.whenReadyAsync=function(){var t=this;return new Promise((function(e){t.executeWhenReady((function(){e()}))}))},e.prototype._checkIsReady=function(){var t=this;return this._registerTransientComponents(),this.isReady()?(this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=-1)):this._isDisposed?(this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=-1)):void(this._executeWhenReadyTimeoutId=setTimeout((function(){t._checkIsReady()}),150))},Object.defineProperty(e.prototype,"animatables",{get:function(){return this._activeAnimatables},enumerable:!1,configurable:!0}),e.prototype.resetLastAnimationTimeFrame=function(){this._animationTimeLast=o.a.Now},e.prototype.getViewMatrix=function(){return this._viewMatrix},e.prototype.getProjectionMatrix=function(){return this._projectionMatrix},e.prototype.getTransformMatrix=function(){return this._transformMatrix},e.prototype.setTransformMatrix=function(t,e,i,r){this._viewUpdateFlag===t.updateFlag&&this._projectionUpdateFlag===e.updateFlag||(this._viewUpdateFlag=t.updateFlag,this._projectionUpdateFlag=e.updateFlag,this._viewMatrix=t,this._projectionMatrix=e,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?F.a.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=F.a.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(i,r):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.update()))},e.prototype.getSceneUniformBuffer=function(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo},e.prototype.getUniqueId=function(){return B.a.UniqueId},e.prototype.addMesh=function(t,e){var i=this;void 0===e&&(e=!1),this._blockEntityCollection||(this.meshes.push(t),t._resyncLightSources(),t.parent||t._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(t),e&&t.getChildMeshes().forEach((function(t){i.addMesh(t)})))},e.prototype.removeMesh=function(t,e){var i=this;void 0===e&&(e=!1);var r=this.meshes.indexOf(t);return-1!==r&&(this.meshes[r]=this.meshes[this.meshes.length-1],this.meshes.pop(),t.parent||t._removeFromSceneRootNodes()),this.onMeshRemovedObservable.notifyObservers(t),e&&t.getChildMeshes().forEach((function(t){i.removeMesh(t)})),r},e.prototype.addTransformNode=function(t){this._blockEntityCollection||(t._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(t),t.parent||t._addToSceneRootNodes(),this.onNewTransformNodeAddedObservable.notifyObservers(t))},e.prototype.removeTransformNode=function(t){var e=t._indexInSceneTransformNodesArray;if(-1!==e){if(e!==this.transformNodes.length-1){var i=this.transformNodes[this.transformNodes.length-1];this.transformNodes[e]=i,i._indexInSceneTransformNodesArray=e}t._indexInSceneTransformNodesArray=-1,this.transformNodes.pop(),t.parent||t._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(t),e},e.prototype.removeSkeleton=function(t){var e=this.skeletons.indexOf(t);return-1!==e&&(this.skeletons.splice(e,1),this.onSkeletonRemovedObservable.notifyObservers(t)),e},e.prototype.removeMorphTargetManager=function(t){var e=this.morphTargetManagers.indexOf(t);return-1!==e&&this.morphTargetManagers.splice(e,1),e},e.prototype.removeLight=function(t){var e=this.lights.indexOf(t);if(-1!==e){for(var i=0,r=this.meshes;i<r.length;i++){r[i]._removeLightSource(t,!1)}this.lights.splice(e,1),this.sortLightsByPriority(),t.parent||t._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(t),e},e.prototype.removeCamera=function(t){var e=this.cameras.indexOf(t);-1!==e&&(this.cameras.splice(e,1),t.parent||t._removeFromSceneRootNodes());var i=this.activeCameras.indexOf(t);return-1!==i&&this.activeCameras.splice(i,1),this.activeCamera===t&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(t),e},e.prototype.removeParticleSystem=function(t){var e=this.particleSystems.indexOf(t);return-1!==e&&this.particleSystems.splice(e,1),e},e.prototype.removeAnimation=function(t){var e=this.animations.indexOf(t);return-1!==e&&this.animations.splice(e,1),e},e.prototype.stopAnimation=function(t,e,i){},e.prototype.removeAnimationGroup=function(t){var e=this.animationGroups.indexOf(t);return-1!==e&&this.animationGroups.splice(e,1),e},e.prototype.removeMultiMaterial=function(t){var e=this.multiMaterials.indexOf(t);return-1!==e&&this.multiMaterials.splice(e,1),e},e.prototype.removeMaterial=function(t){var e=t._indexInSceneMaterialArray;if(-1!==e&&e<this.materials.length){if(e!==this.materials.length-1){var i=this.materials[this.materials.length-1];this.materials[e]=i,i._indexInSceneMaterialArray=e}t._indexInSceneMaterialArray=-1,this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(t),e},e.prototype.removeActionManager=function(t){var e=this.actionManagers.indexOf(t);return-1!==e&&this.actionManagers.splice(e,1),e},e.prototype.removeTexture=function(t){var e=this.textures.indexOf(t);return-1!==e&&this.textures.splice(e,1),this.onTextureRemovedObservable.notifyObservers(t),e},e.prototype.addLight=function(t){if(!this._blockEntityCollection){this.lights.push(t),this.sortLightsByPriority(),t.parent||t._addToSceneRootNodes();for(var e=0,i=this.meshes;e<i.length;e++){var r=i[e];-1===r.lightSources.indexOf(t)&&(r.lightSources.push(t),r._resyncLightSources())}this.onNewLightAddedObservable.notifyObservers(t)}},e.prototype.sortLightsByPriority=function(){this.requireLightSorting&&this.lights.sort(m.a.CompareLightsPriority)},e.prototype.addCamera=function(t){this._blockEntityCollection||(this.cameras.push(t),this.onNewCameraAddedObservable.notifyObservers(t),t.parent||t._addToSceneRootNodes())},e.prototype.addSkeleton=function(t){this._blockEntityCollection||(this.skeletons.push(t),this.onNewSkeletonAddedObservable.notifyObservers(t))},e.prototype.addParticleSystem=function(t){this._blockEntityCollection||this.particleSystems.push(t)},e.prototype.addAnimation=function(t){this._blockEntityCollection||this.animations.push(t)},e.prototype.addAnimationGroup=function(t){this._blockEntityCollection||this.animationGroups.push(t)},e.prototype.addMultiMaterial=function(t){this._blockEntityCollection||this.multiMaterials.push(t)},e.prototype.addMaterial=function(t){this._blockEntityCollection||(t._indexInSceneMaterialArray=this.materials.length,this.materials.push(t),this.onNewMaterialAddedObservable.notifyObservers(t))},e.prototype.addMorphTargetManager=function(t){this._blockEntityCollection||this.morphTargetManagers.push(t)},e.prototype.addGeometry=function(t){this._blockEntityCollection||(this.geometriesByUniqueId&&(this.geometriesByUniqueId[t.uniqueId]=this.geometries.length),this.geometries.push(t))},e.prototype.addActionManager=function(t){this.actionManagers.push(t)},e.prototype.addTexture=function(t){this._blockEntityCollection||(this.textures.push(t),this.onNewTextureAddedObservable.notifyObservers(t))},e.prototype.switchActiveCamera=function(t,e){void 0===e&&(e=!0);var i=this._engine.getInputElement();i&&(this.activeCamera&&this.activeCamera.detachControl(i),this.activeCamera=t,e&&t.attachControl(i))},e.prototype.setActiveCameraByID=function(t){var e=this.getCameraByID(t);return e?(this.activeCamera=e,e):null},e.prototype.setActiveCameraByName=function(t){var e=this.getCameraByName(t);return e?(this.activeCamera=e,e):null},e.prototype.getAnimationGroupByName=function(t){for(var e=0;e<this.animationGroups.length;e++)if(this.animationGroups[e].name===t)return this.animationGroups[e];return null},e.prototype.getMaterialByUniqueID=function(t){for(var e=0;e<this.materials.length;e++)if(this.materials[e].uniqueId===t)return this.materials[e];return null},e.prototype.getMaterialByID=function(t){for(var e=0;e<this.materials.length;e++)if(this.materials[e].id===t)return this.materials[e];return null},e.prototype.getLastMaterialByID=function(t){for(var e=this.materials.length-1;e>=0;e--)if(this.materials[e].id===t)return this.materials[e];return null},e.prototype.getMaterialByName=function(t){for(var e=0;e<this.materials.length;e++)if(this.materials[e].name===t)return this.materials[e];return null},e.prototype.getTextureByUniqueID=function(t){for(var e=0;e<this.textures.length;e++)if(this.textures[e].uniqueId===t)return this.textures[e];return null},e.prototype.getCameraByID=function(t){for(var e=0;e<this.cameras.length;e++)if(this.cameras[e].id===t)return this.cameras[e];return null},e.prototype.getCameraByUniqueID=function(t){for(var e=0;e<this.cameras.length;e++)if(this.cameras[e].uniqueId===t)return this.cameras[e];return null},e.prototype.getCameraByName=function(t){for(var e=0;e<this.cameras.length;e++)if(this.cameras[e].name===t)return this.cameras[e];return null},e.prototype.getBoneByID=function(t){for(var e=0;e<this.skeletons.length;e++)for(var i=this.skeletons[e],r=0;r<i.bones.length;r++)if(i.bones[r].id===t)return i.bones[r];return null},e.prototype.getBoneByName=function(t){for(var e=0;e<this.skeletons.length;e++)for(var i=this.skeletons[e],r=0;r<i.bones.length;r++)if(i.bones[r].name===t)return i.bones[r];return null},e.prototype.getLightByName=function(t){for(var e=0;e<this.lights.length;e++)if(this.lights[e].name===t)return this.lights[e];return null},e.prototype.getLightByID=function(t){for(var e=0;e<this.lights.length;e++)if(this.lights[e].id===t)return this.lights[e];return null},e.prototype.getLightByUniqueID=function(t){for(var e=0;e<this.lights.length;e++)if(this.lights[e].uniqueId===t)return this.lights[e];return null},e.prototype.getParticleSystemByID=function(t){for(var e=0;e<this.particleSystems.length;e++)if(this.particleSystems[e].id===t)return this.particleSystems[e];return null},e.prototype.getGeometryByID=function(t){for(var e=0;e<this.geometries.length;e++)if(this.geometries[e].id===t)return this.geometries[e];return null},e.prototype._getGeometryByUniqueID=function(t){if(this.geometriesByUniqueId){var e=this.geometriesByUniqueId[t];if(void 0!==e)return this.geometries[e]}else for(var i=0;i<this.geometries.length;i++)if(this.geometries[i].uniqueId===t)return this.geometries[i];return null},e.prototype.pushGeometry=function(t,e){return!(!e&&this._getGeometryByUniqueID(t.uniqueId))&&(this.addGeometry(t),this.onNewGeometryAddedObservable.notifyObservers(t),!0)},e.prototype.removeGeometry=function(t){var e;if(this.geometriesByUniqueId){if(void 0===(e=this.geometriesByUniqueId[t.uniqueId]))return!1}else if((e=this.geometries.indexOf(t))<0)return!1;if(e!==this.geometries.length-1){var i=this.geometries[this.geometries.length-1];i&&(this.geometries[e]=i,this.geometriesByUniqueId&&(this.geometriesByUniqueId[i.uniqueId]=e,this.geometriesByUniqueId[t.uniqueId]=void 0))}return this.geometries.pop(),this.onGeometryRemovedObservable.notifyObservers(t),!0},e.prototype.getGeometries=function(){return this.geometries},e.prototype.getMeshByID=function(t){for(var e=0;e<this.meshes.length;e++)if(this.meshes[e].id===t)return this.meshes[e];return null},e.prototype.getMeshesByID=function(t){return this.meshes.filter((function(e){return e.id===t}))},e.prototype.getTransformNodeByID=function(t){for(var e=0;e<this.transformNodes.length;e++)if(this.transformNodes[e].id===t)return this.transformNodes[e];return null},e.prototype.getTransformNodeByUniqueID=function(t){for(var e=0;e<this.transformNodes.length;e++)if(this.transformNodes[e].uniqueId===t)return this.transformNodes[e];return null},e.prototype.getTransformNodesByID=function(t){return this.transformNodes.filter((function(e){return e.id===t}))},e.prototype.getMeshByUniqueID=function(t){for(var e=0;e<this.meshes.length;e++)if(this.meshes[e].uniqueId===t)return this.meshes[e];return null},e.prototype.getLastMeshByID=function(t){for(var e=this.meshes.length-1;e>=0;e--)if(this.meshes[e].id===t)return this.meshes[e];return null},e.prototype.getLastEntryByID=function(t){var e;for(e=this.meshes.length-1;e>=0;e--)if(this.meshes[e].id===t)return this.meshes[e];for(e=this.transformNodes.length-1;e>=0;e--)if(this.transformNodes[e].id===t)return this.transformNodes[e];for(e=this.cameras.length-1;e>=0;e--)if(this.cameras[e].id===t)return this.cameras[e];for(e=this.lights.length-1;e>=0;e--)if(this.lights[e].id===t)return this.lights[e];return null},e.prototype.getNodeByID=function(t){var e=this.getMeshByID(t);if(e)return e;var i=this.getTransformNodeByID(t);if(i)return i;var r=this.getLightByID(t);if(r)return r;var n=this.getCameraByID(t);if(n)return n;var o=this.getBoneByID(t);return o||null},e.prototype.getNodeByName=function(t){var e=this.getMeshByName(t);if(e)return e;var i=this.getTransformNodeByName(t);if(i)return i;var r=this.getLightByName(t);if(r)return r;var n=this.getCameraByName(t);if(n)return n;var o=this.getBoneByName(t);return o||null},e.prototype.getMeshByName=function(t){for(var e=0;e<this.meshes.length;e++)if(this.meshes[e].name===t)return this.meshes[e];return null},e.prototype.getTransformNodeByName=function(t){for(var e=0;e<this.transformNodes.length;e++)if(this.transformNodes[e].name===t)return this.transformNodes[e];return null},e.prototype.getLastSkeletonByID=function(t){for(var e=this.skeletons.length-1;e>=0;e--)if(this.skeletons[e].id===t)return this.skeletons[e];return null},e.prototype.getSkeletonByUniqueId=function(t){for(var e=0;e<this.skeletons.length;e++)if(this.skeletons[e].uniqueId===t)return this.skeletons[e];return null},e.prototype.getSkeletonById=function(t){for(var e=0;e<this.skeletons.length;e++)if(this.skeletons[e].id===t)return this.skeletons[e];return null},e.prototype.getSkeletonByName=function(t){for(var e=0;e<this.skeletons.length;e++)if(this.skeletons[e].name===t)return this.skeletons[e];return null},e.prototype.getMorphTargetManagerById=function(t){for(var e=0;e<this.morphTargetManagers.length;e++)if(this.morphTargetManagers[e].uniqueId===t)return this.morphTargetManagers[e];return null},e.prototype.getMorphTargetById=function(t){for(var e=0;e<this.morphTargetManagers.length;++e)for(var i=this.morphTargetManagers[e],r=0;r<i.numTargets;++r){var n=i.getTarget(r);if(n.id===t)return n}return null},e.prototype.getMorphTargetByName=function(t){for(var e=0;e<this.morphTargetManagers.length;++e)for(var i=this.morphTargetManagers[e],r=0;r<i.numTargets;++r){var n=i.getTarget(r);if(n.name===t)return n}return null},e.prototype.getPostProcessByName=function(t){for(var e=0;e<this.postProcesses.length;++e){var i=this.postProcesses[e];if(i.name===t)return i}return null},e.prototype.isActiveMesh=function(t){return-1!==this._activeMeshes.indexOf(t)},Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid||(this._uid=n.b.RandomId()),this._uid},enumerable:!1,configurable:!0}),e.prototype.addExternalData=function(t,e){return this._externalData||(this._externalData=new h.a),this._externalData.add(t,e)},e.prototype.getExternalData=function(t){return this._externalData?this._externalData.get(t):null},e.prototype.getOrAddExternalDataWithFactory=function(t,e){return this._externalData||(this._externalData=new h.a),this._externalData.getOrAddWithFactory(t,e)},e.prototype.removeExternalData=function(t){return this._externalData.remove(t)},e.prototype._evaluateSubMesh=function(t,e,i){if(i.hasInstances||i.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||e.alwaysSelectAsActiveMesh||1===e.subMeshes.length||t.isInFrustum(this._frustumPlanes)){for(var r=0,n=this._evaluateSubMeshStage;r<n.length;r++){n[r].action(e,t)}var o=t.getMaterial();null!=o&&(o.hasRenderTargetTextures&&null!=o.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(o)&&(this._processedMaterials.push(o),this._renderTargets.concatWithNoDuplicate(o.getRenderTargetTextures())),this._renderingManager.dispatch(t,e,o))}},e.prototype.freeProcessedMaterials=function(){this._processedMaterials.dispose()},Object.defineProperty(e.prototype,"blockfreeActiveMeshesAndRenderingGroups",{get:function(){return this._preventFreeActiveMeshesAndRenderingGroups},set:function(t){this._preventFreeActiveMeshesAndRenderingGroups!==t&&(t&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=t)},enumerable:!1,configurable:!0}),e.prototype.freeActiveMeshes=function(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(var t=0;t<this.activeCameras.length;t++){var e=this.activeCameras[t];e&&e._activeMeshes&&e._activeMeshes.dispose()}},e.prototype.freeRenderingGroups=function(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(var t=0;t<this.textures.length;t++){var e=this.textures[t];e&&e.renderList&&e.freeRenderingGroups()}},e.prototype._isInIntermediateRendering=function(){return this._intermediateRendering},e.prototype.freezeActiveMeshes=function(t){var e=this;return void 0===t&&(t=!1),this.executeWhenReady((function(){if(e.activeCamera){e._frustumPlanes||e.setTransformMatrix(e.activeCamera.getViewMatrix(),e.activeCamera.getProjectionMatrix()),e._evaluateActiveMeshes(),e._activeMeshesFrozen=!0,e._skipEvaluateActiveMeshesCompletely=t;for(var i=0;i<e._activeMeshes.length;i++)e._activeMeshes.data[i]._freeze()}})),this},e.prototype.unfreezeActiveMeshes=function(){for(var t=0;t<this.meshes.length;t++){var e=this.meshes[t];e._internalAbstractMeshDataInfo&&(e._internalAbstractMeshDataInfo._isActive=!1)}for(t=0;t<this._activeMeshes.length;t++)this._activeMeshes.data[t]._unFreeze();return this._activeMeshesFrozen=!1,this},e.prototype._evaluateActiveMeshes=function(){if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely)for(var t=this._activeMeshes.length,e=0;e<t;e++){(a=this._activeMeshes.data[e]).computeWorldMatrix()}if(this._activeParticleSystems){var i=this._activeParticleSystems.length;for(e=0;e<i;e++)this._activeParticleSystems.data[e].animate()}}else if(this.activeCamera){this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this),this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset();for(var r=0,n=this._beforeEvaluateActiveMeshStage;r<n.length;r++){n[r].action()}var o=this.getActiveMeshCandidates(),s=o.length;for(e=0;e<s;e++){var a;if(!(a=o.data[e]).isBlocked&&(this._totalVertices.addCount(a.getTotalVertices(),!1),a.isReady()&&a.isEnabled()&&0!==a.scaling.lengthSquared())){a.computeWorldMatrix(),a.actionManager&&a.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(a);var h=this.customLODSelector?this.customLODSelector(a,this.activeCamera):a.getLOD(this.activeCamera);null!=h&&(h!==a&&h.billboardMode!==l.a.BILLBOARDMODE_NONE&&h.computeWorldMatrix(),a._preActivate(),a.isVisible&&a.visibility>0&&0!=(a.layerMask&this.activeCamera.layerMask)&&(this._skipFrustumClipping||a.alwaysSelectAsActiveMesh||a.isInFrustum(this._frustumPlanes))&&(this._activeMeshes.push(a),this.activeCamera._activeMeshes.push(a),h!==a&&h._activate(this._renderId,!1),a._activate(this._renderId,!1)&&(a.isAnInstance?a._internalAbstractMeshDataInfo._actAsRegularMesh&&(h=a):h._internalAbstractMeshDataInfo._onlyForInstances=!1,h._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(a,h)),a._postActivate()))}}if(this.onAfterActiveMeshesEvaluationObservable.notifyObservers(this),this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(var c=0;c<this.particleSystems.length;c++){var u=this.particleSystems[c];if(u.isStarted()&&u.emitter){var f=u.emitter;f.position&&!f.isEnabled()||(this._activeParticleSystems.push(u),u.animate(),this._renderingManager.dispatchParticles(u))}}this.onAfterParticlesRenderingObservable.notifyObservers(this)}}},e.prototype._activeMesh=function(t,e){this._skeletonsEnabled&&null!==e.skeleton&&void 0!==e.skeleton&&(this._activeSkeletons.pushNoDuplicate(e.skeleton)&&e.skeleton.prepare(),e.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(e));for(var i=0,r=this._activeMeshStage;i<r.length;i++){r[i].action(t,e)}if(null!=e&&void 0!==e.subMeshes&&null!==e.subMeshes&&e.subMeshes.length>0)for(var n=this.getActiveSubMeshCandidates(e),o=n.length,s=0;s<o;s++){var a=n.data[s];this._evaluateSubMesh(a,e,t)}},e.prototype.updateTransformMatrix=function(t){this.activeCamera&&this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(t))},e.prototype._bindFrameBuffer=function(){if(this.activeCamera&&this.activeCamera._multiviewTexture)this.activeCamera._multiviewTexture._bindFrameBuffer();else if(this.activeCamera&&this.activeCamera.outputRenderTarget){if(this.getEngine().getCaps().multiview&&this.activeCamera.outputRenderTarget&&this.activeCamera.outputRenderTarget.getViewCount()>1)this.activeCamera.outputRenderTarget._bindFrameBuffer();else{var t=this.activeCamera.outputRenderTarget.getInternalTexture();t?this.getEngine().bindFramebuffer(t):P.a.Error("Camera contains invalid customDefaultRenderTarget")}}else this.getEngine().restoreDefaultFramebuffer()},e.prototype._renderForCamera=function(t,e){if(!t||!t._skipRendering){var i=this._engine;if(this._activeCamera=t,!this.activeCamera)throw new Error("Active camera not set");i.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,this.getEngine().getCaps().multiview&&t.outputRenderTarget&&t.outputRenderTarget.getViewCount()>1?this.setTransformMatrix(t._rigCameras[0].getViewMatrix(),t._rigCameras[0].getProjectionMatrix(),t._rigCameras[1].getViewMatrix(),t._rigCameras[1].getProjectionMatrix()):this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),this._evaluateActiveMeshes();for(var r=0;r<this._softwareSkinnedMeshes.length;r++){var o=this._softwareSkinnedMeshes.data[r];o.applySkeleton(o.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this),t.customRenderTargets&&t.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(t.customRenderTargets),e&&e.customRenderTargets&&e.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(e.customRenderTargets);for(var s=0,a=this._gatherActiveCameraRenderTargetsStage;s<a.length;s++){a[s].action(this._renderTargets)}var h=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,this._renderTargets.length>0){n.b.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(var c=0;c<this._renderTargets.length;c++){var u=this._renderTargets.data[c];if(u._shouldRender()){this._renderId++;var l=u.activeCamera&&u.activeCamera!==this.activeCamera;u.render(l,this.dumpNextRenderTargets),h=!0}}n.b.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._renderId++}for(var f=0,d=this._cameraDrawRenderTargetStage;f<d.length;f++){h=d[f].action(this.activeCamera)||h}this._intermediateRendering=!1,this.activeCamera&&this.activeCamera.outputRenderTarget&&(h=!0)}h&&!this.prePass&&this._bindFrameBuffer(),this.onAfterRenderTargetsRenderObservable.notifyObservers(this),!this.postProcessManager||t._multiviewTexture||this.prePass||this.postProcessManager._prepareFrame();for(var p=0,_=this._beforeCameraDrawStage;p<_.length;p++){_[p].action(this.activeCamera)}this.onBeforeDrawPhaseObservable.notifyObservers(this),this._renderingManager.render(null,null,!0,!0),this.onAfterDrawPhaseObservable.notifyObservers(this);for(var g=0,m=this._afterCameraDrawStage;g<m.length;g++){m[g].action(this.activeCamera)}this.postProcessManager&&!t._multiviewTexture&&this.postProcessManager._finalizeFrame(t.isIntermediate),this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}},e.prototype._processSubCameras=function(t){if(t.cameraRigMode===d.a.RIG_MODE_NONE||t.outputRenderTarget&&t.outputRenderTarget.getViewCount()>1&&this.getEngine().getCaps().multiview)return this._renderForCamera(t),void this.onAfterRenderCameraObservable.notifyObservers(t);if(t._useMultiviewToSingleView)this._renderMultiviewToSingleView(t);else for(var e=0;e<t._rigCameras.length;e++)this._renderForCamera(t._rigCameras[e],t);this._activeCamera=t,this.setTransformMatrix(this._activeCamera.getViewMatrix(),this._activeCamera.getProjectionMatrix()),this.onAfterRenderCameraObservable.notifyObservers(t)},e.prototype._checkIntersections=function(){for(var t=0;t<this._meshesForIntersections.length;t++){var e=this._meshesForIntersections.data[t];if(e.actionManager)for(var i=0;e.actionManager&&i<e.actionManager.actions.length;i++){var r=e.actionManager.actions[i];if(12===r.trigger||13===r.trigger){var n=r.getTriggerParameter(),o=n instanceof f.a?n:n.mesh,s=o.intersectsMesh(e,n.usePreciseIntersection),a=e._intersectionsInProgress.indexOf(o);s&&-1===a?12===r.trigger?(r._executeCurrent(b.a.CreateNew(e,void 0,o)),e._intersectionsInProgress.push(o)):13===r.trigger&&e._intersectionsInProgress.push(o):!s&&a>-1&&(13===r.trigger&&r._executeCurrent(b.a.CreateNew(e,void 0,o)),e.actionManager.hasSpecificTrigger(13,(function(t){var e=t instanceof f.a?t:t.mesh;return o===e}))&&13!==r.trigger||e._intersectionsInProgress.splice(a,1))}}}},e.prototype._advancePhysicsEngineStep=function(t){},e.prototype._animate=function(){},e.prototype.animate=function(){if(this._engine.isDeterministicLockStep()){var t=Math.max(e.MinDeltaTime,Math.min(this._engine.getDeltaTime(),e.MaxDeltaTime))+this._timeAccumulator,i=this._engine.getTimeStep(),r=1e3/i/1e3,n=0,o=this._engine.getLockstepMaxSteps(),s=Math.floor(t/i);for(s=Math.min(s,o);t>0&&n<s;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=i*r,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(i),this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,n++,t-=i;this._timeAccumulator=t<0?0:t}else{t=this.useConstantAnimationDeltaTime?16:Math.max(e.MinDeltaTime,Math.min(this._engine.getDeltaTime(),e.MaxDeltaTime));this._animationRatio=.06*t,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(t)}},e.prototype.render=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),!this.isDisposed){this.onReadyObservable.hasObservers()&&-1===this._executeWhenReadyTimeoutId&&this._checkIsReady(),this._frameId++,this._registerTransientComponents(),this._activeParticles.fetchNewFrame(),this._totalVertices.fetchNewFrame(),this._activeIndices.fetchNewFrame(),this._activeBones.fetchNewFrame(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),this.onBeforeAnimationsObservable.notifyObservers(this),this.actionManager&&this.actionManager.processTrigger(11),e||this.animate();for(var i=0,r=this._beforeCameraUpdateStage;i<r.length;i++){r[i].action()}if(t)if(this.activeCameras.length>0)for(var o=0;o<this.activeCameras.length;o++){var s=this.activeCameras[o];if(s.update(),s.cameraRigMode!==d.a.RIG_MODE_NONE)for(var a=0;a<s._rigCameras.length;a++)s._rigCameras[a].update()}else if(this.activeCamera&&(this.activeCamera.update(),this.activeCamera.cameraRigMode!==d.a.RIG_MODE_NONE))for(a=0;a<this.activeCamera._rigCameras.length;a++)this.activeCamera._rigCameras[a].update();this.onBeforeRenderObservable.notifyObservers(this),this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);var h=this.getEngine(),c=this.activeCamera;if(this.renderTargetsEnabled){n.b.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!0;for(var u=0;u<this.customRenderTargets.length;u++){var l=this.customRenderTargets[u];if(l._shouldRender()){if(this._renderId++,this.activeCamera=l.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");h.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),l.render(c!==this.activeCamera,this.dumpNextRenderTargets)}}n.b.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!1,this._renderId++}this.activeCamera=c,this._activeCamera&&this._activeCamera.cameraRigMode!==d.a.RIG_MODE_CUSTOM&&!this.prePass&&this._bindFrameBuffer(),this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(var f=0,p=this._beforeClearStage;f<p.length;f++){p[f].action()}!this.autoClearDepthAndStencil&&!this.autoClear||this.prePass||this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil);for(var _=0,g=this._gatherRenderTargetsStage;_<g.length;_++){g[_].action(this._renderTargets)}if(this.activeCameras.length>0)for(o=0;o<this.activeCameras.length;o++)o>0&&this._engine.clear(null,!1,!0,!0),this._processSubCameras(this.activeCameras[o]);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera)}this._checkIntersections();for(var m=0,y=this._afterRenderStage;m<y.length;m++){y[m].action()}if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(a=0;a<this._toBeDisposed.length;a++){var b=this._toBeDisposed[a];b&&b.dispose()}this._toBeDisposed=[]}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),this._activeBones.addCount(0,!0),this._activeIndices.addCount(0,!0),this._activeParticles.addCount(0,!0)}},e.prototype.freezeMaterials=function(){for(var t=0;t<this.materials.length;t++)this.materials[t].freeze()},e.prototype.unfreezeMaterials=function(){for(var t=0;t<this.materials.length;t++)this.materials[t].unfreeze()},e.prototype.dispose=function(){this.beforeRender=null,this.afterRender=null,x.a._LastCreatedScene===this&&(x.a._LastCreatedScene=null),this.skeletons=[],this.morphTargetManagers=[],this._transientComponents=[],this._isReadyForMeshStage.clear(),this._beforeEvaluateActiveMeshStage.clear(),this._evaluateSubMeshStage.clear(),this._activeMeshStage.clear(),this._cameraDrawRenderTargetStage.clear(),this._beforeCameraDrawStage.clear(),this._beforeRenderTargetDrawStage.clear(),this._beforeRenderingGroupDrawStage.clear(),this._beforeRenderingMeshStage.clear(),this._afterRenderingMeshStage.clear(),this._afterRenderingGroupDrawStage.clear(),this._afterCameraDrawStage.clear(),this._afterRenderTargetDrawStage.clear(),this._afterRenderStage.clear(),this._beforeCameraUpdateStage.clear(),this._beforeClearStage.clear(),this._gatherRenderTargetsStage.clear(),this._gatherActiveCameraRenderTargetsStage.clear(),this._pointerMoveStage.clear(),this._pointerDownStage.clear(),this._pointerUpStage.clear();for(var t=0,e=this._components;t<e.length;t++){e[t].dispose()}this.importedMeshesFiles=new Array,this.stopAllAnimations&&this.stopAllAnimations(),this.resetCachedMaterial(),this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),this.activeCamera=null),this._activeMeshes.dispose(),this._renderingManager.dispose(),this._processedMaterials.dispose(),this._activeParticleSystems.dispose(),this._activeSkeletons.dispose(),this._softwareSkinnedMeshes.dispose(),this._renderTargets.dispose(),this._registeredForLateAnimationBindings.dispose(),this._meshesForIntersections.dispose(),this._toBeDisposed=[];for(var i=0,r=this._activeRequests;i<r.length;i++){r[i].abort()}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),this.onNewMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.detachControl();var n,o=this._engine.getInputElement();if(o)for(n=0;n<this.cameras.length;n++)this.cameras[n].detachControl(o);for(;this.animationGroups.length;)this.animationGroups[0].dispose();for(;this.lights.length;)this.lights[0].dispose();for(;this.meshes.length;)this.meshes[0].dispose(!0);for(;this.transformNodes.length;)this.transformNodes[0].dispose(!0);for(;this.cameras.length;)this.cameras[0].dispose();for(this._defaultMaterial&&this._defaultMaterial.dispose();this.multiMaterials.length;)this.multiMaterials[0].dispose();for(;this.materials.length;)this.materials[0].dispose();for(;this.particleSystems.length;)this.particleSystems[0].dispose();for(;this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.textures.length;)this.textures[0].dispose();this._sceneUbo.dispose(),this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose(),this.postProcessManager.dispose(),(n=this._engine.scenes.indexOf(this))>-1&&this._engine.scenes.splice(n,1),this._engine.wipeCaches(!0),this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.clearCachedVertexData=function(){for(var t=0;t<this.meshes.length;t++){var e=this.meshes[t].geometry;if(e)for(var i in e._indices=[],e._vertexBuffers)e._vertexBuffers.hasOwnProperty(i)&&(e._vertexBuffers[i]._buffer._data=null)}},e.prototype.cleanCachedTextureBuffer=function(){for(var t=0,e=this.textures;t<e.length;t++){var i=e[t];i._buffer&&(i._buffer=null)}},e.prototype.getWorldExtends=function(t){var e=new u.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),i=new u.e(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return t=t||function(){return!0},this.meshes.filter(t).forEach((function(t){if(t.computeWorldMatrix(!0),t.subMeshes&&0!==t.subMeshes.length&&!t.infiniteDistance){var r=t.getBoundingInfo(),n=r.boundingBox.minimumWorld,o=r.boundingBox.maximumWorld;u.e.CheckExtends(n,e,i),u.e.CheckExtends(o,e,i)}})),{min:e,max:i}},e.prototype.createPickingRay=function(t,e,i,r,n){throw void 0===n&&(n=!1),T.a.WarnImport("Ray")},e.prototype.createPickingRayToRef=function(t,e,i,r,n,o){throw void 0===o&&(o=!1),T.a.WarnImport("Ray")},e.prototype.createPickingRayInCameraSpace=function(t,e,i){throw T.a.WarnImport("Ray")},e.prototype.createPickingRayInCameraSpaceToRef=function(t,e,i,r){throw T.a.WarnImport("Ray")},e.prototype.pick=function(t,e,i,r,n,o){var s=new y.a;return s._pickingUnavailable=!0,s},e.prototype.pickWithBoundingInfo=function(t,e,i,r,n){var o=new y.a;return o._pickingUnavailable=!0,o},e.prototype.pickWithRay=function(t,e,i,r){throw T.a.WarnImport("Ray")},e.prototype.multiPick=function(t,e,i,r,n){throw T.a.WarnImport("Ray")},e.prototype.multiPickWithRay=function(t,e,i){throw T.a.WarnImport("Ray")},e.prototype.setPointerOverMesh=function(t,e){this._inputManager.setPointerOverMesh(t,e)},e.prototype.getPointerOverMesh=function(){return this._inputManager.getPointerOverMesh()},e.prototype._rebuildGeometries=function(){for(var t=0,e=this.geometries;t<e.length;t++){e[t]._rebuild()}for(var i=0,r=this.meshes;i<r.length;i++){r[i]._rebuild()}this.postProcessManager&&this.postProcessManager._rebuild();for(var n=0,o=this._components;n<o.length;n++){o[n].rebuild()}for(var s=0,a=this.particleSystems;s<a.length;s++){a[s].rebuild()}},e.prototype._rebuildTextures=function(){for(var t=0,e=this.textures;t<e.length;t++){e[t]._rebuild()}this.markAllMaterialsAsDirty(1)},e.prototype._getByTags=function(t,e,i){if(void 0===e)return t;var r=[];for(var n in i=i||function(t){},t){var o=t[n];c.a&&c.a.MatchesQuery(o,e)&&(r.push(o),i(o))}return r},e.prototype.getMeshesByTags=function(t,e){return this._getByTags(this.meshes,t,e)},e.prototype.getCamerasByTags=function(t,e){return this._getByTags(this.cameras,t,e)},e.prototype.getLightsByTags=function(t,e){return this._getByTags(this.lights,t,e)},e.prototype.getMaterialByTags=function(t,e){return this._getByTags(this.materials,t,e).concat(this._getByTags(this.multiMaterials,t,e))},e.prototype.getTransformNodesByTags=function(t,e){return this._getByTags(this.transformNodes,t,e)},e.prototype.setRenderingOrder=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this._renderingManager.setRenderingOrder(t,e,i,r)},e.prototype.setRenderingAutoClearDepthStencil=function(t,e,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0),this._renderingManager.setRenderingAutoClearDepthStencil(t,e,i,r)},e.prototype.getAutoClearDepthStencilSetup=function(t){return this._renderingManager.getAutoClearDepthStencilSetup(t)},Object.defineProperty(e.prototype,"blockMaterialDirtyMechanism",{get:function(){return this._blockMaterialDirtyMechanism},set:function(t){this._blockMaterialDirtyMechanism!==t&&(this._blockMaterialDirtyMechanism=t,t||this.markAllMaterialsAsDirty(31))},enumerable:!1,configurable:!0}),e.prototype.markAllMaterialsAsDirty=function(t,e){if(!this._blockMaterialDirtyMechanism)for(var i=0,r=this.materials;i<r.length;i++){var n=r[i];e&&!e(n)||n.markAsDirty(t)}},e.prototype._loadFile=function(t,e,i,r,n,o){var s=this,a=N.a.LoadFile(t,e,i,r?this.offlineProvider:void 0,n,o);return this._activeRequests.push(a),a.onCompleteObservable.add((function(t){s._activeRequests.splice(s._activeRequests.indexOf(t),1)})),a},e.prototype._loadFileAsync=function(t,e,i,r){var n=this;return new Promise((function(o,s){n._loadFile(t,(function(t){o(t)}),e,i,r,(function(t,e){s(e)}))}))},e.prototype._requestFile=function(t,e,i,r,n,o,s){var a=this,h=N.a.RequestFile(t,e,i,r?this.offlineProvider:void 0,n,o,s);return this._activeRequests.push(h),h.onCompleteObservable.add((function(t){a._activeRequests.splice(a._activeRequests.indexOf(t),1)})),h},e.prototype._requestFileAsync=function(t,e,i,r,n){var o=this;return new Promise((function(s,a){o._requestFile(t,(function(t){s(t)}),e,i,r,(function(t){a(t)}),n)}))},e.prototype._readFile=function(t,e,i,r,n){var o=this,s=N.a.ReadFile(t,e,i,r,n);return this._activeRequests.push(s),s.onCompleteObservable.add((function(t){o._activeRequests.splice(o._activeRequests.indexOf(t),1)})),s},e.prototype._readFileAsync=function(t,e,i){var r=this;return new Promise((function(n,o){r._readFile(t,(function(t){n(t)}),e,i,(function(t){o(t)}))}))},e.FOGMODE_NONE=0,e.FOGMODE_EXP=1,e.FOGMODE_EXP2=2,e.FOGMODE_LINEAR=3,e.MinDeltaTime=1,e.MaxDeltaTime=1e3,e}(p.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return _}));var r=i(3),n=i(37),o=i(68),s=i(41),a=i(0),h=i(34),c=i(47),u=i(1),l=i(35),f=i(5),d=i(86),p=i(140),_=function(t){function e(i,r,n,s){void 0===s&&(s=!0);var c=t.call(this,i,n)||this;return c._position=h.e.Zero(),c._upVector=h.e.Up(),c.orthoLeft=null,c.orthoRight=null,c.orthoBottom=null,c.orthoTop=null,c.fov=.8,c.minZ=1,c.maxZ=1e4,c.inertia=.9,c.mode=e.PERSPECTIVE_CAMERA,c.isIntermediate=!1,c.viewport=new d.a(0,0,1,1),c.layerMask=268435455,c.fovMode=e.FOVMODE_VERTICAL_FIXED,c.cameraRigMode=e.RIG_MODE_NONE,c.customRenderTargets=new Array,c.outputRenderTarget=null,c.onViewMatrixChangedObservable=new a.a,c.onProjectionMatrixChangedObservable=new a.a,c.onAfterCheckInputsObservable=new a.a,c.onRestoreStateObservable=new a.a,c.isRigCamera=!1,c._rigCameras=new Array,c._webvrViewMatrix=h.a.Identity(),c._skipRendering=!1,c._projectionMatrix=new h.a,c._postProcesses=new Array,c._activeMeshes=new o.a(256),c._globalPosition=h.e.Zero(),c._computedViewMatrix=h.a.Identity(),c._doNotComputeProjectionMatrix=!1,c._transformMatrix=h.a.Zero(),c._refreshFrustumPlanes=!0,c._isCamera=!0,c._isLeftCamera=!1,c._isRightCamera=!1,c.getScene().addCamera(c),s&&!c.getScene().activeCamera&&(c.getScene().activeCamera=c),c.position=r,c}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upVector",{get:function(){return this._upVector},set:function(t){this._upVector=t},enumerable:!1,configurable:!0}),e.prototype.storeState=function(){return this._stateStored=!0,this._storedFov=this.fov,this},e.prototype._restoreStateValues=function(){return!!this._stateStored&&(this.fov=this._storedFov,!0)},e.prototype.restoreState=function(){return!!this._restoreStateValues()&&(this.onRestoreStateObservable.notifyObservers(this),!0)},e.prototype.getClassName=function(){return"Camera"},e.prototype.toString=function(t){var e="Name: "+this.name;if(e+=", type: "+this.getClassName(),this.animations)for(var i=0;i<this.animations.length;i++)e+=", animation[0]: "+this.animations[i].toString(t);return e},Object.defineProperty(e.prototype,"globalPosition",{get:function(){return this._globalPosition},enumerable:!1,configurable:!0}),e.prototype.getActiveMeshes=function(){return this._activeMeshes},e.prototype.isActiveMesh=function(t){return-1!==this._activeMeshes.indexOf(t)},e.prototype.isReady=function(e){if(void 0===e&&(e=!1),e)for(var i=0,r=this._postProcesses;i<r.length;i++){var n=r[i];if(n&&!n.isReady())return!1}return t.prototype.isReady.call(this,e)},e.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.position=new h.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new h.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0},e.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)},e.prototype._isSynchronized=function(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()},e.prototype._isSynchronizedViewMatrix=function(){return!!t.prototype._isSynchronized.call(this)&&(this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent())},e.prototype._isSynchronizedProjectionMatrix=function(){var t=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!t)return!1;var i=this.getEngine();return t=this.mode===e.PERSPECTIVE_CAMERA?this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===i.getAspectRatio(this):this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===i.getRenderWidth()&&this._cache.renderHeight===i.getRenderHeight()},e.prototype.attachControl=function(t,e){},e.prototype.detachControl=function(t){},e.prototype.update=function(){this._checkInputs(),this.cameraRigMode!==e.RIG_MODE_NONE&&this._updateRigCameras()},e.prototype._checkInputs=function(){this.onAfterCheckInputsObservable.notifyObservers(this)},Object.defineProperty(e.prototype,"rigCameras",{get:function(){return this._rigCameras},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rigPostProcess",{get:function(){return this._rigPostProcess},enumerable:!1,configurable:!0}),e.prototype._getFirstPostProcess=function(){for(var t=0;t<this._postProcesses.length;t++)if(null!==this._postProcesses[t])return this._postProcesses[t];return null},e.prototype._cascadePostProcessesToRigCams=function(){var t=this._getFirstPostProcess();t&&t.markTextureDirty();for(var e=0,i=this._rigCameras.length;e<i;e++){var r=this._rigCameras[e],n=r._rigPostProcess;if(n)"pass"===n.getEffectName()&&(r.isIntermediate=0===this._postProcesses.length),r._postProcesses=this._postProcesses.slice(0).concat(n),n.markTextureDirty();else r._postProcesses=this._postProcesses.slice(0)}},e.prototype.attachPostProcess=function(t,e){return void 0===e&&(e=null),!t.isReusable()&&this._postProcesses.indexOf(t)>-1?(u.a.Error("You're trying to reuse a post process not defined as reusable."),0):(null==e||e<0?this._postProcesses.push(t):null===this._postProcesses[e]?this._postProcesses[e]=t:this._postProcesses.splice(e,0,t),this._cascadePostProcessesToRigCams(),this._postProcesses.indexOf(t))},e.prototype.detachPostProcess=function(t){var e=this._postProcesses.indexOf(t);-1!==e&&(this._postProcesses[e]=null),this._cascadePostProcessesToRigCams()},e.prototype.getWorldMatrix=function(){return this._isSynchronizedViewMatrix()||this.getViewMatrix(),this._worldMatrix},e.prototype._getViewMatrix=function(){return h.a.Identity()},e.prototype.getViewMatrix=function(t){return!t&&this._isSynchronizedViewMatrix()||(this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix)),this._computedViewMatrix},e.prototype.freezeProjectionMatrix=function(t){this._doNotComputeProjectionMatrix=!0,void 0!==t&&(this._projectionMatrix=t)},e.prototype.unfreezeProjectionMatrix=function(){this._doNotComputeProjectionMatrix=!1},e.prototype.getProjectionMatrix=function(t){var i,r,n,o,s,a,c,u;if(this._doNotComputeProjectionMatrix||!t&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;var l=this.getEngine(),f=this.getScene();if(this.mode===e.PERSPECTIVE_CAMERA){this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=l.getAspectRatio(this),this.minZ<=0&&(this.minZ=.1);var d=l.useReverseDepthBuffer;(f.useRightHandedSystem?d?h.a.PerspectiveFovReverseRHToRef:h.a.PerspectiveFovRHToRef:d?h.a.PerspectiveFovReverseLHToRef:h.a.PerspectiveFovLHToRef)(this.fov,l.getAspectRatio(this),this.minZ,this.maxZ,this._projectionMatrix,this.fovMode===e.FOVMODE_VERTICAL_FIXED)}else{var p=l.getRenderWidth()/2,_=l.getRenderHeight()/2;f.useRightHandedSystem?h.a.OrthoOffCenterRHToRef(null!==(i=this.orthoLeft)&&void 0!==i?i:-p,null!==(r=this.orthoRight)&&void 0!==r?r:p,null!==(n=this.orthoBottom)&&void 0!==n?n:-_,null!==(o=this.orthoTop)&&void 0!==o?o:_,this.minZ,this.maxZ,this._projectionMatrix):h.a.OrthoOffCenterLHToRef(null!==(s=this.orthoLeft)&&void 0!==s?s:-p,null!==(a=this.orthoRight)&&void 0!==a?a:p,null!==(c=this.orthoBottom)&&void 0!==c?c:-_,null!==(u=this.orthoTop)&&void 0!==u?u:_,this.minZ,this.maxZ,this._projectionMatrix),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.renderWidth=l.getRenderWidth(),this._cache.renderHeight=l.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix},e.prototype.getTransformationMatrix=function(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix},e.prototype._updateFrustumPlanes=function(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?p.a.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=p.a.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)},e.prototype.isInFrustum=function(t,e){if(void 0===e&&(e=!1),this._updateFrustumPlanes(),e&&this.rigCameras.length>0){var i=!1;return this.rigCameras.forEach((function(e){e._updateFrustumPlanes(),i=i||t.isInFrustum(e._frustumPlanes)})),i}return t.isInFrustum(this._frustumPlanes)},e.prototype.isCompletelyInFrustum=function(t){return this._updateFrustumPlanes(),t.isCompletelyInFrustum(this._frustumPlanes)},e.prototype.getForwardRay=function(t,e,i){throw void 0===t&&(t=100),f.a.WarnImport("Ray")},e.prototype.getForwardRayToRef=function(t,e,i,r){throw void 0===e&&(e=100),f.a.WarnImport("Ray")},e.prototype.dispose=function(i,r){for(void 0===r&&(r=!1),this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){var n=this._rigCameras.pop();n&&n.dispose()}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses=[];else if(this.cameraRigMode!==e.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses=[];else for(var o=this._postProcesses.length;--o>=0;){var s=this._postProcesses[o];s&&s.dispose(this)}for(o=this.customRenderTargets.length;--o>=0;)this.customRenderTargets[o].dispose();this.customRenderTargets=[],this._activeMeshes.dispose(),t.prototype.dispose.call(this,i,r)},Object.defineProperty(e.prototype,"isLeftCamera",{get:function(){return this._isLeftCamera},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRightCamera",{get:function(){return this._isRightCamera},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftCamera",{get:function(){return this._rigCameras.length<1?null:this._rigCameras[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightCamera",{get:function(){return this._rigCameras.length<2?null:this._rigCameras[1]},enumerable:!1,configurable:!0}),e.prototype.getLeftTarget=function(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()},e.prototype.getRightTarget=function(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()},e.prototype.setCameraRigMode=function(t,i){if(this.cameraRigMode!==t){for(;this._rigCameras.length>0;){var r=this._rigCameras.pop();r&&r.dispose()}if(this.cameraRigMode=t,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=i.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=s.b.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==e.RIG_MODE_NONE){var n=this.createRigCamera(this.name+"_L",0);n&&(n._isLeftCamera=!0);var o=this.createRigCamera(this.name+"_R",1);o&&(o._isRightCamera=!0),n&&o&&(this._rigCameras.push(n),this._rigCameras.push(o))}switch(this.cameraRigMode){case e.RIG_MODE_STEREOSCOPIC_ANAGLYPH:e._setStereoscopicAnaglyphRigMode(this);break;case e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case e.RIG_MODE_STEREOSCOPIC_OVERUNDER:case e.RIG_MODE_STEREOSCOPIC_INTERLACED:e._setStereoscopicRigMode(this);break;case e.RIG_MODE_VR:e._setVRRigMode(this,i);break;case e.RIG_MODE_WEBVR:e._setWebVRRigMode(this,i)}this._cascadePostProcessesToRigCams(),this.update()}},e._setStereoscopicRigMode=function(t){throw"Import Cameras/RigModes/stereoscopicRigMode before using stereoscopic rig mode"},e._setStereoscopicAnaglyphRigMode=function(t){throw"Import Cameras/RigModes/stereoscopicAnaglyphRigMode before using stereoscopic anaglyph rig mode"},e._setVRRigMode=function(t,e){throw"Import Cameras/RigModes/vrRigMode before using VR rig mode"},e._setWebVRRigMode=function(t,e){throw"Import Cameras/RigModes/WebVRRigMode before using Web VR rig mode"},e.prototype._getVRProjectionMatrix=function(){return h.a.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix},e.prototype._updateCameraRotationMatrix=function(){},e.prototype._updateWebVRCameraRotationMatrix=function(){},e.prototype._getWebVRProjectionMatrix=function(){return h.a.Identity()},e.prototype._getWebVRViewMatrix=function(){return h.a.Identity()},e.prototype.setCameraRigParameter=function(t,e){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[t]=e,"interaxialDistance"===t&&(this._cameraRigParams.stereoHalfAngle=s.b.ToRadians(e/.0637))},e.prototype.createRigCamera=function(t,e){return null},e.prototype._updateRigCameras=function(){for(var t=0;t<this._rigCameras.length;t++)this._rigCameras[t].minZ=this.minZ,this._rigCameras[t].maxZ=this.maxZ,this._rigCameras[t].fov=this.fov,this._rigCameras[t].upVector.copyFrom(this.upVector);this.cameraRigMode===e.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)},e.prototype._setupInputs=function(){},e.prototype.serialize=function(){var t=n.a.Serialize(this);return t.type=this.getClassName(),this.parent&&(t.parentId=this.parent.id),this.inputs&&this.inputs.serialize(t),n.a.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t},e.prototype.clone=function(t){return n.a.Clone(e.GetConstructorFromName(this.getClassName(),t,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this)},e.prototype.getDirection=function(t){var e=h.e.Zero();return this.getDirectionToRef(t,e),e},Object.defineProperty(e.prototype,"absoluteRotation",{get:function(){var t=h.b.Zero();return this.getWorldMatrix().decompose(void 0,t),t},enumerable:!1,configurable:!0}),e.prototype.getDirectionToRef=function(t,e){h.e.TransformNormalToRef(t,this.getWorldMatrix(),e)},e.GetConstructorFromName=function(t,i,r,n,o){void 0===n&&(n=0),void 0===o&&(o=!0);var s=c.a.Construct(t,i,r,{interaxial_distance:n,isStereoscopicSideBySide:o});return s||function(){return e._createDefaultParsedCamera(i,r)}},e.prototype.computeWorldMatrix=function(){return this.getWorldMatrix()},e.Parse=function(t,i){var r=t.type,o=e.GetConstructorFromName(r,t.name,i,t.interaxial_distance,t.isStereoscopicSideBySide),s=n.a.Parse(o,t,i);if(t.parentId&&(s._waitingParentId=t.parentId),s.inputs&&(s.inputs.parse(t),s._setupInputs()),s.setPosition&&(s.position.copyFromFloats(0,0,0),s.setPosition(h.e.FromArray(t.position))),t.target&&s.setTarget&&s.setTarget(h.e.FromArray(t.target)),t.cameraRigMode){var a=t.interaxial_distance?{interaxialDistance:t.interaxial_distance}:{};s.setCameraRigMode(t.cameraRigMode,a)}if(t.animations){for(var u=0;u<t.animations.length;u++){var f=t.animations[u],d=l.a.GetClass("BABYLON.Animation");d&&s.animations.push(d.Parse(f))}c.a.ParseAnimationRanges(s,t,i)}return t.autoAnimate&&i.beginAnimation(s,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),s},e._createDefaultParsedCamera=function(t,e){throw f.a.WarnImport("UniversalCamera")},e.PERSPECTIVE_CAMERA=0,e.ORTHOGRAPHIC_CAMERA=1,e.FOVMODE_VERTICAL_FIXED=0,e.FOVMODE_HORIZONTAL_FIXED=1,e.RIG_MODE_NONE=0,e.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,e.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,e.RIG_MODE_STEREOSCOPIC_INTERLACED=14,e.RIG_MODE_VR=20,e.RIG_MODE_WEBVR=21,e.RIG_MODE_CUSTOM=22,e.ForceAttachControlToAlwaysPreventDefault=!1,Object(r.c)([Object(n.o)("position")],e.prototype,"_position",void 0),Object(r.c)([Object(n.o)("upVector")],e.prototype,"_upVector",void 0),Object(r.c)([Object(n.c)()],e.prototype,"orthoLeft",void 0),Object(r.c)([Object(n.c)()],e.prototype,"orthoRight",void 0),Object(r.c)([Object(n.c)()],e.prototype,"orthoBottom",void 0),Object(r.c)([Object(n.c)()],e.prototype,"orthoTop",void 0),Object(r.c)([Object(n.c)()],e.prototype,"fov",void 0),Object(r.c)([Object(n.c)()],e.prototype,"minZ",void 0),Object(r.c)([Object(n.c)()],e.prototype,"maxZ",void 0),Object(r.c)([Object(n.c)()],e.prototype,"inertia",void 0),Object(r.c)([Object(n.c)()],e.prototype,"mode",void 0),Object(r.c)([Object(n.c)()],e.prototype,"layerMask",void 0),Object(r.c)([Object(n.c)()],e.prototype,"fovMode",void 0),Object(r.c)([Object(n.c)()],e.prototype,"cameraRigMode",void 0),Object(r.c)([Object(n.c)()],e.prototype,"interaxialDistance",void 0),Object(r.c)([Object(n.c)()],e.prototype,"isStereoscopicSideBySide",void 0),e}(c.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.WithinEpsilon=function(t,e,i){void 0===i&&(i=1401298e-51);var r=t-e;return-i<=r&&r<=i},t.ToHex=function(t){var e=t.toString(16);return t<=15?("0"+e).toUpperCase():e.toUpperCase()},t.Sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1},t.Clamp=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),Math.min(i,Math.max(e,t))},t.Log2=function(t){return Math.log(t)*Math.LOG2E},t.Repeat=function(t,e){return t-Math.floor(t/e)*e},t.Normalize=function(t,e,i){return(t-e)/(i-e)},t.Denormalize=function(t,e,i){return t*(i-e)+e},t.DeltaAngle=function(e,i){var r=t.Repeat(i-e,360);return r>180&&(r-=360),r},t.PingPong=function(e,i){var r=t.Repeat(e,2*i);return i-Math.abs(r-i)},t.SmoothStep=function(e,i,r){var n=t.Clamp(r);return i*(n=-2*n*n*n+3*n*n)+e*(1-n)},t.MoveTowards=function(e,i,r){return Math.abs(i-e)<=r?i:e+t.Sign(i-e)*r},t.MoveTowardsAngle=function(e,i,r){var n=t.DeltaAngle(e,i),o=0;return-r<n&&n<r?o=i:(i=e+n,o=t.MoveTowards(e,i,r)),o},t.Lerp=function(t,e,i){return t+(e-t)*i},t.LerpAngle=function(e,i,r){var n=t.Repeat(i-e,360);return n>180&&(n-=360),e+n*t.Clamp(r)},t.InverseLerp=function(e,i,r){return e!=i?t.Clamp((r-e)/(i-e)):0},t.Hermite=function(t,e,i,r,n){var o=n*n,s=n*o;return t*(2*s-3*o+1)+i*(-2*s+3*o)+e*(s-2*o+n)+r*(s-o)},t.RandomRange=function(t,e){return t===e?t:Math.random()*(e-t)+t},t.RangeToPercent=function(t,e,i){return(t-e)/(i-e)},t.PercentToRange=function(t,e,i){return(i-e)*t+e},t.NormalizeRadians=function(e){return e-=t.TwoPi*Math.floor((e+Math.PI)/t.TwoPi)},t.TwoPi=2*Math.PI,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var r=i(3),n=i(34),o=i(37),s=i(0),a=i(6),h=i(5),c=function(){function t(t,e){void 0===e&&(e=null),this.state="",this.metadata=null,this.reservedDataStore=null,this._doNotSerialize=!1,this._isDisposed=!1,this.animations=new Array,this._ranges={},this.onReady=null,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=n.a.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._sceneRootNodesIndex=-1,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new s.a,this._onDisposeObserver=null,this._behaviors=new Array,this.name=t,this.id=t,this._scene=e||a.a.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache()}return t.AddNodeConstructor=function(t,e){this._NodeConstructors[t]=e},t.Construct=function(t,e,i,r){var n=this._NodeConstructors[t];return n?n(e,i,r):null},Object.defineProperty(t.prototype,"doNotSerialize",{get:function(){return!!this._doNotSerialize||!!this._parentNode&&this._parentNode.doNotSerialize},set:function(t){this._doNotSerialize=t},enumerable:!1,configurable:!0}),t.prototype.isDisposed=function(){return this._isDisposed},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parentNode},set:function(t){if(this._parentNode!==t){var e=this._parentNode;if(this._parentNode&&void 0!==this._parentNode._children&&null!==this._parentNode._children){var i=this._parentNode._children.indexOf(this);-1!==i&&this._parentNode._children.splice(i,1),t||this._isDisposed||this._addToSceneRootNodes()}this._parentNode=t,this._parentNode&&(void 0!==this._parentNode._children&&null!==this._parentNode._children||(this._parentNode._children=new Array),this._parentNode._children.push(this),e||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}},enumerable:!1,configurable:!0}),t.prototype._addToSceneRootNodes=function(){-1===this._sceneRootNodesIndex&&(this._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))},t.prototype._removeFromSceneRootNodes=function(){if(-1!==this._sceneRootNodesIndex){var t=this._scene.rootNodes,e=t.length-1;t[this._sceneRootNodesIndex]=t[e],t[this._sceneRootNodesIndex]._sceneRootNodesIndex=this._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._sceneRootNodesIndex=-1}},Object.defineProperty(t.prototype,"animationPropertiesOverride",{get:function(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride},set:function(t){this._animationPropertiesOverride=t},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"Node"},Object.defineProperty(t.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._scene.getEngine()},t.prototype.addBehavior=function(t,e){var i=this;return void 0===e&&(e=!1),-1!==this._behaviors.indexOf(t)||(t.init(),this._scene.isLoading&&!e?this._scene.onDataLoadedObservable.addOnce((function(){t.attach(i)})):t.attach(this),this._behaviors.push(t)),this},t.prototype.removeBehavior=function(t){var e=this._behaviors.indexOf(t);return-1===e||(this._behaviors[e].detach(),this._behaviors.splice(e,1)),this},Object.defineProperty(t.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!1,configurable:!0}),t.prototype.getBehaviorByName=function(t){for(var e=0,i=this._behaviors;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},t.prototype.getWorldMatrix=function(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix},t.prototype._getWorldMatrixDeterminant=function(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant},Object.defineProperty(t.prototype,"worldMatrixFromCache",{get:function(){return this._worldMatrix},enumerable:!1,configurable:!0}),t.prototype._initCache=function(){this._cache={},this._cache.parent=void 0},t.prototype.updateCache=function(t){!t&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())},t.prototype._getActionManagerForTrigger=function(t,e){return void 0===e&&(e=!0),this.parent?this.parent._getActionManagerForTrigger(t,!1):null},t.prototype._updateCache=function(t){},t.prototype._isSynchronized=function(){return!0},t.prototype._markSyncedWithParent=function(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)},t.prototype.isSynchronizedWithParent=function(){return!this._parentNode||this._parentUpdateId===this._parentNode._childUpdateId&&this._parentNode.isSynchronized()},t.prototype.isSynchronized=function(){return this._cache.parent!=this._parentNode?(this._cache.parent=this._parentNode,!1):!(this._parentNode&&!this.isSynchronizedWithParent())&&this._isSynchronized()},t.prototype.isReady=function(t){return void 0===t&&(t=!1),this._isReady},t.prototype.isEnabled=function(t){return void 0===t&&(t=!0),!1===t?this._isEnabled:!!this._isEnabled&&this._isParentEnabled},t.prototype._syncParentEnabledState=function(){this._isParentEnabled=!this._parentNode||this._parentNode.isEnabled(),this._children&&this._children.forEach((function(t){t._syncParentEnabledState()}))},t.prototype.setEnabled=function(t){this._isEnabled=t,this._syncParentEnabledState()},t.prototype.isDescendantOf=function(t){return!!this.parent&&(this.parent===t||this.parent.isDescendantOf(t))},t.prototype._getDescendants=function(t,e,i){if(void 0===e&&(e=!1),this._children)for(var r=0;r<this._children.length;r++){var n=this._children[r];i&&!i(n)||t.push(n),e||n._getDescendants(t,!1,i)}},t.prototype.getDescendants=function(t,e){var i=new Array;return this._getDescendants(i,t,e),i},t.prototype.getChildMeshes=function(t,e){var i=[];return this._getDescendants(i,t,(function(t){return(!e||e(t))&&void 0!==t.cullingStrategy})),i},t.prototype.getChildren=function(t,e){return void 0===e&&(e=!0),this.getDescendants(e,t)},t.prototype._setReady=function(t){t!==this._isReady&&(t?(this.onReady&&this.onReady(this),this._isReady=!0):this._isReady=!1)},t.prototype.getAnimationByName=function(t){for(var e=0;e<this.animations.length;e++){var i=this.animations[e];if(i.name===t)return i}return null},t.prototype.createAnimationRange=function(e,i,r){if(!this._ranges[e]){this._ranges[e]=t._AnimationRangeFactory(e,i,r);for(var n=0,o=this.animations.length;n<o;n++)this.animations[n]&&this.animations[n].createRange(e,i,r)}},t.prototype.deleteAnimationRange=function(t,e){void 0===e&&(e=!0);for(var i=0,r=this.animations.length;i<r;i++)this.animations[i]&&this.animations[i].deleteRange(t,e);this._ranges[t]=null},t.prototype.getAnimationRange=function(t){return this._ranges[t]||null},t.prototype.getAnimationRanges=function(){var t,e=[];for(t in this._ranges)e.push(this._ranges[t]);return e},t.prototype.beginAnimation=function(t,e,i,r){var n=this.getAnimationRange(t);return n?this._scene.beginAnimation(this,n.from,n.to,e,i,r):null},t.prototype.serializeAnimationRanges=function(){var t=[];for(var e in this._ranges){var i=this._ranges[e];if(i){var r={};r.name=e,r.from=i.from,r.to=i.to,t.push(r)}}return t},t.prototype.computeWorldMatrix=function(t){return this._worldMatrix||(this._worldMatrix=n.a.Identity()),this._worldMatrix},t.prototype.dispose=function(t,e){if(void 0===e&&(e=!1),this._isDisposed=!0,!t)for(var i=0,r=this.getDescendants(!0);i<r.length;i++){r[i].dispose(t,e)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear();for(var n=0,o=this._behaviors;n<o.length;n++){o[n].detach()}this._behaviors=[]},t.ParseAnimationRanges=function(t,e,i){if(e.ranges)for(var r=0;r<e.ranges.length;r++){var n=e.ranges[r];t.createAnimationRange(n.name,n.from,n.to)}},t.prototype.getHierarchyBoundingVectors=function(t,e){var i,r;void 0===t&&(t=!0),void 0===e&&(e=null),this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);if(this.getBoundingInfo&&this.subMeshes){var o=this.getBoundingInfo();i=o.boundingBox.minimumWorld.clone(),r=o.boundingBox.maximumWorld.clone()}else i=new n.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new n.e(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(t)for(var s=0,a=this.getDescendants(!1);s<a.length;s++){var h=a[s];if(h.computeWorldMatrix(!0),(!e||e(h))&&h.getBoundingInfo&&0!==h.getTotalVertices()){var c=h.getBoundingInfo().boundingBox,u=c.minimumWorld,l=c.maximumWorld;n.e.CheckExtends(u,i,r),n.e.CheckExtends(l,i,r)}}return{min:i,max:r}},t._AnimationRangeFactory=function(t,e,i){throw h.a.WarnImport("AnimationRange")},t._NodeConstructors={},Object(r.c)([Object(o.c)()],t.prototype,"name",void 0),Object(r.c)([Object(o.c)()],t.prototype,"id",void 0),Object(r.c)([Object(o.c)()],t.prototype,"uniqueId",void 0),Object(r.c)([Object(o.c)()],t.prototype,"state",void 0),Object(r.c)([Object(o.c)()],t.prototype,"metadata",void 0),t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var r=i(3),n=function(){function t(){}return t.NAME_EFFECTLAYER="EffectLayer",t.NAME_LAYER="Layer",t.NAME_LENSFLARESYSTEM="LensFlareSystem",t.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer",t.NAME_PARTICLESYSTEM="ParticleSystem",t.NAME_GAMEPAD="Gamepad",t.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue",t.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer",t.NAME_PREPASSRENDERER="PrePassRenderer",t.NAME_DEPTHRENDERER="DepthRenderer",t.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager",t.NAME_SPRITE="Sprite",t.NAME_SUBSURFACE="SubSurface",t.NAME_OUTLINERENDERER="Outline",t.NAME_PROCEDURALTEXTURE="ProceduralTexture",t.NAME_SHADOWGENERATOR="ShadowGenerator",t.NAME_OCTREE="Octree",t.NAME_PHYSICSENGINE="PhysicsEngine",t.NAME_AUDIO="Audio",t.STEP_ISREADYFORMESH_EFFECTLAYER=0,t.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0,t.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0,t.STEP_ACTIVEMESH_BOUNDINGBOXRENDERER=0,t.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1,t.STEP_BEFORECAMERADRAW_EFFECTLAYER=0,t.STEP_BEFORECAMERADRAW_LAYER=1,t.STEP_BEFORECAMERADRAW_PREPASS=2,t.STEP_BEFORERENDERTARGETDRAW_LAYER=0,t.STEP_BEFORERENDERINGMESH_OUTLINE=0,t.STEP_AFTERRENDERINGMESH_OUTLINE=0,t.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0,t.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1,t.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0,t.STEP_BEFORECAMERAUPDATE_GAMEPAD=1,t.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0,t.STEP_AFTERRENDERTARGETDRAW_LAYER=0,t.STEP_AFTERCAMERADRAW_EFFECTLAYER=0,t.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=1,t.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=2,t.STEP_AFTERCAMERADRAW_LAYER=3,t.STEP_AFTERCAMERADRAW_PREPASS=4,t.STEP_AFTERRENDER_AUDIO=0,t.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0,t.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1,t.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2,t.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3,t.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0,t.STEP_BEFORECLEARSTAGE_PREPASS=0,t.STEP_POINTERMOVE_SPRITE=0,t.STEP_POINTERDOWN_SPRITE=0,t.STEP_POINTERUP_SPRITE=0,t}(),o=function(t){function e(e){return t.apply(this,e)||this}return Object(r.d)(e,t),e.Create=function(){return Object.create(e.prototype)},e.prototype.registerStep=function(t,e,i){var r=0;for(Number.MAX_VALUE;r<this.length;r++){if(t<this[r].index)break}this.splice(r,0,{index:t,component:e,action:i.bind(e)})},e.prototype.clear=function(){this.length=0},e}(Array)},function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var r=i(3),n=i(37),o=i(41),s=i(0),a=i(6),h=i(90),c=i(122),u=i(1),l=i(89),f=function(){function t(e,i,r){this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new s.a,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this._effect=null,this._useUBO=!1,this._fillMode=t.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._forceAlphaTest=!1,this._transparencyMode=null,this.name=e,this.id=e||o.b.RandomId(),this._scene=i||a.a.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._scene.useRightHandedSystem?this.sideOrientation=t.ClockWiseSideOrientation:this.sideOrientation=t.CounterClockWiseSideOrientation,this._uniformBuffer=new c.a(this._scene.getEngine()),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,r||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={})}return Object.defineProperty(t.prototype,"canRenderToMRT",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!==e&&(this._alpha=e,this.markAsDirty(t.MiscDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backFaceCulling",{get:function(){return this._backFaceCulling},set:function(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,this.markAsDirty(t.TextureDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRenderTargetTextures",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new s.a),this._onBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBind",{set:function(t){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUnBindObservable",{get:function(){return this._onUnBindObservable||(this._onUnBindObservable=new s.a),this._onUnBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onEffectCreatedObservable",{get:function(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new s.a),this._onEffectCreatedObservable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaMode",{get:function(){return this._alphaMode},set:function(e){this._alphaMode!==e&&(this._alphaMode=e,this.markAsDirty(t.TextureDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needDepthPrePass",{get:function(){return this._needDepthPrePass},set:function(t){this._needDepthPrePass!==t&&(this._needDepthPrePass=t,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fogEnabled",{get:function(){return this._fogEnabled},set:function(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAsDirty(t.MiscDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wireframe",{get:function(){switch(this._fillMode){case t.WireFrameFillMode:case t.LineListDrawMode:case t.LineLoopDrawMode:case t.LineStripDrawMode:return!0}return this._scene.forceWireframe},set:function(e){this.fillMode=e?t.WireFrameFillMode:t.TriangleFillMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointsCloud",{get:function(){switch(this._fillMode){case t.PointFillMode:case t.PointListDrawMode:return!0}return this._scene.forcePointsCloud},set:function(e){this.fillMode=e?t.PointFillMode:t.TriangleFillMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillMode",{get:function(){return this._fillMode},set:function(e){this._fillMode!==e&&(this._fillMode=e,this.markAsDirty(t.MiscDirtyFlag))},enumerable:!1,configurable:!0}),t.prototype.toString=function(t){return"Name: "+this.name},t.prototype.getClassName=function(){return"Material"},Object.defineProperty(t.prototype,"isFrozen",{get:function(){return this.checkReadyOnlyOnce},enumerable:!1,configurable:!0}),t.prototype.freeze=function(){this.markDirty(),this.checkReadyOnlyOnce=!0},t.prototype.unfreeze=function(){this.markDirty(),this.checkReadyOnlyOnce=!1},t.prototype.isReady=function(t,e){return!0},t.prototype.isReadyForSubMesh=function(t,e,i){return!1},t.prototype.getEffect=function(){return this._effect},t.prototype.getScene=function(){return this._scene},Object.defineProperty(t.prototype,"transparencyMode",{get:function(){return this._transparencyMode},set:function(e){this._transparencyMode!==e&&(this._transparencyMode=e,this._forceAlphaTest=e===t.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_disableAlphaBlending",{get:function(){return this._transparencyMode===t.MATERIAL_OPAQUE||this._transparencyMode===t.MATERIAL_ALPHATEST},enumerable:!1,configurable:!0}),t.prototype.needAlphaBlending=function(){return!this._disableAlphaBlending&&this.alpha<1},t.prototype.needAlphaBlendingForMesh=function(t){return!(this._disableAlphaBlending&&t.visibility>=1)&&(this.needAlphaBlending()||t.visibility<1||t.hasVertexAlpha)},t.prototype.needAlphaTesting=function(){return!!this._forceAlphaTest},t.prototype._shouldTurnAlphaTestOn=function(t){return!this.needAlphaBlendingForMesh(t)&&this.needAlphaTesting()},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.markDirty=function(){for(var t=0,e=this.getScene().meshes;t<e.length;t++){var i=e[t];if(i.subMeshes)for(var r=0,n=i.subMeshes;r<n.length;r++){var o=n[r];o.getMaterial()===this&&(o.effect&&(o.effect._wasPreviouslyReady=!1))}}},t.prototype._preBind=function(e,i){void 0===i&&(i=null);var r=this._scene.getEngine(),n=(null==i?this.sideOrientation:i)===t.ClockWiseSideOrientation;return r.enableEffect(e||this._effect),r.setState(this.backFaceCulling,this.zOffset,!1,n),n},t.prototype.bind=function(t,e){},t.prototype.bindForSubMesh=function(t,e,i){},t.prototype.bindOnlyWorldMatrix=function(t){},t.prototype.bindSceneUniformBuffer=function(t,e){e.bindToEffect(t,"Scene")},t.prototype.bindView=function(t){this._useUBO?this.bindSceneUniformBuffer(t,this.getScene().getSceneUniformBuffer()):t.setMatrix("view",this.getScene().getViewMatrix())},t.prototype.bindViewProjection=function(t){this._useUBO?this.bindSceneUniformBuffer(t,this.getScene().getSceneUniformBuffer()):t.setMatrix("viewProjection",this.getScene().getTransformMatrix())},t.prototype._afterBind=function(t){if(this._scene._cachedMaterial=this,this._scene._cachedVisibility=t?t.visibility:1,this._onBindObservable&&t&&this._onBindObservable.notifyObservers(t),this.disableDepthWrite){var e=this._scene.getEngine();this._cachedDepthWriteState=e.getDepthWrite(),e.setDepthWrite(!1)}if(this.disableColorWrite){e=this._scene.getEngine();this._cachedColorWriteState=e.getColorWrite(),e.setColorWrite(!1)}if(0!==this.depthFunction){e=this._scene.getEngine();this._cachedDepthFunctionState=e.getDepthFunction()||0,e.setDepthFunction(this.depthFunction)}},t.prototype.unbind=function(){(this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction)&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState);this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState);this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)},t.prototype.getActiveTextures=function(){return[]},t.prototype.hasTexture=function(t){return!1},t.prototype.clone=function(t){return null},t.prototype.getBindedMeshes=function(){var t=this;if(this.meshMap){var e=new Array;for(var i in this.meshMap){var r=this.meshMap[i];r&&e.push(r)}return e}return this._scene.meshes.filter((function(e){return e.material===t}))},t.prototype.forceCompilation=function(t,e,i,n){var o=this,s=Object(r.a)({clipPlane:!1,useInstances:!1},i),a=this.getScene(),c=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;var u=function(){if(o._scene&&o._scene.getEngine()){var i=a.clipPlane;if(s.clipPlane&&(a.clipPlane=new l.a(0,0,0,1)),o._storeEffectOnSubMeshes){var r=!0,f=null;if(t.subMeshes){var d=new h.a(0,0,0,0,0,t,void 0,!1,!1);d._materialDefines&&(d._materialDefines._renderId=-1),o.isReadyForSubMesh(t,d,s.useInstances)||(d.effect&&d.effect.getCompilationError()&&d.effect.allFallbacksProcessed()?f=d.effect.getCompilationError():(r=!1,setTimeout(u,16)))}r&&(o.allowShaderHotSwapping=c,f&&n&&n(f),e&&e(o))}else o.isReady()?(o.allowShaderHotSwapping=c,e&&e(o)):setTimeout(u,16);s.clipPlane&&(a.clipPlane=i)}};u()},t.prototype.forceCompilationAsync=function(t,e){var i=this;return new Promise((function(r,n){i.forceCompilation(t,(function(){r()}),e,(function(t){n(t)}))}))},t.prototype.markAsDirty=function(e){this.getScene().blockMaterialDirtyMechanism||(t._DirtyCallbackArray.length=0,e&t.TextureDirtyFlag&&t._DirtyCallbackArray.push(t._TextureDirtyCallBack),e&t.LightDirtyFlag&&t._DirtyCallbackArray.push(t._LightsDirtyCallBack),e&t.FresnelDirtyFlag&&t._DirtyCallbackArray.push(t._FresnelDirtyCallBack),e&t.AttributesDirtyFlag&&t._DirtyCallbackArray.push(t._AttributeDirtyCallBack),e&t.MiscDirtyFlag&&t._DirtyCallbackArray.push(t._MiscDirtyCallBack),t._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(t._RunDirtyCallBacks),this.getScene().resetCachedMaterial())},t.prototype._markAllSubMeshesAsDirty=function(t){if(!this.getScene().blockMaterialDirtyMechanism)for(var e=0,i=this.getScene().meshes;e<i.length;e++){var r=i[e];if(r.subMeshes)for(var n=0,o=r.subMeshes;n<o.length;n++){var s=o[n];s.getMaterial()===this&&(s._materialDefines&&t(s._materialDefines))}}},t.prototype._markScenePrePassDirty=function(){if(!this.getScene().blockMaterialDirtyMechanism){var t=this.getScene().enablePrePassRenderer();t&&t.markAsDirty()}},t.prototype._markAllSubMeshesAsAllDirty=function(){this._markAllSubMeshesAsDirty(t._AllDirtyCallBack)},t.prototype._markAllSubMeshesAsImageProcessingDirty=function(){this._markAllSubMeshesAsDirty(t._ImageProcessingDirtyCallBack)},t.prototype._markAllSubMeshesAsTexturesDirty=function(){this._markAllSubMeshesAsDirty(t._TextureDirtyCallBack)},t.prototype._markAllSubMeshesAsFresnelDirty=function(){this._markAllSubMeshesAsDirty(t._FresnelDirtyCallBack)},t.prototype._markAllSubMeshesAsFresnelAndMiscDirty=function(){this._markAllSubMeshesAsDirty(t._FresnelAndMiscDirtyCallBack)},t.prototype._markAllSubMeshesAsLightsDirty=function(){this._markAllSubMeshesAsDirty(t._LightsDirtyCallBack)},t.prototype._markAllSubMeshesAsAttributesDirty=function(){this._markAllSubMeshesAsDirty(t._AttributeDirtyCallBack)},t.prototype._markAllSubMeshesAsMiscDirty=function(){this._markAllSubMeshesAsDirty(t._MiscDirtyCallBack)},t.prototype._markAllSubMeshesAsTexturesAndMiscDirty=function(){this._markAllSubMeshesAsDirty(t._TextureAndMiscDirtyCallBack)},t.prototype.setPrePassRenderer=function(t){return!1},t.prototype.dispose=function(t,e,i){var r=this.getScene();if(r.stopAnimation(this),r.freeProcessedMaterials(),r.removeMaterial(this),!0!==i)if(this.meshMap)for(var n in this.meshMap){(a=this.meshMap[n])&&(a.material=null,this.releaseVertexArrayObject(a,t))}else for(var o=0,s=r.meshes;o<s.length;o++){var a;(a=s[o]).material!==this||a.sourceMesh||(a.material=null,this.releaseVertexArrayObject(a,t))}this._uniformBuffer.dispose(),t&&this._effect&&(this._storeEffectOnSubMeshes||this._effect.dispose(),this._effect=null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear()},t.prototype.releaseVertexArrayObject=function(t,e){if(t.geometry){var i=t.geometry;if(this._storeEffectOnSubMeshes)for(var r=0,n=t.subMeshes;r<n.length;r++){var o=n[r];i._releaseVertexArrayObject(o._materialEffect),e&&o._materialEffect&&o._materialEffect.dispose()}else i._releaseVertexArrayObject(this._effect)}},t.prototype.serialize=function(){return n.a.Serialize(this)},t.Parse=function(t,e,i){if(t.customType){if("BABYLON.PBRMaterial"===t.customType&&t.overloadedAlbedo&&(t.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return u.a.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else t.customType="BABYLON.StandardMaterial";return o.b.Instantiate(t.customType).Parse(t,e,i)},t.TriangleFillMode=0,t.WireFrameFillMode=1,t.PointFillMode=2,t.PointListDrawMode=3,t.LineListDrawMode=4,t.LineLoopDrawMode=5,t.LineStripDrawMode=6,t.TriangleStripDrawMode=7,t.TriangleFanDrawMode=8,t.ClockWiseSideOrientation=0,t.CounterClockWiseSideOrientation=1,t.TextureDirtyFlag=1,t.LightDirtyFlag=2,t.FresnelDirtyFlag=4,t.AttributesDirtyFlag=8,t.MiscDirtyFlag=16,t.AllDirtyFlag=31,t.MATERIAL_OPAQUE=0,t.MATERIAL_ALPHATEST=1,t.MATERIAL_ALPHABLEND=2,t.MATERIAL_ALPHATESTANDBLEND=3,t.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,t.MATERIAL_NORMALBLENDMETHOD_RNM=1,t._AllDirtyCallBack=function(t){return t.markAllAsDirty()},t._ImageProcessingDirtyCallBack=function(t){return t.markAsImageProcessingDirty()},t._TextureDirtyCallBack=function(t){return t.markAsTexturesDirty()},t._FresnelDirtyCallBack=function(t){return t.markAsFresnelDirty()},t._MiscDirtyCallBack=function(t){return t.markAsMiscDirty()},t._LightsDirtyCallBack=function(t){return t.markAsLightDirty()},t._AttributeDirtyCallBack=function(t){return t.markAsAttributesDirty()},t._FresnelAndMiscDirtyCallBack=function(e){t._FresnelDirtyCallBack(e),t._MiscDirtyCallBack(e)},t._TextureAndMiscDirtyCallBack=function(e){t._TextureDirtyCallBack(e),t._MiscDirtyCallBack(e)},t._DirtyCallbackArray=[],t._RunDirtyCallBacks=function(e){for(var i=0,r=t._DirtyCallbackArray;i<r.length;i++){(0,r[i])(e)}},Object(r.c)([Object(n.c)()],t.prototype,"id",void 0),Object(r.c)([Object(n.c)()],t.prototype,"uniqueId",void 0),Object(r.c)([Object(n.c)()],t.prototype,"name",void 0),Object(r.c)([Object(n.c)()],t.prototype,"checkReadyOnEveryCall",void 0),Object(r.c)([Object(n.c)()],t.prototype,"checkReadyOnlyOnce",void 0),Object(r.c)([Object(n.c)()],t.prototype,"state",void 0),Object(r.c)([Object(n.c)("alpha")],t.prototype,"_alpha",void 0),Object(r.c)([Object(n.c)("backFaceCulling")],t.prototype,"_backFaceCulling",void 0),Object(r.c)([Object(n.c)()],t.prototype,"sideOrientation",void 0),Object(r.c)([Object(n.c)("alphaMode")],t.prototype,"_alphaMode",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_needDepthPrePass",void 0),Object(r.c)([Object(n.c)()],t.prototype,"disableDepthWrite",void 0),Object(r.c)([Object(n.c)()],t.prototype,"disableColorWrite",void 0),Object(r.c)([Object(n.c)()],t.prototype,"forceDepthWrite",void 0),Object(r.c)([Object(n.c)()],t.prototype,"depthFunction",void 0),Object(r.c)([Object(n.c)()],t.prototype,"separateCullingPass",void 0),Object(r.c)([Object(n.c)("fogEnabled")],t.prototype,"_fogEnabled",void 0),Object(r.c)([Object(n.c)()],t.prototype,"pointSize",void 0),Object(r.c)([Object(n.c)()],t.prototype,"zOffset",void 0),Object(r.c)([Object(n.c)()],t.prototype,"pointsCloud",null),Object(r.c)([Object(n.c)()],t.prototype,"fillMode",null),Object(r.c)([Object(n.c)()],t.prototype,"transparencyMode",null),t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return O}));var r=i(3),n=i(41),o=i(0),s=i(34),a=i(14),h=i(40),c=i(43),u=i(69),l=i(97),f=i(63),d=i(199),p=i(5),_=i(200),g=i(36),m=i(60),y=i(55),b=i(35),v=function(){this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=s.e.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1},M=function(){this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new v,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1},O=function(t){function e(i,r){void 0===r&&(r=null);var n=t.call(this,i,r,!1)||this;return n._internalAbstractMeshDataInfo=new M,n.cullingStrategy=e.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,n.onCollideObservable=new o.a,n.onCollisionPositionChangeObservable=new o.a,n.onMaterialChangedObservable=new o.a,n.definedFacingForward=!0,n._occlusionQuery=null,n._renderingGroup=null,n.alphaIndex=Number.MAX_VALUE,n.isVisible=!0,n.isPickable=!0,n.showSubMeshesBoundingBox=!1,n.isBlocker=!1,n.enablePointerMoveEvents=!1,n._renderingGroupId=0,n._material=null,n.outlineColor=g.a.Red(),n.outlineWidth=.02,n.overlayColor=g.a.Red(),n.overlayAlpha=.5,n.useOctreeForRenderingSelection=!0,n.useOctreeForPicking=!0,n.useOctreeForCollisions=!0,n.alwaysSelectAsActiveMesh=!1,n.doNotSyncBoundingInfo=!1,n.actionManager=null,n._meshCollisionData=new d.a,n.ellipsoid=new s.e(.5,1,.5),n.ellipsoidOffset=new s.e(0,0,0),n.edgesWidth=1,n.edgesColor=new g.b(1,0,0,1),n._edgesRenderer=null,n._masterMesh=null,n._boundingInfo=null,n._renderId=0,n._intersectionsInProgress=new Array,n._unIndexed=!1,n._lightSources=new Array,n._waitingData={lods:null,actions:null,freezeWorldMatrix:null},n._bonesTransformMatrices=null,n._transformMatrixTexture=null,n.onRebuildObservable=new o.a,n._onCollisionPositionChange=function(t,e,i){void 0===i&&(i=null),e.subtractToRef(n._meshCollisionData._oldPositionForCollisions,n._meshCollisionData._diffPositionForCollisions),n._meshCollisionData._diffPositionForCollisions.length()>a.a.CollisionsEpsilon&&n.position.addInPlace(n._meshCollisionData._diffPositionForCollisions),i&&n.onCollideObservable.notifyObservers(i),n.onCollisionPositionChangeObservable.notifyObservers(n.position)},n.getScene().addMesh(n),n._resyncLightSources(),n}return Object(r.d)(e,t),Object.defineProperty(e,"BILLBOARDMODE_NONE",{get:function(){return u.a.BILLBOARDMODE_NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_X",{get:function(){return u.a.BILLBOARDMODE_X},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_Y",{get:function(){return u.a.BILLBOARDMODE_Y},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_Z",{get:function(){return u.a.BILLBOARDMODE_Z},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_ALL",{get:function(){return u.a.BILLBOARDMODE_ALL},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_USE_POSITION",{get:function(){return u.a.BILLBOARDMODE_USE_POSITION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"facetNb",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetNb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partitioningSubdivisions",{get:function(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions},set:function(t){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partitioningBBoxRatio",{get:function(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio},set:function(t){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustDepthSortFacets",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort},set:function(t){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"facetDepthSortFrom",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom},set:function(t){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFacetDataEnabled",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled},enumerable:!1,configurable:!0}),e.prototype._updateNonUniformScalingState=function(e){return!!t.prototype._updateNonUniformScalingState.call(this,e)&&(this._markSubMeshesAsMiscDirty(),!0)},Object.defineProperty(e.prototype,"onCollide",{set:function(t){this._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._meshCollisionData._onCollideObserver),this._meshCollisionData._onCollideObserver=this.onCollideObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCollisionPositionChange",{set:function(t){this._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._meshCollisionData._onCollisionPositionChangeObserver),this._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibility",{get:function(){return this._internalAbstractMeshDataInfo._visibility},set:function(t){this._internalAbstractMeshDataInfo._visibility!==t&&(this._internalAbstractMeshDataInfo._visibility=t,this._markSubMeshesAsMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderingGroupId",{get:function(){return this._renderingGroupId},set:function(t){this._renderingGroupId=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){this._material!==t&&(this._material&&this._material.meshMap&&(this._material.meshMap[this.uniqueId]=void 0),this._material=t,t&&t.meshMap&&(t.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&this._unBindEffect())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"receiveShadows",{get:function(){return this._internalAbstractMeshDataInfo._receiveShadows},set:function(t){this._internalAbstractMeshDataInfo._receiveShadows!==t&&(this._internalAbstractMeshDataInfo._receiveShadows=t,this._markSubMeshesAsLightDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasVertexAlpha",{get:function(){return this._internalAbstractMeshDataInfo._hasVertexAlpha},set:function(t){this._internalAbstractMeshDataInfo._hasVertexAlpha!==t&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=t,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useVertexColors",{get:function(){return this._internalAbstractMeshDataInfo._useVertexColors},set:function(t){this._internalAbstractMeshDataInfo._useVertexColors!==t&&(this._internalAbstractMeshDataInfo._useVertexColors=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"computeBonesUsingShaders",{get:function(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders},set:function(t){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==t&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numBoneInfluencers",{get:function(){return this._internalAbstractMeshDataInfo._numBoneInfluencers},set:function(t){this._internalAbstractMeshDataInfo._numBoneInfluencers!==t&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applyFog",{get:function(){return this._internalAbstractMeshDataInfo._applyFog},set:function(t){this._internalAbstractMeshDataInfo._applyFog!==t&&(this._internalAbstractMeshDataInfo._applyFog=t,this._markSubMeshesAsMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerMask",{get:function(){return this._internalAbstractMeshDataInfo._layerMask},set:function(t){t!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=t,this._resyncLightSources())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionMask",{get:function(){return this._meshCollisionData._collisionMask},set:function(t){this._meshCollisionData._collisionMask=isNaN(t)?-1:t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionResponse",{get:function(){return this._meshCollisionData._collisionResponse},set:function(t){this._meshCollisionData._collisionResponse=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionGroup",{get:function(){return this._meshCollisionData._collisionGroup},set:function(t){this._meshCollisionData._collisionGroup=isNaN(t)?-1:t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"surroundingMeshes",{get:function(){return this._meshCollisionData._surroundingMeshes},set:function(t){this._meshCollisionData._surroundingMeshes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightSources",{get:function(){return this._lightSources},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_positions",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this._internalAbstractMeshDataInfo._skeleton},set:function(t){var e=this._internalAbstractMeshDataInfo._skeleton;e&&e.needInitialSkinMatrix&&e._unregisterMeshWithPoseMatrix(this),t&&t.needInitialSkinMatrix&&t._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=t,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"AbstractMesh"},e.prototype.toString=function(t){var e="Name: "+this.name+", isInstance: "+("InstancedMesh"!==this.getClassName()?"YES":"NO");e+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);var i=this._internalAbstractMeshDataInfo._skeleton;return i&&(e+=", skeleton: "+i.name),t&&(e+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],e+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),e},e.prototype._getEffectiveParent=function(){return this._masterMesh&&this.billboardMode!==u.a.BILLBOARDMODE_NONE?this._masterMesh:t.prototype._getEffectiveParent.call(this)},e.prototype._getActionManagerForTrigger=function(t,e){if(void 0===e&&(e=!0),this.actionManager&&(e||this.actionManager.isRecursive)){if(!t)return this.actionManager;if(this.actionManager.hasSpecificTrigger(t))return this.actionManager}return this.parent?this.parent._getActionManagerForTrigger(t,!1):null},e.prototype._rebuild=function(){if(this.onRebuildObservable.notifyObservers(this),this._occlusionQuery&&(this._occlusionQuery=null),this.subMeshes)for(var t=0,e=this.subMeshes;t<e.length;t++){e[t]._rebuild()}},e.prototype._resyncLightSources=function(){this._lightSources.length=0;for(var t=0,e=this.getScene().lights;t<e.length;t++){var i=e[t];i.isEnabled()&&(i.canAffectMesh(this)&&this._lightSources.push(i))}this._markSubMeshesAsLightDirty()},e.prototype._resyncLightSource=function(t){var e=t.isEnabled()&&t.canAffectMesh(this),i=this._lightSources.indexOf(t),r=!1;if(-1===i){if(!e)return;this._lightSources.push(t)}else{if(e)return;r=!0,this._lightSources.splice(i,1)}this._markSubMeshesAsLightDirty(r)},e.prototype._unBindEffect=function(){for(var t=0,e=this.subMeshes;t<e.length;t++){e[t].setEffect(null)}},e.prototype._removeLightSource=function(t,e){var i=this._lightSources.indexOf(t);-1!==i&&(this._lightSources.splice(i,1),this._markSubMeshesAsLightDirty(e))},e.prototype._markSubMeshesAsDirty=function(t){if(this.subMeshes)for(var e=0,i=this.subMeshes;e<i.length;e++){var r=i[e];r._materialDefines&&t(r._materialDefines)}},e.prototype._markSubMeshesAsLightDirty=function(t){void 0===t&&(t=!1),this._markSubMeshesAsDirty((function(e){return e.markAsLightDirty(t)}))},e.prototype._markSubMeshesAsAttributesDirty=function(){this._markSubMeshesAsDirty((function(t){return t.markAsAttributesDirty()}))},e.prototype._markSubMeshesAsMiscDirty=function(){this._markSubMeshesAsDirty((function(t){return t.markAsMiscDirty()}))},Object.defineProperty(e.prototype,"scaling",{get:function(){return this._scaling},set:function(t){this._scaling=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlocked",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getLOD=function(t){return this},e.prototype.getTotalVertices=function(){return 0},e.prototype.getTotalIndices=function(){return 0},e.prototype.getIndices=function(){return null},e.prototype.getVerticesData=function(t){return null},e.prototype.setVerticesData=function(t,e,i,r){return this},e.prototype.updateVerticesData=function(t,e,i,r){return this},e.prototype.setIndices=function(t,e){return this},e.prototype.isVerticesDataPresent=function(t){return!1},e.prototype.getBoundingInfo=function(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfo||this._updateBoundingInfo(),this._boundingInfo)},e.prototype.normalizeToUnitCube=function(e,i,r){return void 0===e&&(e=!0),void 0===i&&(i=!1),t.prototype.normalizeToUnitCube.call(this,e,i,r)},e.prototype.setBoundingInfo=function(t){return this._boundingInfo=t,this},Object.defineProperty(e.prototype,"useBones",{get:function(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(h.b.MatricesIndicesKind)&&this.isVerticesDataPresent(h.b.MatricesWeightsKind)},enumerable:!1,configurable:!0}),e.prototype._preActivate=function(){},e.prototype._preActivateForIntermediateRendering=function(t){},e.prototype._activate=function(t,e){return this._renderId=t,!0},e.prototype._postActivate=function(){},e.prototype._freeze=function(){},e.prototype._unFreeze=function(){},e.prototype.getWorldMatrix=function(){return this._masterMesh&&this.billboardMode===u.a.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():t.prototype.getWorldMatrix.call(this)},e.prototype._getWorldMatrixDeterminant=function(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():t.prototype._getWorldMatrixDeterminant.call(this)},Object.defineProperty(e.prototype,"isAnInstance",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasInstances",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasThinInstances",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.movePOV=function(t,e,i){return this.position.addInPlace(this.calcMovePOV(t,e,i)),this},e.prototype.calcMovePOV=function(t,e,i){var r=new s.a;(this.rotationQuaternion?this.rotationQuaternion:s.b.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(r);var n=s.e.Zero(),o=this.definedFacingForward?-1:1;return s.e.TransformCoordinatesFromFloatsToRef(t*o,e,i*o,r,n),n},e.prototype.rotatePOV=function(t,e,i){return this.rotation.addInPlace(this.calcRotatePOV(t,e,i)),this},e.prototype.calcRotatePOV=function(t,e,i){var r=this.definedFacingForward?1:-1;return new s.e(t*r,e,i*r)},e.prototype.refreshBoundingInfo=function(t){return void 0===t&&(t=!1),this._boundingInfo&&this._boundingInfo.isLocked||this._refreshBoundingInfo(this._getPositionData(t),null),this},e.prototype._refreshBoundingInfo=function(t,e){if(t){var i=Object(_.a)(t,0,this.getTotalVertices(),e);this._boundingInfo?this._boundingInfo.reConstruct(i.minimum,i.maximum):this._boundingInfo=new f.a(i.minimum,i.maximum)}if(this.subMeshes)for(var r=0;r<this.subMeshes.length;r++)this.subMeshes[r].refreshBoundingInfo(t);this._updateBoundingInfo()},e.prototype._getPositionData=function(t){var e=this.getVerticesData(h.b.PositionKind);if(e&&t&&this.skeleton){e=n.b.Slice(e),this._generatePointsArray();var i=this.getVerticesData(h.b.MatricesIndicesKind),r=this.getVerticesData(h.b.MatricesWeightsKind);if(r&&i){var o=this.numBoneInfluencers>4,a=o?this.getVerticesData(h.b.MatricesIndicesExtraKind):null,c=o?this.getVerticesData(h.b.MatricesWeightsExtraKind):null;this.skeleton.prepare();for(var u=this.skeleton.getTransformMatrices(this),l=s.c.Vector3[0],f=s.c.Matrix[0],d=s.c.Matrix[1],p=0,_=0;_<e.length;_+=3,p+=4){var g,m;for(f.reset(),g=0;g<4;g++)(m=r[p+g])>0&&(s.a.FromFloat32ArrayToRefScaled(u,Math.floor(16*i[p+g]),m,d),f.addToSelf(d));if(o)for(g=0;g<4;g++)(m=c[p+g])>0&&(s.a.FromFloat32ArrayToRefScaled(u,Math.floor(16*a[p+g]),m,d),f.addToSelf(d));s.e.TransformCoordinatesFromFloatsToRef(e[_],e[_+1],e[_+2],f,l),l.toArray(e,_),this._positions&&this._positions[_/3].copyFrom(l)}}}return e},e.prototype._updateBoundingInfo=function(){var t=this._effectiveMesh;return this._boundingInfo?this._boundingInfo.update(t.worldMatrixFromCache):this._boundingInfo=new f.a(this.absolutePosition,this.absolutePosition,t.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(t.worldMatrixFromCache),this},e.prototype._updateSubMeshesBoundingInfo=function(t){if(!this.subMeshes)return this;for(var e=this.subMeshes.length,i=0;i<e;i++){var r=this.subMeshes[i];(e>1||!r.IsGlobal)&&r.updateBoundingInfo(t)}return this},e.prototype._afterComputeWorldMatrix=function(){this.doNotSyncBoundingInfo||this._updateBoundingInfo()},Object.defineProperty(e.prototype,"_effectiveMesh",{get:function(){return this.skeleton&&this.skeleton.overrideMesh||this},enumerable:!1,configurable:!0}),e.prototype.isInFrustum=function(t){return null!==this._boundingInfo&&this._boundingInfo.isInFrustum(t,this.cullingStrategy)},e.prototype.isCompletelyInFrustum=function(t){return null!==this._boundingInfo&&this._boundingInfo.isCompletelyInFrustum(t)},e.prototype.intersectsMesh=function(t,e,i){if(void 0===e&&(e=!1),!this._boundingInfo||!t._boundingInfo)return!1;if(this._boundingInfo.intersects(t._boundingInfo,e))return!0;if(i)for(var r=0,n=this.getChildMeshes();r<n.length;r++){if(n[r].intersectsMesh(t,e,!0))return!0}return!1},e.prototype.intersectsPoint=function(t){return!!this._boundingInfo&&this._boundingInfo.intersectsPoint(t)},Object.defineProperty(e.prototype,"checkCollisions",{get:function(){return this._meshCollisionData._checkCollisions},set:function(t){this._meshCollisionData._checkCollisions=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collider",{get:function(){return this._meshCollisionData._collider},enumerable:!1,configurable:!0}),e.prototype.moveWithCollisions=function(t){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._meshCollisionData._oldPositionForCollisions);var e=this.getScene().collisionCoordinator;return this._meshCollisionData._collider||(this._meshCollisionData._collider=e.createCollider()),this._meshCollisionData._collider._radius=this.ellipsoid,e.getNewPosition(this._meshCollisionData._oldPositionForCollisions,t,this._meshCollisionData._collider,3,this,this._onCollisionPositionChange,this.uniqueId),this},e.prototype._collideForSubMesh=function(t,e,i){if(this._generatePointsArray(),!this._positions)return this;if(!t._lastColliderWorldVertices||!t._lastColliderTransformMatrix.equals(e)){t._lastColliderTransformMatrix=e.clone(),t._lastColliderWorldVertices=[],t._trianglePlanes=[];for(var r=t.verticesStart,n=t.verticesStart+t.verticesCount,o=r;o<n;o++)t._lastColliderWorldVertices.push(s.e.TransformCoordinates(this._positions[o],e))}return i._collide(t._trianglePlanes,t._lastColliderWorldVertices,this.getIndices(),t.indexStart,t.indexStart+t.indexCount,t.verticesStart,!!t.getMaterial(),this),this},e.prototype._processCollisionsForSubMeshes=function(t,e){for(var i=this._scene.getCollidingSubMeshCandidates(this,t),r=i.length,n=0;n<r;n++){var o=i.data[n];r>1&&!o._checkCollision(t)||this._collideForSubMesh(o,e,t)}return this},e.prototype._checkCollision=function(t){if(!this._boundingInfo||!this._boundingInfo._checkCollision(t))return this;var e=s.c.Matrix[0],i=s.c.Matrix[1];return s.a.ScalingToRef(1/t._radius.x,1/t._radius.y,1/t._radius.z,e),this.worldMatrixFromCache.multiplyToRef(e,i),this._processCollisionsForSubMeshes(t,i),this},e.prototype._generatePointsArray=function(){return!1},e.prototype.intersects=function(t,e,i,r,n){void 0===r&&(r=!1);var o=new l.a,a="InstancedLinesMesh"===this.getClassName()||"LinesMesh"===this.getClassName()?this.intersectionThreshold:0,h=this._boundingInfo;if(!(this.subMeshes&&h&&t.intersectsSphere(h.boundingSphere,a)&&t.intersectsBox(h.boundingBox,a)))return o;if(r)return o.hit=!0,o.pickedMesh=this,o.distance=s.e.Distance(t.origin,h.boundingSphere.center),o.subMeshId=0,o;if(!this._generatePointsArray())return o;for(var c=null,u=this._scene.getIntersectingSubMeshCandidates(this,t),f=u.length,d=0;d<f;d++){var p=u.data[d];if(!(f>1)||p.canIntersects(t)){var _=p.intersects(t,this._positions,this.getIndices(),e,i);if(_&&(e||!c||_.distance<c.distance)&&((c=_).subMeshId=d,e))break}}if(c){var g=null!=n?n:this.skeleton&&this.skeleton.overrideMesh?this.skeleton.overrideMesh.getWorldMatrix():this.getWorldMatrix(),m=s.c.Vector3[0],y=s.c.Vector3[1];s.e.TransformCoordinatesToRef(t.origin,g,m),t.direction.scaleToRef(c.distance,y);var b=s.e.TransformNormal(y,g).addInPlace(m);return o.hit=!0,o.distance=s.e.Distance(m,b),o.pickedPoint=b,o.pickedMesh=this,o.bu=c.bu||0,o.bv=c.bv||0,o.subMeshFaceId=c.faceId,o.faceId=c.faceId+u.data[c.subMeshId].indexStart/(-1!==this.getClassName().indexOf("LinesMesh")?2:3),o.subMeshId=c.subMeshId,o}return o},e.prototype.clone=function(t,e,i){return null},e.prototype.releaseSubMeshes=function(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=new Array;return this},e.prototype.dispose=function(e,i){var r,n=this;for(void 0===i&&(i=!1),this._scene.useMaterialMeshMap&&this._material&&this._material.meshMap&&(this._material.meshMap[this.uniqueId]=void 0),this.getScene().freeActiveMeshes(),this.getScene().freeRenderingGroups(),void 0!==this.actionManager&&null!==this.actionManager&&(this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),r=0;r<this._intersectionsInProgress.length;r++){var o=this._intersectionsInProgress[r],s=o._intersectionsInProgress.indexOf(this);o._intersectionsInProgress.splice(s,1)}this._intersectionsInProgress=[],this.getScene().lights.forEach((function(t){var e=t.includedOnlyMeshes.indexOf(n);-1!==e&&t.includedOnlyMeshes.splice(e,1),-1!==(e=t.excludedMeshes.indexOf(n))&&t.excludedMeshes.splice(e,1);var i=t.getShadowGenerator();if(i){var r=i.getShadowMap();r&&r.renderList&&-1!==(e=r.renderList.indexOf(n))&&r.renderList.splice(e,1)}})),"InstancedMesh"===this.getClassName()&&"InstancedLinesMesh"===this.getClassName()||this.releaseSubMeshes();var a=this.getScene().getEngine();if(this._occlusionQuery&&(this.isOcclusionQueryInProgress=!1,a.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),a.wipeCaches(),this.getScene().removeMesh(this),i&&this.material&&("MultiMaterial"===this.material.getClassName()?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!e)for(r=0;r<this.getScene().particleSystems.length;r++)this.getScene().particleSystems[r].emitter===this&&(this.getScene().particleSystems[r].dispose(),r--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),t.prototype.dispose.call(this,e,i)},e.prototype.addChild=function(t){return t.setParent(this),this},e.prototype.removeChild=function(t){return t.setParent(null),this},e.prototype._initFacetData=function(){var t=this._internalAbstractMeshDataInfo._facetData;t.facetNormals||(t.facetNormals=new Array),t.facetPositions||(t.facetPositions=new Array),t.facetPartitioning||(t.facetPartitioning=new Array),t.facetNb=this.getIndices().length/3|0,t.partitioningSubdivisions=t.partitioningSubdivisions?t.partitioningSubdivisions:10,t.partitioningBBoxRatio=t.partitioningBBoxRatio?t.partitioningBBoxRatio:1.01;for(var e=0;e<t.facetNb;e++)t.facetNormals[e]=s.e.Zero(),t.facetPositions[e]=s.e.Zero();return t.facetDataEnabled=!0,this},e.prototype.updateFacetData=function(){var t=this._internalAbstractMeshDataInfo._facetData;t.facetDataEnabled||this._initFacetData();var e=this.getVerticesData(h.b.PositionKind),i=this.getIndices(),r=this.getVerticesData(h.b.NormalKind),n=this.getBoundingInfo();if(t.facetDepthSort&&!t.facetDepthSortEnabled){if(t.facetDepthSortEnabled=!0,i instanceof Uint16Array)t.depthSortedIndices=new Uint16Array(i);else if(i instanceof Uint32Array)t.depthSortedIndices=new Uint32Array(i);else{for(var o=!1,a=0;a<i.length;a++)if(i[a]>65535){o=!0;break}t.depthSortedIndices=o?new Uint32Array(i):new Uint16Array(i)}if(t.facetDepthSortFunction=function(t,e){return e.sqDistance-t.sqDistance},!t.facetDepthSortFrom){var u=this.getScene().activeCamera;t.facetDepthSortFrom=u?u.position:s.e.Zero()}t.depthSortedFacets=[];for(var l=0;l<t.facetNb;l++){var f={ind:3*l,sqDistance:0};t.depthSortedFacets.push(f)}t.invertedMatrix=s.a.Identity(),t.facetDepthSortOrigin=s.e.Zero()}t.bbSize.x=n.maximum.x-n.minimum.x>m.a?n.maximum.x-n.minimum.x:m.a,t.bbSize.y=n.maximum.y-n.minimum.y>m.a?n.maximum.y-n.minimum.y:m.a,t.bbSize.z=n.maximum.z-n.minimum.z>m.a?n.maximum.z-n.minimum.z:m.a;var d=t.bbSize.x>t.bbSize.y?t.bbSize.x:t.bbSize.y;if(d=d>t.bbSize.z?d:t.bbSize.z,t.subDiv.max=t.partitioningSubdivisions,t.subDiv.X=Math.floor(t.subDiv.max*t.bbSize.x/d),t.subDiv.Y=Math.floor(t.subDiv.max*t.bbSize.y/d),t.subDiv.Z=Math.floor(t.subDiv.max*t.bbSize.z/d),t.subDiv.X=t.subDiv.X<1?1:t.subDiv.X,t.subDiv.Y=t.subDiv.Y<1?1:t.subDiv.Y,t.subDiv.Z=t.subDiv.Z<1?1:t.subDiv.Z,t.facetParameters.facetNormals=this.getFacetLocalNormals(),t.facetParameters.facetPositions=this.getFacetLocalPositions(),t.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),t.facetParameters.bInfo=n,t.facetParameters.bbSize=t.bbSize,t.facetParameters.subDiv=t.subDiv,t.facetParameters.ratio=this.partitioningBBoxRatio,t.facetParameters.depthSort=t.facetDepthSort,t.facetDepthSort&&t.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(t.invertedMatrix),s.e.TransformCoordinatesToRef(t.facetDepthSortFrom,t.invertedMatrix,t.facetDepthSortOrigin),t.facetParameters.distanceTo=t.facetDepthSortOrigin),t.facetParameters.depthSortedFacets=t.depthSortedFacets,c.a.ComputeNormals(e,i,r,t.facetParameters),t.facetDepthSort&&t.facetDepthSortEnabled){t.depthSortedFacets.sort(t.facetDepthSortFunction);var p=t.depthSortedIndices.length/3|0;for(l=0;l<p;l++){var _=t.depthSortedFacets[l].ind;t.depthSortedIndices[3*l]=i[_],t.depthSortedIndices[3*l+1]=i[_+1],t.depthSortedIndices[3*l+2]=i[_+2]}this.updateIndices(t.depthSortedIndices,void 0,!0)}return this},e.prototype.getFacetLocalNormals=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetNormals||this.updateFacetData(),t.facetNormals},e.prototype.getFacetLocalPositions=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetPositions||this.updateFacetData(),t.facetPositions},e.prototype.getFacetLocalPartitioning=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetPartitioning||this.updateFacetData(),t.facetPartitioning},e.prototype.getFacetPosition=function(t){var e=s.e.Zero();return this.getFacetPositionToRef(t,e),e},e.prototype.getFacetPositionToRef=function(t,e){var i=this.getFacetLocalPositions()[t],r=this.getWorldMatrix();return s.e.TransformCoordinatesToRef(i,r,e),this},e.prototype.getFacetNormal=function(t){var e=s.e.Zero();return this.getFacetNormalToRef(t,e),e},e.prototype.getFacetNormalToRef=function(t,e){var i=this.getFacetLocalNormals()[t];return s.e.TransformNormalToRef(i,this.getWorldMatrix(),e),this},e.prototype.getFacetsAtLocalCoordinates=function(t,e,i){var r=this.getBoundingInfo(),n=this._internalAbstractMeshDataInfo._facetData,o=Math.floor((t-r.minimum.x*n.partitioningBBoxRatio)*n.subDiv.X*n.partitioningBBoxRatio/n.bbSize.x),s=Math.floor((e-r.minimum.y*n.partitioningBBoxRatio)*n.subDiv.Y*n.partitioningBBoxRatio/n.bbSize.y),a=Math.floor((i-r.minimum.z*n.partitioningBBoxRatio)*n.subDiv.Z*n.partitioningBBoxRatio/n.bbSize.z);return o<0||o>n.subDiv.max||s<0||s>n.subDiv.max||a<0||a>n.subDiv.max?null:n.facetPartitioning[o+n.subDiv.max*s+n.subDiv.max*n.subDiv.max*a]},e.prototype.getClosestFacetAtCoordinates=function(t,e,i,r,n,o){void 0===n&&(n=!1),void 0===o&&(o=!0);var a=this.getWorldMatrix(),h=s.c.Matrix[5];a.invertToRef(h);var c=s.c.Vector3[8];s.e.TransformCoordinatesFromFloatsToRef(t,e,i,h,c);var u=this.getClosestFacetAtLocalCoordinates(c.x,c.y,c.z,r,n,o);return r&&s.e.TransformCoordinatesFromFloatsToRef(r.x,r.y,r.z,a,r),u},e.prototype.getClosestFacetAtLocalCoordinates=function(t,e,i,r,n,o){void 0===n&&(n=!1),void 0===o&&(o=!0);var s=null,a=0,h=0,c=0,u=0,l=0,f=0,d=0,p=0,_=this.getFacetLocalPositions(),g=this.getFacetLocalNormals(),m=this.getFacetsAtLocalCoordinates(t,e,i);if(!m)return null;for(var y,b,v,M=Number.MAX_VALUE,O=M,A=0;A<m.length;A++)b=g[y=m[A]],u=(t-(v=_[y]).x)*b.x+(e-v.y)*b.y+(i-v.z)*b.z,(!n||n&&o&&u>=0||n&&!o&&u<=0)&&(u=b.x*v.x+b.y*v.y+b.z*v.z,l=-(b.x*t+b.y*e+b.z*i-u)/(b.x*b.x+b.y*b.y+b.z*b.z),(O=(a=(f=t+b.x*l)-t)*a+(h=(d=e+b.y*l)-e)*h+(c=(p=i+b.z*l)-i)*c)<M&&(M=O,s=y,r&&(r.x=f,r.y=d,r.z=p)));return s},e.prototype.getFacetDataParameters=function(){return this._internalAbstractMeshDataInfo._facetData.facetParameters},e.prototype.disableFacetData=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetDataEnabled&&(t.facetDataEnabled=!1,t.facetPositions=new Array,t.facetNormals=new Array,t.facetPartitioning=new Array,t.facetParameters=null,t.depthSortedIndices=new Uint32Array(0)),this},e.prototype.updateIndices=function(t,e,i){return void 0===i&&(i=!1),this},e.prototype.createNormals=function(t){var e,i=this.getVerticesData(h.b.PositionKind),r=this.getIndices();return e=this.isVerticesDataPresent(h.b.NormalKind)?this.getVerticesData(h.b.NormalKind):[],c.a.ComputeNormals(i,r,e,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(h.b.NormalKind,e,t),this},e.prototype.alignWithNormal=function(t,e){e||(e=y.a.Y);var i=s.c.Vector3[0],r=s.c.Vector3[1];return s.e.CrossToRef(e,t,r),s.e.CrossToRef(t,r,i),this.rotationQuaternion?s.b.RotationQuaternionFromAxisToRef(i,t,r,this.rotationQuaternion):s.e.RotationFromAxisToRef(i,t,r,this.rotation),this},e.prototype._checkOcclusionQuery=function(){return!1},e.prototype.disableEdgesRendering=function(){throw p.a.WarnImport("EdgesRenderer")},e.prototype.enableEdgesRendering=function(t,e){throw p.a.WarnImport("EdgesRenderer")},e.prototype.getConnectedParticleSystems=function(){var t=this;return this._scene.particleSystems.filter((function(e){return e.emitter===t}))},e.OCCLUSION_TYPE_NONE=0,e.OCCLUSION_TYPE_OPTIMISTIC=1,e.OCCLUSION_TYPE_STRICT=2,e.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0,e.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1,e.CULLINGSTRATEGY_STANDARD=0,e.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,e.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,e.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,e}(u.a);b.a.RegisteredTypes["BABYLON.AbstractMesh"]=O},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return a}));var r=i(1),n=i(37),o=i(45),s={},a=function(){function t(t){this.attached={},this.camera=t,this.checkInputs=function(){}}return t.prototype.add=function(t){var e=t.getSimpleName();this.attached[e]?r.a.Warn("camera input of type "+e+" already exists on camera"):(this.attached[e]=t,t.camera=this.camera,t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t))),this.attachedElement&&t.attachControl(this.attachedElement))},t.prototype.remove=function(t){for(var e in this.attached){var i=this.attached[e];i===t&&(i.detachControl(this.attachedElement),i.camera=null,delete this.attached[e],this.rebuildInputCheck())}},t.prototype.removeByType=function(t){for(var e in this.attached){var i=this.attached[e];i.getClassName()===t&&(i.detachControl(this.attachedElement),i.camera=null,delete this.attached[e],this.rebuildInputCheck())}},t.prototype._addCheckInputs=function(t){var e=this.checkInputs;return function(){e(),t()}},t.prototype.attachInput=function(t){this.attachedElement&&t.attachControl(this.attachedElement,this.noPreventDefault)},t.prototype.attachElement=function(t,e){if(void 0===e&&(e=!1),!this.attachedElement)for(var i in e=!o.a.ForceAttachControlToAlwaysPreventDefault&&e,this.attachedElement=t,this.noPreventDefault=e,this.attached)this.attached[i].attachControl(t,e)},t.prototype.detachElement=function(t,e){if(void 0===e&&(e=!1),this.attachedElement===t){for(var i in this.attached)this.attached[i].detachControl(t),e&&(this.attached[i].camera=null);this.attachedElement=null}},t.prototype.rebuildInputCheck=function(){for(var t in this.checkInputs=function(){},this.attached){var e=this.attached[t];e.checkInputs&&(this.checkInputs=this._addCheckInputs(e.checkInputs.bind(e)))}},t.prototype.clear=function(){this.attachedElement&&this.detachElement(this.attachedElement,!0),this.attached={},this.attachedElement=null,this.checkInputs=function(){}},t.prototype.serialize=function(t){var e={};for(var i in this.attached){var r=this.attached[i],o=n.a.Serialize(r);e[r.getClassName()]=o}t.inputsmgr=e},t.prototype.parse=function(t){var e=t.inputsmgr;if(e)for(var i in this.clear(),e){if(a=s[i]){var r=e[i],o=n.a.Parse((function(){return new a}),r,null);this.add(o)}}else for(var i in this.attached){var a;if(a=s[this.attached[i].getClassName()]){o=n.a.Parse((function(){return new a}),t,null);this.remove(this.attached[i]),this.add(o)}}},t}()},,function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return o}));var r,n=i(34);!function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD",t[t.BONE=2]="BONE"}(r||(r={}));var o=function(){function t(){}return t.X=new n.e(1,0,0),t.Y=new n.e(0,1,0),t.Z=new n.e(0,0,1),t}()},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"b",(function(){return h}));var r=i(3),n=i(34),o=function(){function t(){}return t.POINTERDOWN=1,t.POINTERUP=2,t.POINTERMOVE=4,t.POINTERWHEEL=8,t.POINTERPICK=16,t.POINTERTAP=32,t.POINTERDOUBLETAP=64,t}(),s=function(t,e){this.type=t,this.event=e},a=function(t){function e(e,i,r,o){var s=t.call(this,e,i)||this;return s.ray=null,s.skipOnPointerObservable=!1,s.localPosition=new n.d(r,o),s}return Object(r.d)(e,t),e}(s),h=function(t){function e(e,i,r){var n=t.call(this,e,i)||this;return n.pickInfo=r,n}return Object(r.d)(e,t),e}(s)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i(11),n=i(1),o=function(t,e){return t?t.getClassName&&"Mesh"===t.getClassName()?null:t.getClassName&&"SubMesh"===t.getClassName()?t.clone(e):t.clone?t.clone():null:null};var s=function(){function t(){}return t.DeepCopy=function(t,e,i,s){for(var a=0,h=function(t){var e=[];do{Object.getOwnPropertyNames(t).forEach((function(t){-1===e.indexOf(t)&&e.push(t)}))}while(t=Object.getPrototypeOf(t));return e}(t);a<h.length;a++){var c=h[a];if(("_"!==c[0]||s&&-1!==s.indexOf(c))&&!(r.a.EndsWith(c,"Observable")||i&&-1!==i.indexOf(c))){var u=t[c],l=typeof u;if("function"!==l)try{if("object"===l)if(u instanceof Array){if(e[c]=[],u.length>0)if("object"==typeof u[0])for(var f=0;f<u.length;f++){var d=o(u[f],e);-1===e[c].indexOf(d)&&e[c].push(d)}else e[c]=u.slice(0)}else e[c]=o(u,e);else e[c]=u}catch(t){n.a.Warn(t.message)}}}},t}()},function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return o}));var r=1/2.2,n=2.2,o=.001},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var r=i(85),n=i(34),o=i(166),s=i(167),a={min:0,max:0},h={min:0,max:0},c=function(t,e,i){var r=n.e.Dot(e.centerWorld,t),o=Math.abs(n.e.Dot(e.directions[0],t))*e.extendSize.x+Math.abs(n.e.Dot(e.directions[1],t))*e.extendSize.y+Math.abs(n.e.Dot(e.directions[2],t))*e.extendSize.z;i.min=r-o,i.max=r+o},u=function(t,e,i){return c(t,e,a),c(t,i,h),!(a.min>h.max||h.min>a.max)},l=function(){function t(t,e,i){this._isLocked=!1,this.boundingBox=new o.a(t,e,i),this.boundingSphere=new s.a(t,e,i)}return t.prototype.reConstruct=function(t,e,i){this.boundingBox.reConstruct(t,e,i),this.boundingSphere.reConstruct(t,e,i)},Object.defineProperty(t.prototype,"minimum",{get:function(){return this.boundingBox.minimum},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this.boundingBox.maximum},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLocked",{get:function(){return this._isLocked},set:function(t){this._isLocked=t},enumerable:!1,configurable:!0}),t.prototype.update=function(t){this._isLocked||(this.boundingBox._update(t),this.boundingSphere._update(t))},t.prototype.centerOn=function(e,i){var r=t.TmpVector3[0].copyFrom(e).subtractInPlace(i),n=t.TmpVector3[1].copyFrom(e).addInPlace(i);return this.boundingBox.reConstruct(r,n,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(r,n,this.boundingBox.getWorldMatrix()),this},t.prototype.scale=function(t){return this.boundingBox.scale(t),this.boundingSphere.scale(t),this},t.prototype.isInFrustum=function(t,e){return void 0===e&&(e=0),!(2!==e&&3!==e||!this.boundingSphere.isCenterInFrustum(t))||!!this.boundingSphere.isInFrustum(t)&&(!(1!==e&&3!==e)||this.boundingBox.isInFrustum(t))},Object.defineProperty(t.prototype,"diagonalLength",{get:function(){var e=this.boundingBox;return e.maximumWorld.subtractToRef(e.minimumWorld,t.TmpVector3[0]).length()},enumerable:!1,configurable:!0}),t.prototype.isCompletelyInFrustum=function(t){return this.boundingBox.isCompletelyInFrustum(t)},t.prototype._checkCollision=function(t){return t._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)},t.prototype.intersectsPoint=function(t){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(t)&&!!this.boundingBox.intersectsPoint(t))},t.prototype.intersects=function(t,e){if(!s.a.Intersects(this.boundingSphere,t.boundingSphere))return!1;if(!o.a.Intersects(this.boundingBox,t.boundingBox))return!1;if(!e)return!0;var i=this.boundingBox,r=t.boundingBox;return!!u(i.directions[0],i,r)&&(!!u(i.directions[1],i,r)&&(!!u(i.directions[2],i,r)&&(!!u(r.directions[0],i,r)&&(!!u(r.directions[1],i,r)&&(!!u(r.directions[2],i,r)&&(!!u(n.e.Cross(i.directions[0],r.directions[0]),i,r)&&(!!u(n.e.Cross(i.directions[0],r.directions[1]),i,r)&&(!!u(n.e.Cross(i.directions[0],r.directions[2]),i,r)&&(!!u(n.e.Cross(i.directions[1],r.directions[0]),i,r)&&(!!u(n.e.Cross(i.directions[1],r.directions[1]),i,r)&&(!!u(n.e.Cross(i.directions[1],r.directions[2]),i,r)&&(!!u(n.e.Cross(i.directions[2],r.directions[0]),i,r)&&(!!u(n.e.Cross(i.directions[2],r.directions[1]),i,r)&&!!u(n.e.Cross(i.directions[2],r.directions[2]),i,r))))))))))))))},t.TmpVector3=r.a.BuildArray(2,n.e.Zero),t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){this.rootNodes=new Array,this.cameras=new Array,this.lights=new Array,this.meshes=new Array,this.skeletons=new Array,this.particleSystems=new Array,this.animations=[],this.animationGroups=new Array,this.multiMaterials=new Array,this.materials=new Array,this.morphTargetManagers=new Array,this.geometries=new Array,this.transformNodes=new Array,this.actionManagers=new Array,this.textures=new Array,this._environmentTexture=null,this.postProcesses=new Array}return t.AddParser=function(t,e){this._BabylonFileParsers[t]=e},t.GetParser=function(t){return this._BabylonFileParsers[t]?this._BabylonFileParsers[t]:null},t.AddIndividualParser=function(t,e){this._IndividualBabylonFileParsers[t]=e},t.GetIndividualParser=function(t){return this._IndividualBabylonFileParsers[t]?this._IndividualBabylonFileParsers[t]:null},t.Parse=function(t,e,i,r){for(var n in this._BabylonFileParsers)this._BabylonFileParsers.hasOwnProperty(n)&&this._BabylonFileParsers[n](t,e,i,r)},Object.defineProperty(t.prototype,"environmentTexture",{get:function(){return this._environmentTexture},set:function(t){this._environmentTexture=t},enumerable:!1,configurable:!0}),t.prototype.getNodes=function(){var t=new Array;return t=(t=(t=(t=t.concat(this.meshes)).concat(this.lights)).concat(this.cameras)).concat(this.transformNodes),this.skeletons.forEach((function(e){return t=t.concat(e.bones)})),t},t._BabylonFileParsers={},t._IndividualBabylonFileParsers={},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var r=i(34),n=i(36),o=i(46),s=i(37),a=i(35),h=i(163),c=i(164),u=i(47),l=i(121),f=i(78),d=function(){function t(e,i,r,n,o,s){this.name=e,this.targetProperty=i,this.framePerSecond=r,this.dataType=n,this.loopMode=o,this.enableBlending=s,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=i.split("."),this.dataType=n,this.loopMode=void 0===o?t.ANIMATIONLOOPMODE_CYCLE:o}return t._PrepareAnimation=function(e,i,o,s,a,h,c,u){var f=void 0;if(!isNaN(parseFloat(a))&&isFinite(a)?f=t.ANIMATIONTYPE_FLOAT:a instanceof r.b?f=t.ANIMATIONTYPE_QUATERNION:a instanceof r.e?f=t.ANIMATIONTYPE_VECTOR3:a instanceof r.d?f=t.ANIMATIONTYPE_VECTOR2:a instanceof n.a?f=t.ANIMATIONTYPE_COLOR3:a instanceof n.b?f=t.ANIMATIONTYPE_COLOR4:a instanceof l.a&&(f=t.ANIMATIONTYPE_SIZE),null==f)return null;var d=new t(e,i,o,f,c),p=[{frame:0,value:a},{frame:s,value:h}];return d.setKeys(p),void 0!==u&&d.setEasingFunction(u),d},t.CreateAnimation=function(e,i,r,n){var o=new t(e+"Animation",e,r,i,t.ANIMATIONLOOPMODE_CONSTANT);return o.setEasingFunction(n),o},t.CreateAndStartAnimation=function(e,i,r,n,o,s,a,h,c,u){var l=t._PrepareAnimation(e,r,n,o,s,a,h,c);return l?i.getScene().beginDirectAnimation(i,[l],0,o,1===l.loopMode,1,u):null},t.CreateAndStartHierarchyAnimation=function(e,i,r,n,o,s,a,h,c,u,l){var f=t._PrepareAnimation(e,n,o,s,a,h,c,u);return f?i.getScene().beginDirectHierarchyAnimation(i,r,[f],0,s,1===f.loopMode,1,l):null},t.CreateMergeAndStartAnimation=function(e,i,r,n,o,s,a,h,c,u){var l=t._PrepareAnimation(e,r,n,o,s,a,h,c);return l?(i.animations.push(l),i.getScene().beginAnimation(i,0,o,1===l.loopMode,1,u)):null},t.MakeAnimationAdditive=function(e,i,n,o,s){void 0===i&&(i=0),void 0===o&&(o=!1);var a=e;if(o&&((a=e.clone()).name=s||a.name),!a._keys.length)return a;i=i>=0?i:0;var h=0,c=a._keys[0],u=a._keys.length-1,l=a._keys[u],f={referenceValue:c.value,referencePosition:r.c.Vector3[0],referenceQuaternion:r.c.Quaternion[0],referenceScaling:r.c.Vector3[1],keyPosition:r.c.Vector3[2],keyQuaternion:r.c.Quaternion[1],keyScaling:r.c.Vector3[3]},d=!1,p=c.frame,_=l.frame;if(n){var g=a.getRange(n);g&&(p=g.from,_=g.to)}var m=c.frame===p,y=l.frame===_;if(1===a._keys.length){var b=a._getKeyValue(a._keys[0]);f.referenceValue=b.clone?b.clone():b,d=!0}else if(i<=c.frame){b=a._getKeyValue(c.value);f.referenceValue=b.clone?b.clone():b,d=!0}else if(i>=l.frame){b=a._getKeyValue(l.value);f.referenceValue=b.clone?b.clone():b,d=!0}for(var v=0;!d||!m||!y&&v<a._keys.length-1;){var M=a._keys[v],O=a._keys[v+1];if(!d&&i>=M.frame&&i<=O.frame){b=void 0;if(i===M.frame)b=a._getKeyValue(M.value);else if(i===O.frame)b=a._getKeyValue(O.value);else{var A={key:v,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT};b=a._interpolate(i,A)}f.referenceValue=b.clone?b.clone():b,d=!0}if(!m&&p>=M.frame&&p<=O.frame){if(p===M.frame)h=v;else if(p===O.frame)h=v+1;else{A={key:v,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT};var P={frame:p,value:(b=a._interpolate(p,A)).clone?b.clone():b};a._keys.splice(v+1,0,P),h=v+1}m=!0}if(!y&&_>=M.frame&&_<=O.frame){if(_===M.frame)u=v;else if(_===O.frame)u=v+1;else{A={key:v,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},P={frame:_,value:(b=a._interpolate(_,A)).clone?b.clone():b};a._keys.splice(v+1,0,P),u=v+1}y=!0}v++}a.dataType===t.ANIMATIONTYPE_QUATERNION?f.referenceValue.normalize().conjugateInPlace():a.dataType===t.ANIMATIONTYPE_MATRIX&&(f.referenceValue.decompose(f.referenceScaling,f.referenceQuaternion,f.referencePosition),f.referenceQuaternion.normalize().conjugateInPlace());for(v=h;v<=u;v++){P=a._keys[v];if(!v||a.dataType===t.ANIMATIONTYPE_FLOAT||P.value!==c.value)switch(a.dataType){case t.ANIMATIONTYPE_MATRIX:P.value.decompose(f.keyScaling,f.keyQuaternion,f.keyPosition),f.keyPosition.subtractInPlace(f.referencePosition),f.keyScaling.divideInPlace(f.referenceScaling),f.referenceQuaternion.multiplyToRef(f.keyQuaternion,f.keyQuaternion),r.a.ComposeToRef(f.keyScaling,f.keyQuaternion,f.keyPosition,P.value);break;case t.ANIMATIONTYPE_QUATERNION:f.referenceValue.multiplyToRef(P.value,P.value);break;case t.ANIMATIONTYPE_VECTOR2:case t.ANIMATIONTYPE_VECTOR3:case t.ANIMATIONTYPE_COLOR3:case t.ANIMATIONTYPE_COLOR4:P.value.subtractToRef(f.referenceValue,P.value);break;case t.ANIMATIONTYPE_SIZE:P.value.width-=f.referenceValue.width,P.value.height-=f.referenceValue.height;break;default:P.value-=f.referenceValue}}return a},t.TransitionTo=function(t,e,i,r,n,o,s,a){if(void 0===a&&(a=null),s<=0)return i[t]=e,a&&a(),null;var h=n*(s/1e3);o.setKeys([{frame:0,value:i[t].clone?i[t].clone():i[t]},{frame:h,value:e}]),i.animations||(i.animations=[]),i.animations.push(o);var c=r.beginAnimation(i,0,h,!1);return c.onAnimationEnd=a,c},Object.defineProperty(t.prototype,"runtimeAnimations",{get:function(){return this._runtimeAnimations},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRunningRuntimeAnimations",{get:function(){for(var t=0,e=this._runtimeAnimations;t<e.length;t++){if(!e[t].isStopped)return!0}return!1},enumerable:!1,configurable:!0}),t.prototype.toString=function(t){var e="Name: "+this.name+", property: "+this.targetProperty;if(e+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],e+=", nKeys: "+(this._keys?this._keys.length:"none"),e+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),t){e+=", Ranges: {";var i=!0;for(var r in this._ranges)i&&(e+=", ",i=!1),e+=r;e+="}"}return e},t.prototype.addEvent=function(t){this._events.push(t),this._events.sort((function(t,e){return t.frame-e.frame}))},t.prototype.removeEvents=function(t){for(var e=0;e<this._events.length;e++)this._events[e].frame===t&&(this._events.splice(e,1),e--)},t.prototype.getEvents=function(){return this._events},t.prototype.createRange=function(t,e,i){this._ranges[t]||(this._ranges[t]=new c.a(t,e,i))},t.prototype.deleteRange=function(t,e){void 0===e&&(e=!0);var i=this._ranges[t];if(i){if(e)for(var r=i.from,n=i.to,o=this._keys.length-1;o>=0;o--)this._keys[o].frame>=r&&this._keys[o].frame<=n&&this._keys.splice(o,1);this._ranges[t]=null}},t.prototype.getRange=function(t){return this._ranges[t]},t.prototype.getKeys=function(){return this._keys},t.prototype.getHighestFrame=function(){for(var t=0,e=0,i=this._keys.length;e<i;e++)t<this._keys[e].frame&&(t=this._keys[e].frame);return t},t.prototype.getEasingFunction=function(){return this._easingFunction},t.prototype.setEasingFunction=function(t){this._easingFunction=t},t.prototype.floatInterpolateFunction=function(t,e,i){return o.a.Lerp(t,e,i)},t.prototype.floatInterpolateFunctionWithTangents=function(t,e,i,r,n){return o.a.Hermite(t,e,i,r,n)},t.prototype.quaternionInterpolateFunction=function(t,e,i){return r.b.Slerp(t,e,i)},t.prototype.quaternionInterpolateFunctionWithTangents=function(t,e,i,n,o){return r.b.Hermite(t,e,i,n,o).normalize()},t.prototype.vector3InterpolateFunction=function(t,e,i){return r.e.Lerp(t,e,i)},t.prototype.vector3InterpolateFunctionWithTangents=function(t,e,i,n,o){return r.e.Hermite(t,e,i,n,o)},t.prototype.vector2InterpolateFunction=function(t,e,i){return r.d.Lerp(t,e,i)},t.prototype.vector2InterpolateFunctionWithTangents=function(t,e,i,n,o){return r.d.Hermite(t,e,i,n,o)},t.prototype.sizeInterpolateFunction=function(t,e,i){return l.a.Lerp(t,e,i)},t.prototype.color3InterpolateFunction=function(t,e,i){return n.a.Lerp(t,e,i)},t.prototype.color4InterpolateFunction=function(t,e,i){return n.b.Lerp(t,e,i)},t.prototype._getKeyValue=function(t){return"function"==typeof t?t():t},t.prototype._interpolate=function(e,i){if(i.loopMode===t.ANIMATIONLOOPMODE_CONSTANT&&i.repeatCount>0)return i.highLimitValue.clone?i.highLimitValue.clone():i.highLimitValue;var r=this._keys;if(1===r.length)return this._getKeyValue(r[0].value);var n=i.key;if(r[n].frame>=e)for(;n-1>=0&&r[n].frame>=e;)n--;for(var o=n;o<r.length;o++){var s=r[o+1];if(s.frame>=e){i.key=o;var a=r[o],c=this._getKeyValue(a.value);if(a.interpolation===h.a.STEP)return c;var u=this._getKeyValue(s.value),l=void 0!==a.outTangent&&void 0!==s.inTangent,f=s.frame-a.frame,d=(e-a.frame)/f,p=this.getEasingFunction();switch(null!=p&&(d=p.ease(d)),this.dataType){case t.ANIMATIONTYPE_FLOAT:var _=l?this.floatInterpolateFunctionWithTangents(c,a.outTangent*f,u,s.inTangent*f,d):this.floatInterpolateFunction(c,u,d);switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return _;case t.ANIMATIONLOOPMODE_RELATIVE:return i.offsetValue*i.repeatCount+_}break;case t.ANIMATIONTYPE_QUATERNION:var g=l?this.quaternionInterpolateFunctionWithTangents(c,a.outTangent.scale(f),u,s.inTangent.scale(f),d):this.quaternionInterpolateFunction(c,u,d);switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return g;case t.ANIMATIONLOOPMODE_RELATIVE:return g.addInPlace(i.offsetValue.scale(i.repeatCount))}return g;case t.ANIMATIONTYPE_VECTOR3:var m=l?this.vector3InterpolateFunctionWithTangents(c,a.outTangent.scale(f),u,s.inTangent.scale(f),d):this.vector3InterpolateFunction(c,u,d);switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return m;case t.ANIMATIONLOOPMODE_RELATIVE:return m.add(i.offsetValue.scale(i.repeatCount))}case t.ANIMATIONTYPE_VECTOR2:var y=l?this.vector2InterpolateFunctionWithTangents(c,a.outTangent.scale(f),u,s.inTangent.scale(f),d):this.vector2InterpolateFunction(c,u,d);switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return y;case t.ANIMATIONLOOPMODE_RELATIVE:return y.add(i.offsetValue.scale(i.repeatCount))}case t.ANIMATIONTYPE_SIZE:switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(c,u,d);case t.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(c,u,d).add(i.offsetValue.scale(i.repeatCount))}case t.ANIMATIONTYPE_COLOR3:switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.color3InterpolateFunction(c,u,d);case t.ANIMATIONLOOPMODE_RELATIVE:return this.color3InterpolateFunction(c,u,d).add(i.offsetValue.scale(i.repeatCount))}case t.ANIMATIONTYPE_COLOR4:switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.color4InterpolateFunction(c,u,d);case t.ANIMATIONLOOPMODE_RELATIVE:return this.color4InterpolateFunction(c,u,d).add(i.offsetValue.scale(i.repeatCount))}case t.ANIMATIONTYPE_MATRIX:switch(i.loopMode){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:if(t.AllowMatricesInterpolation)return this.matrixInterpolateFunction(c,u,d,i.workValue);case t.ANIMATIONLOOPMODE_RELATIVE:return c}}break}}return this._getKeyValue(r[r.length-1].value)},t.prototype.matrixInterpolateFunction=function(e,i,n,o){return t.AllowMatrixDecomposeForInterpolation?o?(r.a.DecomposeLerpToRef(e,i,n,o),o):r.a.DecomposeLerp(e,i,n):o?(r.a.LerpToRef(e,i,n,o),o):r.a.Lerp(e,i,n)},t.prototype.clone=function(){var e=new t(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed,this._keys&&e.setKeys(this._keys),this._ranges)for(var i in e._ranges={},this._ranges){var r=this._ranges[i];r&&(e._ranges[i]=r.clone())}return e},t.prototype.setKeys=function(t){this._keys=t.slice(0)},t.prototype.serialize=function(){var e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode,e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed;var i=this.dataType;e.keys=[];for(var r=this.getKeys(),n=0;n<r.length;n++){var o=r[n],s={};switch(s.frame=o.frame,i){case t.ANIMATIONTYPE_FLOAT:s.values=[o.value],void 0!==o.inTangent&&s.values.push(o.inTangent),void 0!==o.outTangent&&(void 0===o.inTangent&&s.values.push(void 0),s.values.push(o.outTangent));break;case t.ANIMATIONTYPE_QUATERNION:case t.ANIMATIONTYPE_MATRIX:case t.ANIMATIONTYPE_VECTOR3:case t.ANIMATIONTYPE_COLOR3:case t.ANIMATIONTYPE_COLOR4:s.values=o.value.asArray(),null!=o.inTangent&&s.values.push(o.inTangent.asArray()),null!=o.outTangent&&(void 0===o.inTangent&&s.values.push(void 0),s.values.push(o.outTangent.asArray()))}e.keys.push(s)}for(var a in e.ranges=[],this._ranges){var h=this._ranges[a];if(h){var c={};c.name=a,c.from=h.from,c.to=h.to,e.ranges.push(c)}}return e},t._UniversalLerp=function(t,e,i){var r=t.constructor;return r.Lerp?r.Lerp(t,e,i):r.Slerp?r.Slerp(t,e,i):t.toFixed?t*(1-i)+i*e:e},t.Parse=function(e){var i,o,s=new t(e.name,e.property,e.framePerSecond,e.dataType,e.loopBehavior),a=e.dataType,h=[];for(e.enableBlending&&(s.enableBlending=e.enableBlending),e.blendingSpeed&&(s.blendingSpeed=e.blendingSpeed),o=0;o<e.keys.length;o++){var c,u,l=e.keys[o];switch(a){case t.ANIMATIONTYPE_FLOAT:i=l.values[0],l.values.length>=1&&(c=l.values[1]),l.values.length>=2&&(u=l.values[2]);break;case t.ANIMATIONTYPE_QUATERNION:if(i=r.b.FromArray(l.values),l.values.length>=8){var f=r.b.FromArray(l.values.slice(4,8));f.equals(r.b.Zero())||(c=f)}if(l.values.length>=12){var d=r.b.FromArray(l.values.slice(8,12));d.equals(r.b.Zero())||(u=d)}break;case t.ANIMATIONTYPE_MATRIX:i=r.a.FromArray(l.values);break;case t.ANIMATIONTYPE_COLOR3:i=n.a.FromArray(l.values);break;case t.ANIMATIONTYPE_COLOR4:i=n.b.FromArray(l.values);break;case t.ANIMATIONTYPE_VECTOR3:default:i=r.e.FromArray(l.values)}var p={};p.frame=l.frame,p.value=i,null!=c&&(p.inTangent=c),null!=u&&(p.outTangent=u),h.push(p)}if(s.setKeys(h),e.ranges)for(o=0;o<e.ranges.length;o++)i=e.ranges[o],s.createRange(i.name,i.from,i.to);return s},t.AppendSerializedAnimations=function(t,e){s.a.AppendSerializedAnimations(t,e)},t.ParseFromFileAsync=function(t,e){var i=this;return new Promise((function(r,n){var o=new f.a;o.addEventListener("readystatechange",(function(){if(4==o.readyState)if(200==o.status){var e=JSON.parse(o.responseText);if(e.length){for(var s=new Array,a=0,h=e;a<h.length;a++){var c=h[a];s.push(i.Parse(c))}r(s)}else{s=i.Parse(e);t&&(s.name=t),r(s)}}else n("Unable to load the animation")})),o.open("GET",e),o.send()}))},t.CreateFromSnippetAsync=function(t){var e=this;return new Promise((function(i,r){var n=new f.a;n.addEventListener("readystatechange",(function(){if(4==n.readyState)if(200==n.status){var o=JSON.parse(JSON.parse(n.responseText).jsonPayload);if(o.animations){for(var s=JSON.parse(o.animations),a=new Array,h=0,c=s;h<c.length;h++){var u=c[h];a.push(e.Parse(u))}i(a)}else{s=JSON.parse(o.animation);(a=e.Parse(s)).snippetId=t,i(a)}}else r("Unable to load the snippet "+t)})),n.open("GET",e.SnippetUrl+"/"+t.replace(/#/g,"/")),n.send()}))},t.AllowMatricesInterpolation=!1,t.AllowMatrixDecomposeForInterpolation=!0,t.SnippetUrl="https://snippet.babylonjs.com",t.ANIMATIONTYPE_FLOAT=0,t.ANIMATIONTYPE_VECTOR3=1,t.ANIMATIONTYPE_QUATERNION=2,t.ANIMATIONTYPE_MATRIX=3,t.ANIMATIONTYPE_COLOR3=4,t.ANIMATIONTYPE_COLOR4=7,t.ANIMATIONTYPE_VECTOR2=5,t.ANIMATIONTYPE_SIZE=6,t.ANIMATIONLOOPMODE_RELATIVE=0,t.ANIMATIONLOOPMODE_CYCLE=1,t.ANIMATIONLOOPMODE_CONSTANT=2,t}();a.a.RegisteredTypes["BABYLON.Animation"]=d,u.a._AnimationRangeFactory=function(t,e,i){return new c.a(t,e,i)}},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var r=i(3),n=function(){function t(e){this.length=0,this.data=new Array(e),this._id=t._GlobalId++}return t.prototype.push=function(t){this.data[this.length++]=t,this.length>this.data.length&&(this.data.length*=2)},t.prototype.forEach=function(t){for(var e=0;e<this.length;e++)t(this.data[e])},t.prototype.sort=function(t){this.data.sort(t)},t.prototype.reset=function(){this.length=0},t.prototype.dispose=function(){this.reset(),this.data&&(this.data.length=0,this.data=[])},t.prototype.concat=function(t){if(0!==t.length){this.length+t.length>this.data.length&&(this.data.length=2*(this.length+t.length));for(var e=0;e<t.length;e++)this.data[this.length++]=(t.data||t)[e]}},t.prototype.indexOf=function(t){var e=this.data.indexOf(t);return e>=this.length?-1:e},t.prototype.contains=function(t){return-1!==this.indexOf(t)},t._GlobalId=0,t}(),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._duplicateId=0,e}return Object(r.d)(e,t),e.prototype.push=function(e){t.prototype.push.call(this,e),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId},e.prototype.pushNoDuplicate=function(t){return(!t.__smartArrayFlags||t.__smartArrayFlags[this._id]!==this._duplicateId)&&(this.push(t),!0)},e.prototype.reset=function(){t.prototype.reset.call(this),this._duplicateId++},e.prototype.concatWithNoDuplicate=function(t){if(0!==t.length){this.length+t.length>this.data.length&&(this.data.length=2*(this.length+t.length));for(var e=0;e<t.length;e++){var i=(t.data||t)[e];this.pushNoDuplicate(i)}}},e}(n)},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var r=i(3),n=i(37),o=i(0),s=i(34),a=i(47),h=i(55),c=function(t){function e(i,r,n){void 0===r&&(r=null),void 0===n&&(n=!0);var a=t.call(this,i,r)||this;return a._forward=new s.e(0,0,1),a._forwardInverted=new s.e(0,0,-1),a._up=new s.e(0,1,0),a._right=new s.e(1,0,0),a._rightInverted=new s.e(-1,0,0),a._position=s.e.Zero(),a._rotation=s.e.Zero(),a._rotationQuaternion=null,a._scaling=s.e.One(),a._isDirty=!1,a._transformToBoneReferal=null,a._isAbsoluteSynced=!1,a._billboardMode=e.BILLBOARDMODE_NONE,a._preserveParentRotationForBillboard=!1,a.scalingDeterminant=1,a._infiniteDistance=!1,a.ignoreNonUniformScaling=!1,a.reIntegrateRotationIntoRotationQuaternion=!1,a._poseMatrix=null,a._localMatrix=s.a.Zero(),a._usePivotMatrix=!1,a._absolutePosition=s.e.Zero(),a._absoluteScaling=s.e.Zero(),a._absoluteRotationQuaternion=s.b.Identity(),a._pivotMatrix=s.a.Identity(),a._postMultiplyPivotMatrix=!1,a._isWorldMatrixFrozen=!1,a._indexInSceneTransformNodesArray=-1,a.onAfterWorldMatrixUpdateObservable=new o.a,a._nonUniformScaling=!1,n&&a.getScene().addTransformNode(a),a}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"billboardMode",{get:function(){return this._billboardMode},set:function(t){this._billboardMode!==t&&(this._billboardMode=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preserveParentRotationForBillboard",{get:function(){return this._preserveParentRotationForBillboard},set:function(t){t!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"infiniteDistance",{get:function(){return this._infiniteDistance},set:function(t){this._infiniteDistance!==t&&(this._infiniteDistance=t)},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"TransformNode"},Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._rotationQuaternion=null,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this._scaling},set:function(t){this._scaling=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotationQuaternion",{get:function(){return this._rotationQuaternion},set:function(t){this._rotationQuaternion=t,t&&this._rotation.setAll(0),this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forward",{get:function(){return s.e.Normalize(s.e.TransformNormal(this.getScene().useRightHandedSystem?this._forwardInverted:this._forward,this.getWorldMatrix()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return s.e.Normalize(s.e.TransformNormal(this._up,this.getWorldMatrix()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return s.e.Normalize(s.e.TransformNormal(this.getScene().useRightHandedSystem?this._rightInverted:this._right,this.getWorldMatrix()))},enumerable:!1,configurable:!0}),e.prototype.updatePoseMatrix=function(t){return this._poseMatrix?(this._poseMatrix.copyFrom(t),this):(this._poseMatrix=t.clone(),this)},e.prototype.getPoseMatrix=function(){return this._poseMatrix||(this._poseMatrix=s.a.Identity()),this._poseMatrix},e.prototype._isSynchronized=function(){var t=this._cache;return this.billboardMode===t.billboardMode&&this.billboardMode===e.BILLBOARDMODE_NONE&&(!t.pivotMatrixUpdated&&(!this.infiniteDistance&&(!this.position._isDirty&&(!this.scaling._isDirty&&!(this._rotationQuaternion&&this._rotationQuaternion._isDirty||this.rotation._isDirty)))))},e.prototype._initCache=function(){t.prototype._initCache.call(this);var e=this._cache;e.localMatrixUpdated=!1,e.billboardMode=-1,e.infiniteDistance=!1},e.prototype.markAsDirty=function(t){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this},Object.defineProperty(e.prototype,"absolutePosition",{get:function(){return this._absolutePosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteScaling",{get:function(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteRotationQuaternion",{get:function(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion},enumerable:!1,configurable:!0}),e.prototype.setPreTransformMatrix=function(t){return this.setPivotMatrix(t,!1)},e.prototype.setPivotMatrix=function(t,e){return void 0===e&&(e=!0),this._pivotMatrix.copyFrom(t),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=e,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=s.a.Invert(this._pivotMatrix)),this},e.prototype.getPivotMatrix=function(){return this._pivotMatrix},e.prototype.instantiateHierarchy=function(t,e,i){void 0===t&&(t=null);var r=this.clone("Clone of "+(this.name||this.id),t||this.parent,!0);r&&i&&i(this,r);for(var n=0,o=this.getChildTransformNodes(!0);n<o.length;n++){o[n].instantiateHierarchy(r,e,i)}return r},e.prototype.freezeWorldMatrix=function(t){return void 0===t&&(t=null),t?this._worldMatrix=t:(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this},e.prototype.unfreezeWorldMatrix=function(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this},Object.defineProperty(e.prototype,"isWorldMatrixFrozen",{get:function(){return this._isWorldMatrixFrozen},enumerable:!1,configurable:!0}),e.prototype.getAbsolutePosition=function(){return this.computeWorldMatrix(),this._absolutePosition},e.prototype.setAbsolutePosition=function(t){if(!t)return this;var e,i,r;if(void 0===t.x){if(arguments.length<3)return this;e=arguments[0],i=arguments[1],r=arguments[2]}else e=t.x,i=t.y,r=t.z;if(this.parent){var n=s.c.Matrix[0];this.parent.getWorldMatrix().invertToRef(n),s.e.TransformCoordinatesFromFloatsToRef(e,i,r,n,this.position)}else this.position.x=e,this.position.y=i,this.position.z=r;return this._absolutePosition.copyFrom(t),this},e.prototype.setPositionWithLocalVector=function(t){return this.computeWorldMatrix(),this.position=s.e.TransformNormal(t,this._localMatrix),this},e.prototype.getPositionExpressedInLocalSpace=function(){this.computeWorldMatrix();var t=s.c.Matrix[0];return this._localMatrix.invertToRef(t),s.e.TransformNormal(this.position,t)},e.prototype.locallyTranslate=function(t){return this.computeWorldMatrix(!0),this.position=s.e.TransformCoordinates(t,this._localMatrix),this},e.prototype.lookAt=function(t,i,r,n,o){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=h.b.LOCAL);var a=e._lookAtVectorCache,c=o===h.b.LOCAL?this.position:this.getAbsolutePosition();if(t.subtractToRef(c,a),this.setDirection(a,i,r,n),o===h.b.WORLD&&this.parent)if(this.rotationQuaternion){var u=s.c.Matrix[0];this.rotationQuaternion.toRotationMatrix(u);var l=s.c.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(l),l.invert(),u.multiplyToRef(l,u),this.rotationQuaternion.fromRotationMatrix(u)}else{var f=s.c.Quaternion[0];s.b.FromEulerVectorToRef(this.rotation,f);u=s.c.Matrix[0];f.toRotationMatrix(u);l=s.c.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(l),l.invert(),u.multiplyToRef(l,u),f.fromRotationMatrix(u),f.toEulerAnglesToRef(this.rotation)}return this},e.prototype.getDirection=function(t){var e=s.e.Zero();return this.getDirectionToRef(t,e),e},e.prototype.getDirectionToRef=function(t,e){return s.e.TransformNormalToRef(t,this.getWorldMatrix(),e),this},e.prototype.setDirection=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0);var n=-Math.atan2(t.z,t.x)+Math.PI/2,o=Math.sqrt(t.x*t.x+t.z*t.z),a=-Math.atan2(t.y,o);return this.rotationQuaternion?s.b.RotationYawPitchRollToRef(n+e,a+i,r,this.rotationQuaternion):(this.rotation.x=a+i,this.rotation.y=n+e,this.rotation.z=r),this},e.prototype.setPivotPoint=function(t,e){void 0===e&&(e=h.b.LOCAL),0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);var i=this.getWorldMatrix();if(e==h.b.WORLD){var r=s.c.Matrix[0];i.invertToRef(r),t=s.e.TransformCoordinates(t,r)}return this.setPivotMatrix(s.a.Translation(-t.x,-t.y,-t.z),!0)},e.prototype.getPivotPoint=function(){var t=s.e.Zero();return this.getPivotPointToRef(t),t},e.prototype.getPivotPointToRef=function(t){return t.x=-this._pivotMatrix.m[12],t.y=-this._pivotMatrix.m[13],t.z=-this._pivotMatrix.m[14],this},e.prototype.getAbsolutePivotPoint=function(){var t=s.e.Zero();return this.getAbsolutePivotPointToRef(t),t},e.prototype.getAbsolutePivotPointToRef=function(t){return this.getPivotPointToRef(t),s.e.TransformCoordinatesToRef(t,this.getWorldMatrix(),t),this},e.prototype.setParent=function(t){if(!t&&!this.parent)return this;var e=s.c.Quaternion[0],i=s.c.Vector3[0],r=s.c.Vector3[1];if(t){var n=s.c.Matrix[0],o=s.c.Matrix[1];this.computeWorldMatrix(!0),t.computeWorldMatrix(!0),t.getWorldMatrix().invertToRef(o),this.getWorldMatrix().multiplyToRef(o,n),n.decompose(r,e,i)}else this.computeWorldMatrix(!0),this.getWorldMatrix().decompose(r,e,i);return this.rotationQuaternion?this.rotationQuaternion.copyFrom(e):e.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(r),this.position.copyFrom(i),this.parent=t,this},Object.defineProperty(e.prototype,"nonUniformScaling",{get:function(){return this._nonUniformScaling},enumerable:!1,configurable:!0}),e.prototype._updateNonUniformScalingState=function(t){return this._nonUniformScaling!==t&&(this._nonUniformScaling=t,!0)},e.prototype.attachToBone=function(t,e){return this._transformToBoneReferal=e,this.parent=t,t.getSkeleton().prepare(),t.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this},e.prototype.detachFromBone=function(){return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,this.parent=null,this):this},e.prototype.rotate=function(t,i,r){var n;if(t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0)),r&&r!==h.b.LOCAL){if(this.parent){var o=s.c.Matrix[0];this.parent.getWorldMatrix().invertToRef(o),t=s.e.TransformNormal(t,o)}(n=s.b.RotationAxisToRef(t,i,e._rotationAxisCache)).multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}else n=s.b.RotationAxisToRef(t,i,e._rotationAxisCache),this.rotationQuaternion.multiplyToRef(n,this.rotationQuaternion);return this},e.prototype.rotateAround=function(t,e,i){e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=s.b.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));var r=s.c.Vector3[0],n=s.c.Vector3[1],o=s.c.Vector3[2],a=s.c.Quaternion[0],h=s.c.Matrix[0],c=s.c.Matrix[1],u=s.c.Matrix[2],l=s.c.Matrix[3];return t.subtractToRef(this.position,r),s.a.TranslationToRef(r.x,r.y,r.z,h),s.a.TranslationToRef(-r.x,-r.y,-r.z,c),s.a.RotationAxisToRef(e,i,u),c.multiplyToRef(u,l),l.multiplyToRef(h,l),l.decompose(n,a,o),this.position.addInPlace(o),a.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this},e.prototype.translate=function(t,e,i){var r=t.scale(e);if(i&&i!==h.b.LOCAL)this.setAbsolutePosition(this.getAbsolutePosition().add(r));else{var n=this.getPositionExpressedInLocalSpace().add(r);this.setPositionWithLocalVector(n)}return this},e.prototype.addRotation=function(t,e,i){var r;this.rotationQuaternion?r=this.rotationQuaternion:(r=s.c.Quaternion[1],s.b.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,r));var n=s.c.Quaternion[0];return s.b.RotationYawPitchRollToRef(e,t,i,n),r.multiplyInPlace(n),this.rotationQuaternion||r.toEulerAnglesToRef(this.rotation),this},e.prototype._getEffectiveParent=function(){return this.parent},e.prototype.computeWorldMatrix=function(t){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;var i=this.getScene().getRenderId();if(!this._isDirty&&!t&&this.isSynchronized())return this._currentRenderId=i,this._worldMatrix;var r=this.getScene().activeCamera,n=0!=(this._billboardMode&e.BILLBOARDMODE_USE_POSITION),o=this._billboardMode!==e.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard;o&&r&&n&&(this.lookAt(r.position),(this.billboardMode&e.BILLBOARDMODE_X)!==e.BILLBOARDMODE_X&&(this.rotation.x=0),(this.billboardMode&e.BILLBOARDMODE_Y)!==e.BILLBOARDMODE_Y&&(this.rotation.y=0),(this.billboardMode&e.BILLBOARDMODE_Z)!==e.BILLBOARDMODE_Z&&(this.rotation.z=0)),this._updateCache();var a=this._cache;a.pivotMatrixUpdated=!1,a.billboardMode=this.billboardMode,a.infiniteDistance=this.infiniteDistance,this._currentRenderId=i,this._childUpdateId++,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;var h,c=this._getEffectiveParent(),u=e._TmpScaling,l=this._position;if(this._infiniteDistance&&!this.parent&&r){var f=r.getWorldMatrix(),d=new s.e(f.m[12],f.m[13],f.m[14]);(l=e._TmpTranslation).copyFromFloats(this._position.x+d.x,this._position.y+d.y,this._position.z+d.z)}(u.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant),this._rotationQuaternion)?(this._rotationQuaternion._isDirty=!1,h=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(s.b.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(h=e._TmpRotation,s.b.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,h));if(this._usePivotMatrix){var p=s.c.Matrix[1];s.a.ScalingToRef(u.x,u.y,u.z,p);var _=s.c.Matrix[0];h.toRotationMatrix(_),this._pivotMatrix.multiplyToRef(p,s.c.Matrix[4]),s.c.Matrix[4].multiplyToRef(_,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(l.x,l.y,l.z)}else s.a.ComposeToRef(u,h,l,this._localMatrix);if(c&&c.getWorldMatrix){if(t&&c.computeWorldMatrix(),o){this._transformToBoneReferal?c.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),s.c.Matrix[7]):s.c.Matrix[7].copyFrom(c.getWorldMatrix());var g=s.c.Vector3[5],m=s.c.Vector3[6];s.c.Matrix[7].decompose(m,void 0,g),s.a.ScalingToRef(m.x,m.y,m.z,s.c.Matrix[7]),s.c.Matrix[7].setTranslation(g),this._localMatrix.multiplyToRef(s.c.Matrix[7],this._worldMatrix)}else this._transformToBoneReferal?(this._localMatrix.multiplyToRef(c.getWorldMatrix(),s.c.Matrix[6]),s.c.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localMatrix.multiplyToRef(c.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(o&&r&&this.billboardMode&&!n){var y=s.c.Vector3[0];if(this._worldMatrix.getTranslationToRef(y),s.c.Matrix[1].copyFrom(r.getViewMatrix()),s.c.Matrix[1].setTranslationFromFloats(0,0,0),s.c.Matrix[1].invertToRef(s.c.Matrix[0]),(this.billboardMode&e.BILLBOARDMODE_ALL)!==e.BILLBOARDMODE_ALL){s.c.Matrix[0].decompose(void 0,s.c.Quaternion[0],void 0);var b=s.c.Vector3[1];s.c.Quaternion[0].toEulerAnglesToRef(b),(this.billboardMode&e.BILLBOARDMODE_X)!==e.BILLBOARDMODE_X&&(b.x=0),(this.billboardMode&e.BILLBOARDMODE_Y)!==e.BILLBOARDMODE_Y&&(b.y=0),(this.billboardMode&e.BILLBOARDMODE_Z)!==e.BILLBOARDMODE_Z&&(b.z=0),s.a.RotationYawPitchRollToRef(b.y,b.x,b.z,s.c.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(s.c.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(s.c.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):c&&c._nonUniformScaling?this._updateNonUniformScalingState(c._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=s.a.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix},e.prototype.resetLocalMatrix=function(t){if(void 0===t&&(t=!0),this.computeWorldMatrix(),t)for(var e=this.getChildren(),i=0;i<e.length;++i){var r=e[i];if(r){r.computeWorldMatrix();var n=s.c.Matrix[0];r._localMatrix.multiplyToRef(this._localMatrix,n);var o=s.c.Quaternion[0];n.decompose(r.scaling,o,r.position),r.rotationQuaternion?r.rotationQuaternion=o:o.toEulerAnglesToRef(r.rotation)}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=s.b.Identity()),this._worldMatrix=s.a.Identity()},e.prototype._afterComputeWorldMatrix=function(){},e.prototype.registerAfterWorldMatrixUpdate=function(t){return this.onAfterWorldMatrixUpdateObservable.add(t),this},e.prototype.unregisterAfterWorldMatrixUpdate=function(t){return this.onAfterWorldMatrixUpdateObservable.removeCallback(t),this},e.prototype.getPositionInCameraSpace=function(t){return void 0===t&&(t=null),t||(t=this.getScene().activeCamera),s.e.TransformCoordinates(this.getAbsolutePosition(),t.getViewMatrix())},e.prototype.getDistanceToCamera=function(t){return void 0===t&&(t=null),t||(t=this.getScene().activeCamera),this.getAbsolutePosition().subtract(t.globalPosition).length()},e.prototype.clone=function(t,i,r){var o=this,s=n.a.Clone((function(){return new e(t,o.getScene())}),this);if(s.name=t,s.id=t,i&&(s.parent=i),!r)for(var a=this.getDescendants(!0),h=0;h<a.length;h++){var c=a[h];c.clone&&c.clone(t+"."+c.name,s)}return s},e.prototype.serialize=function(t){var e=n.a.Serialize(this,t);return e.type=this.getClassName(),this.parent&&(e.parentId=this.parent.id),e.localMatrix=this.getPivotMatrix().asArray(),e.isEnabled=this.isEnabled(),this.parent&&(e.parentId=this.parent.id),e},e.Parse=function(t,i,r){var o=n.a.Parse((function(){return new e(t.name,i)}),t,i,r);return t.localMatrix?o.setPreTransformMatrix(s.a.FromArray(t.localMatrix)):t.pivotMatrix&&o.setPivotMatrix(s.a.FromArray(t.pivotMatrix)),o.setEnabled(t.isEnabled),t.parentId&&(o._waitingParentId=t.parentId),o},e.prototype.getChildTransformNodes=function(t,i){var r=[];return this._getDescendants(r,t,(function(t){return(!i||i(t))&&t instanceof e})),r},e.prototype.dispose=function(e,i){if(void 0===i&&(i=!1),this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this.onAfterWorldMatrixUpdateObservable.clear(),e)for(var r=0,n=this.getChildTransformNodes(!0);r<n.length;r++){var o=n[r];o.parent=null,o.computeWorldMatrix(!0)}t.prototype.dispose.call(this,e,i)},e.prototype.normalizeToUnitCube=function(t,e,i){void 0===t&&(t=!0),void 0===e&&(e=!1);var r=null,n=null;e&&(this.rotationQuaternion?(n=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(r=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));var o=this.getHierarchyBoundingVectors(t,i),s=o.max.subtract(o.min),a=Math.max(s.x,s.y,s.z);if(0===a)return this;var h=1/a;return this.scaling.scaleInPlace(h),e&&(this.rotationQuaternion&&n?this.rotationQuaternion.copyFrom(n):this.rotation&&r&&this.rotation.copyFrom(r)),this},e.prototype._syncAbsoluteScalingAndRotation=function(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)},e.BILLBOARDMODE_NONE=0,e.BILLBOARDMODE_X=1,e.BILLBOARDMODE_Y=2,e.BILLBOARDMODE_Z=4,e.BILLBOARDMODE_ALL=7,e.BILLBOARDMODE_USE_POSITION=128,e._TmpRotation=s.b.Zero(),e._TmpScaling=s.e.Zero(),e._TmpTranslation=s.e.Zero(),e._lookAtVectorCache=new s.e(0,0,0),e._rotationAxisCache=new s.b,Object(r.c)([Object(n.o)("position")],e.prototype,"_position",void 0),Object(r.c)([Object(n.o)("rotation")],e.prototype,"_rotation",void 0),Object(r.c)([Object(n.l)("rotationQuaternion")],e.prototype,"_rotationQuaternion",void 0),Object(r.c)([Object(n.o)("scaling")],e.prototype,"_scaling",void 0),Object(r.c)([Object(n.c)("billboardMode")],e.prototype,"_billboardMode",void 0),Object(r.c)([Object(n.c)()],e.prototype,"scalingDeterminant",void 0),Object(r.c)([Object(n.c)("infiniteDistance")],e.prototype,"_infiniteDistance",void 0),Object(r.c)([Object(n.c)()],e.prototype,"ignoreNonUniformScaling",void 0),Object(r.c)([Object(n.c)()],e.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0),e}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var r=i(3),n=i(37),o=i(34),s=i(36),a=i(47),h=i(122),c=i(35),u=function(t){function e(i,r){var n=t.call(this,i,r)||this;return n.diffuse=new s.a(1,1,1),n.specular=new s.a(1,1,1),n.falloffType=e.FALLOFF_DEFAULT,n.intensity=1,n._range=Number.MAX_VALUE,n._inverseSquaredRange=0,n._photometricScale=1,n._intensityMode=e.INTENSITYMODE_AUTOMATIC,n._radius=1e-5,n.renderPriority=0,n._shadowEnabled=!0,n._excludeWithLayerMask=0,n._includeOnlyWithLayerMask=0,n._lightmapMode=0,n._excludedMeshesIds=new Array,n._includedOnlyMeshesIds=new Array,n._isLight=!0,n.getScene().addLight(n),n._uniformBuffer=new h.a(n.getScene().getEngine()),n._buildUniformLayout(),n.includedOnlyMeshes=new Array,n.excludedMeshes=new Array,n._resyncMeshes(),n}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t,this._inverseSquaredRange=1/(this.range*this.range)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intensityMode",{get:function(){return this._intensityMode},set:function(t){this._intensityMode=t,this._computePhotometricScale()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._computePhotometricScale()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowEnabled",{get:function(){return this._shadowEnabled},set:function(t){this._shadowEnabled!==t&&(this._shadowEnabled=t,this._markMeshesAsLightDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"includedOnlyMeshes",{get:function(){return this._includedOnlyMeshes},set:function(t){this._includedOnlyMeshes=t,this._hookArrayForIncludedOnly(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"excludedMeshes",{get:function(){return this._excludedMeshes},set:function(t){this._excludedMeshes=t,this._hookArrayForExcluded(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"excludeWithLayerMask",{get:function(){return this._excludeWithLayerMask},set:function(t){this._excludeWithLayerMask=t,this._resyncMeshes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"includeOnlyWithLayerMask",{get:function(){return this._includeOnlyWithLayerMask},set:function(t){this._includeOnlyWithLayerMask=t,this._resyncMeshes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightmapMode",{get:function(){return this._lightmapMode},set:function(t){this._lightmapMode!==t&&(this._lightmapMode=t,this._markMeshesAsLightDirty())},enumerable:!1,configurable:!0}),e.prototype.transferTexturesToEffect=function(t,e){return this},e.prototype._bindLight=function(t,e,i,r,n){void 0===n&&(n=!1);var o=t.toString(),a=!1;if(!n||!this._uniformBuffer._alreadyBound){if(this._uniformBuffer.bindToEffect(i,"Light"+o),this._renderId!==e.getRenderId()||!this._uniformBuffer.useUbo){this._renderId=e.getRenderId();var h=this.getScaledIntensity();this.transferToEffect(i,o),this.diffuse.scaleToRef(h,s.c.Color3[0]),this._uniformBuffer.updateColor4("vLightDiffuse",s.c.Color3[0],this.range,o),r&&(this.specular.scaleToRef(h,s.c.Color3[1]),this._uniformBuffer.updateColor4("vLightSpecular",s.c.Color3[1],this.radius,o)),a=!0}if(this.transferTexturesToEffect(i,o),e.shadowsEnabled&&this.shadowEnabled){var c=this.getShadowGenerator();c&&(c.bindShadowLight(o,i),a=!0)}a&&this._uniformBuffer.update()}},e.prototype.getClassName=function(){return"Light"},e.prototype.toString=function(t){var e="Name: "+this.name;if(e+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(var i=0;i<this.animations.length;i++)e+=", animation[0]: "+this.animations[i].toString(t);return e},e.prototype._syncParentEnabledState=function(){t.prototype._syncParentEnabledState.call(this),this.isDisposed()||this._resyncMeshes()},e.prototype.setEnabled=function(e){t.prototype.setEnabled.call(this,e),this._resyncMeshes()},e.prototype.getShadowGenerator=function(){return this._shadowGenerator},e.prototype.getAbsolutePosition=function(){return o.e.Zero()},e.prototype.canAffectMesh=function(t){return!t||!(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(t))&&(!(this.excludedMeshes&&this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(t))&&((0===this.includeOnlyWithLayerMask||0!=(this.includeOnlyWithLayerMask&t.layerMask))&&!(0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&t.layerMask)))},e.CompareLightsPriority=function(t,e){return t.shadowEnabled!==e.shadowEnabled?(e.shadowEnabled?1:0)-(t.shadowEnabled?1:0):e.renderPriority-t.renderPriority},e.prototype.dispose=function(e,i){void 0===i&&(i=!1),this._shadowGenerator&&(this._shadowGenerator.dispose(),this._shadowGenerator=null),this.getScene().stopAnimation(this);for(var r=0,n=this.getScene().meshes;r<n.length;r++){n[r]._removeLightSource(this,!0)}this._uniformBuffer.dispose(),this.getScene().removeLight(this),t.prototype.dispose.call(this,e,i)},e.prototype.getTypeID=function(){return 0},e.prototype.getScaledIntensity=function(){return this._photometricScale*this.intensity},e.prototype.clone=function(t,i){void 0===i&&(i=null);var r=e.GetConstructorFromName(this.getTypeID(),t,this.getScene());if(!r)return null;var o=n.a.Clone(r,this);return i&&(o.parent=i),o.setEnabled(this.isEnabled()),o},e.prototype.serialize=function(){var t=n.a.Serialize(this);return t.type=this.getTypeID(),this.parent&&(t.parentId=this.parent.id),this.excludedMeshes.length>0&&(t.excludedMeshesIds=[],this.excludedMeshes.forEach((function(e){t.excludedMeshesIds.push(e.id)}))),this.includedOnlyMeshes.length>0&&(t.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach((function(e){t.includedOnlyMeshesIds.push(e.id)}))),n.a.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t},e.GetConstructorFromName=function(t,e,i){var r=a.a.Construct("Light_Type_"+t,e,i);return r||null},e.Parse=function(t,i){var r=e.GetConstructorFromName(t.type,t.name,i);if(!r)return null;var o=n.a.Parse(r,t,i);if(t.excludedMeshesIds&&(o._excludedMeshesIds=t.excludedMeshesIds),t.includedOnlyMeshesIds&&(o._includedOnlyMeshesIds=t.includedOnlyMeshesIds),t.parentId&&(o._waitingParentId=t.parentId),void 0!==t.falloffType&&(o.falloffType=t.falloffType),void 0!==t.lightmapMode&&(o.lightmapMode=t.lightmapMode),t.animations){for(var s=0;s<t.animations.length;s++){var h=t.animations[s],u=c.a.GetClass("BABYLON.Animation");u&&o.animations.push(u.Parse(h))}a.a.ParseAnimationRanges(o,t,i)}return t.autoAnimate&&i.beginAnimation(o,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),o},e.prototype._hookArrayForExcluded=function(t){var e=this,i=t.push;t.push=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var o=i.apply(t,r),s=0,a=r;s<a.length;s++){var h=a[s];h._resyncLightSource(e)}return o};var r=t.splice;t.splice=function(i,n){for(var o=r.apply(t,[i,n]),s=0,a=o;s<a.length;s++){a[s]._resyncLightSource(e)}return o};for(var n=0,o=t;n<o.length;n++){o[n]._resyncLightSource(this)}},e.prototype._hookArrayForIncludedOnly=function(t){var e=this,i=t.push;t.push=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=i.apply(t,r);return e._resyncMeshes(),o};var r=t.splice;t.splice=function(i,n){var o=r.apply(t,[i,n]);return e._resyncMeshes(),o},this._resyncMeshes()},e.prototype._resyncMeshes=function(){for(var t=0,e=this.getScene().meshes;t<e.length;t++){e[t]._resyncLightSource(this)}},e.prototype._markMeshesAsLightDirty=function(){for(var t=0,e=this.getScene().meshes;t<e.length;t++){var i=e[t];-1!==i.lightSources.indexOf(this)&&i._markSubMeshesAsLightDirty()}},e.prototype._computePhotometricScale=function(){this._photometricScale=this._getPhotometricScale(),this.getScene().resetCachedMaterial()},e.prototype._getPhotometricScale=function(){var t=0,i=this.getTypeID(),r=this.intensityMode;switch(r===e.INTENSITYMODE_AUTOMATIC&&(r=i===e.LIGHTTYPEID_DIRECTIONALLIGHT?e.INTENSITYMODE_ILLUMINANCE:e.INTENSITYMODE_LUMINOUSINTENSITY),i){case e.LIGHTTYPEID_POINTLIGHT:case e.LIGHTTYPEID_SPOTLIGHT:switch(r){case e.INTENSITYMODE_LUMINOUSPOWER:t=1/(4*Math.PI);break;case e.INTENSITYMODE_LUMINOUSINTENSITY:t=1;break;case e.INTENSITYMODE_LUMINANCE:t=this.radius*this.radius}break;case e.LIGHTTYPEID_DIRECTIONALLIGHT:switch(r){case e.INTENSITYMODE_ILLUMINANCE:t=1;break;case e.INTENSITYMODE_LUMINANCE:var n=this.radius;n=Math.max(n,.001),t=2*Math.PI*(1-Math.cos(n))}break;case e.LIGHTTYPEID_HEMISPHERICLIGHT:t=1}return t},e.prototype._reorderLightsInScene=function(){var t=this.getScene();0!=this._renderPriority&&(t.requireLightSorting=!0),this.getScene().sortLightsByPriority()},e.FALLOFF_DEFAULT=0,e.FALLOFF_PHYSICAL=1,e.FALLOFF_GLTF=2,e.FALLOFF_STANDARD=3,e.LIGHTMAP_DEFAULT=0,e.LIGHTMAP_SPECULAR=1,e.LIGHTMAP_SHADOWSONLY=2,e.INTENSITYMODE_AUTOMATIC=0,e.INTENSITYMODE_LUMINOUSPOWER=1,e.INTENSITYMODE_LUMINOUSINTENSITY=2,e.INTENSITYMODE_ILLUMINANCE=3,e.INTENSITYMODE_LUMINANCE=4,e.LIGHTTYPEID_POINTLIGHT=0,e.LIGHTTYPEID_DIRECTIONALLIGHT=1,e.LIGHTTYPEID_SPOTLIGHT=2,e.LIGHTTYPEID_HEMISPHERICLIGHT=3,Object(r.c)([Object(n.e)()],e.prototype,"diffuse",void 0),Object(r.c)([Object(n.e)()],e.prototype,"specular",void 0),Object(r.c)([Object(n.c)()],e.prototype,"falloffType",void 0),Object(r.c)([Object(n.c)()],e.prototype,"intensity",void 0),Object(r.c)([Object(n.c)()],e.prototype,"range",null),Object(r.c)([Object(n.c)()],e.prototype,"intensityMode",null),Object(r.c)([Object(n.c)()],e.prototype,"radius",null),Object(r.c)([Object(n.c)()],e.prototype,"_renderPriority",void 0),Object(r.c)([Object(n.b)("_reorderLightsInScene")],e.prototype,"renderPriority",void 0),Object(r.c)([Object(n.c)("shadowEnabled")],e.prototype,"_shadowEnabled",void 0),Object(r.c)([Object(n.c)("excludeWithLayerMask")],e.prototype,"_excludeWithLayerMask",void 0),Object(r.c)([Object(n.c)("includeOnlyWithLayerMask")],e.prototype,"_includeOnlyWithLayerMask",void 0),Object(r.c)([Object(n.c)("lightmapMode")],e.prototype,"_lightmapMode",void 0),e}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var r=i(3),n=i(37),o=i(0),s=i(34),a=i(6),h=i(198),c=i(121),u=(i(120),function(){function t(e){this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this.getAlphaFromRGB=!1,this.level=1,this.coordinatesIndex=0,this._coordinatesMode=0,this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=t.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this.animations=new Array,this.onDisposeObservable=new o.a,this._onDisposeObserver=null,this.delayLoadState=0,this._scene=null,this._engine=null,this._texture=null,this._uid=null,this._cachedSize=c.a.Zero(),e?t._isScene(e)?this._scene=e:this._engine=e:this._scene=a.a.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._uid=null}return Object.defineProperty(t.prototype,"hasAlpha",{get:function(){return this._hasAlpha},set:function(t){this._hasAlpha!==t&&(this._hasAlpha=t,this._scene&&this._scene.markAllMaterialsAsDirty(17))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coordinatesMode",{get:function(){return this._coordinatesMode},set:function(t){this._coordinatesMode!==t&&(this._coordinatesMode=t,this._scene&&this._scene.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapU",{get:function(){return this._wrapU},set:function(t){this._wrapU=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapV",{get:function(){return this._wrapV},set:function(t){this._wrapV=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(t){this._texture&&(this._texture.isCube=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(t){this._texture&&(this._texture.is3D=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(t){this._texture&&(this._texture.is2DArray=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gammaSpace",{get:function(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace):this._gammaSpace},set:function(t){if(this._texture){if(this._texture._gammaSpace===t)return;this._texture._gammaSpace=t}else{if(this._gammaSpace===t)return;this._gammaSpace=t}this._markAllSubMeshesAsTexturesDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRGBD",{get:function(){return null!=this._texture&&this._texture._isRGBD},set:function(t){this._texture&&(this._texture._isRGBD=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"noMipmap",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lodGenerationOffset",{get:function(){return this._texture?this._texture._lodGenerationOffset:0},set:function(t){this._texture&&(this._texture._lodGenerationOffset=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lodGenerationScale",{get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(t){this._texture&&(this._texture._lodGenerationScale=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linearSpecularLOD",{get:function(){return!!this._texture&&this._texture._linearSpecularLOD},set:function(t){this._texture&&(this._texture._linearSpecularLOD=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"irradianceTexture",{get:function(){return this._texture?this._texture._irradianceTexture:null},set:function(t){this._texture&&(this._texture._irradianceTexture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uid",{get:function(){return this._uid||(this._uid=h.a.RandomId()),this._uid},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.name},t.prototype.getClassName=function(){return"BaseTexture"},Object.defineProperty(t.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBlocking",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype._getEngine=function(){return this._engine},t.prototype.getTextureMatrix=function(){return s.a.IdentityReadOnly},t.prototype.getReflectionTextureMatrix=function(){return s.a.IdentityReadOnly},t.prototype.getInternalTexture=function(){return this._texture},t.prototype.isReadyOrNotBlocking=function(){return!this.isBlocking||this.isReady()},t.prototype.isReady=function(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},t.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},t.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?new c.a(this._texture._size,this._texture._size):new c.a(this._texture.baseWidth,this._texture.baseHeight):c.a.Zero()},t.prototype.updateSamplingMode=function(t){if(this._texture){var e=this._getEngine();e&&e.updateTextureSamplingMode(t,this._texture)}},t.prototype.scale=function(t){},Object.defineProperty(t.prototype,"canRescale",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype._getFromCache=function(t,e,i,r){var n=this._getEngine();if(!n)return null;for(var o=n.getLoadedTexturesCache(),s=0;s<o.length;s++){var a=o[s];if(!(void 0!==r&&r!==a.invertY||a.url!==t||a.generateMipMaps!==!e||i&&i!==a.samplingMode))return a.incrementReferences(),a}return null},t.prototype._rebuild=function(){},t.prototype.delayLoad=function(){},t.prototype.clone=function(){return null},Object.defineProperty(t.prototype,"textureType",{get:function(){return this._texture&&void 0!==this._texture.type?this._texture.type:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textureFormat",{get:function(){return this._texture&&void 0!==this._texture.format?this._texture.format:5},enumerable:!1,configurable:!0}),t.prototype._markAllSubMeshesAsTexturesDirty=function(){var t=this.getScene();t&&t.markAllMaterialsAsDirty(1)},t.prototype.readPixels=function(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),!this._texture)return null;var r=this.getSize(),n=r.width,o=r.height,s=this._getEngine();if(!s)return null;0!=e&&(n/=Math.pow(2,e),o/=Math.pow(2,e),n=Math.round(n),o=Math.round(o));try{return this._texture.isCube?s._readTexturePixels(this._texture,n,o,t,e,i):s._readTexturePixels(this._texture,n,o,-1,e,i)}catch(t){return null}},t.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},Object.defineProperty(t.prototype,"_lodTextureHigh",{get:function(){return this._texture?this._texture._lodTextureHigh:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_lodTextureMid",{get:function(){return this._texture?this._texture._lodTextureMid:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_lodTextureLow",{get:function(){return this._texture?this._texture._lodTextureLow:null},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene._removePendingData(this);var t=this._scene.textures.indexOf(this);t>=0&&this._scene.textures.splice(t,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null}void 0!==this._texture&&(this.releaseInternalTexture(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._engine=null)},t.prototype.serialize=function(){if(!this.name)return null;var t=n.a.Serialize(this);return n.a.AppendSerializedAnimations(this,t),t},t.WhenAllReady=function(t,e){var i=t.length;if(0!==i)for(var r,n,o=function(){if((r=t[s]).isReady())0==--i&&e();else if(n=r.onLoadObservable){var o=function(){n.removeCallback(o),0==--i&&e()};n.add(o)}},s=0;s<t.length;s++)o();else e()},t._isScene=function(t){return"Scene"===t.getClassName()},t.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,Object(r.c)([Object(n.c)()],t.prototype,"uniqueId",void 0),Object(r.c)([Object(n.c)()],t.prototype,"name",void 0),Object(r.c)([Object(n.c)()],t.prototype,"metadata",void 0),Object(r.c)([Object(n.c)("hasAlpha")],t.prototype,"_hasAlpha",void 0),Object(r.c)([Object(n.c)()],t.prototype,"getAlphaFromRGB",void 0),Object(r.c)([Object(n.c)()],t.prototype,"level",void 0),Object(r.c)([Object(n.c)()],t.prototype,"coordinatesIndex",void 0),Object(r.c)([Object(n.c)("coordinatesMode")],t.prototype,"_coordinatesMode",void 0),Object(r.c)([Object(n.c)()],t.prototype,"wrapU",null),Object(r.c)([Object(n.c)()],t.prototype,"wrapV",null),Object(r.c)([Object(n.c)()],t.prototype,"wrapR",void 0),Object(r.c)([Object(n.c)()],t.prototype,"anisotropicFilteringLevel",void 0),Object(r.c)([Object(n.c)()],t.prototype,"isCube",null),Object(r.c)([Object(n.c)()],t.prototype,"is3D",null),Object(r.c)([Object(n.c)()],t.prototype,"is2DArray",null),Object(r.c)([Object(n.c)()],t.prototype,"gammaSpace",null),Object(r.c)([Object(n.c)()],t.prototype,"invertZ",void 0),Object(r.c)([Object(n.c)()],t.prototype,"lodLevelInAlpha",void 0),Object(r.c)([Object(n.c)()],t.prototype,"lodGenerationOffset",null),Object(r.c)([Object(n.c)()],t.prototype,"lodGenerationScale",null),Object(r.c)([Object(n.c)()],t.prototype,"linearSpecularLOD",null),Object(r.c)([Object(n.m)()],t.prototype,"irradianceTexture",null),Object(r.c)([Object(n.c)()],t.prototype,"isRenderTarget",void 0),t}())},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var r=i(3),n=i(37),o=i(34),s=i(36),a=i(47),h=i(70);a.a.AddNodeConstructor("Light_Type_3",(function(t,e){return function(){return new c(t,o.e.Zero(),e)}}));var c=function(t){function e(e,i,r){var n=t.call(this,e,r)||this;return n.groundColor=new s.a(0,0,0),n.direction=i||o.e.Up(),n}return Object(r.d)(e,t),e.prototype._buildUniformLayout=function(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("vLightGround",3),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()},e.prototype.getClassName=function(){return"HemisphericLight"},e.prototype.setDirectionToTarget=function(t){return this.direction=o.e.Normalize(t.subtract(o.e.Zero())),this.direction},e.prototype.getShadowGenerator=function(){return null},e.prototype.transferToEffect=function(t,e){var i=o.e.Normalize(this.direction);return this._uniformBuffer.updateFloat4("vLightData",i.x,i.y,i.z,0,e),this._uniformBuffer.updateColor3("vLightGround",this.groundColor.scale(this.intensity),e),this},e.prototype.transferToNodeMaterialEffect=function(t,e){var i=o.e.Normalize(this.direction);return t.setFloat3(e,i.x,i.y,i.z),this},e.prototype.computeWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=o.a.Identity()),this._worldMatrix},e.prototype.getTypeID=function(){return h.a.LIGHTTYPEID_HEMISPHERICLIGHT},e.prototype.prepareLightSpecificDefines=function(t,e){t["HEMILIGHT"+e]=!0},Object(r.c)([Object(n.e)()],e.prototype,"groundColor",void 0),Object(r.c)([Object(n.o)()],e.prototype,"direction",void 0),e}(h.a)},,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){this._xhr=new XMLHttpRequest}return t.prototype._injectCustomRequestHeaders=function(){for(var e in t.CustomRequestHeaders){var i=t.CustomRequestHeaders[e];i&&this._xhr.setRequestHeader(e,i)}},Object.defineProperty(t.prototype,"onprogress",{get:function(){return this._xhr.onprogress},set:function(t){this._xhr.onprogress=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._xhr.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._xhr.status},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"statusText",{get:function(){return this._xhr.statusText},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this._xhr.response},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseURL",{get:function(){return this._xhr.responseURL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseText",{get:function(){return this._xhr.responseText},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseType",{get:function(){return this._xhr.responseType},set:function(t){this._xhr.responseType=t},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(t,e,i){this._xhr.addEventListener(t,e,i)},t.prototype.removeEventListener=function(t,e,i){this._xhr.removeEventListener(t,e,i)},t.prototype.abort=function(){this._xhr.abort()},t.prototype.send=function(e){t.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)},t.prototype.open=function(e,i){for(var r=0,n=t.CustomRequestModifiers;r<n.length;r++){(0,n[r])(this._xhr,i)}return i=(i=i.replace("file:http:","http:")).replace("file:https:","https:"),this._xhr.open(e,i,!0)},t.prototype.setRequestHeader=function(t,e){this._xhr.setRequestHeader(t,e)},t.prototype.getResponseHeader=function(t){return this._xhr.getResponseHeader(t)},t.CustomRequestHeaders={},t.CustomRequestModifiers=new Array,t}()},function(t,e,i){"use strict";i.d(e,"b",(function(){return u})),i.d(e,"a",(function(){return l}));var r=i(3),n=i(37),o=i(0),s=i(41),a=i(36),h=i(106),c=i(201),u=function(t){function e(){var e=t.call(this)||this;return e.IMAGEPROCESSING=!1,e.VIGNETTE=!1,e.VIGNETTEBLENDMODEMULTIPLY=!1,e.VIGNETTEBLENDMODEOPAQUE=!1,e.TONEMAPPING=!1,e.TONEMAPPING_ACES=!1,e.CONTRAST=!1,e.COLORCURVES=!1,e.COLORGRADING=!1,e.COLORGRADING3D=!1,e.SAMPLER3DGREENDEPTH=!1,e.SAMPLER3DBGRMAP=!1,e.IMAGEPROCESSINGPOSTPROCESS=!1,e.EXPOSURE=!1,e.rebuild(),e}return Object(r.d)(e,t),e}(h.a),l=function(){function t(){this.colorCurves=new c.a,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=t.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCentreX=0,this.vignetteCentreY=0,this.vignetteWeight=1.5,this.vignetteColor=new a.b(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=t.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new o.a}return Object.defineProperty(t.prototype,"colorCurvesEnabled",{get:function(){return this._colorCurvesEnabled},set:function(t){this._colorCurvesEnabled!==t&&(this._colorCurvesEnabled=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorGradingTexture",{get:function(){return this._colorGradingTexture},set:function(t){this._colorGradingTexture!==t&&(this._colorGradingTexture=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorGradingEnabled",{get:function(){return this._colorGradingEnabled},set:function(t){this._colorGradingEnabled!==t&&(this._colorGradingEnabled=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorGradingWithGreenDepth",{get:function(){return this._colorGradingWithGreenDepth},set:function(t){this._colorGradingWithGreenDepth!==t&&(this._colorGradingWithGreenDepth=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorGradingBGR",{get:function(){return this._colorGradingBGR},set:function(t){this._colorGradingBGR!==t&&(this._colorGradingBGR=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exposure",{get:function(){return this._exposure},set:function(t){this._exposure!==t&&(this._exposure=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"toneMappingEnabled",{get:function(){return this._toneMappingEnabled},set:function(t){this._toneMappingEnabled!==t&&(this._toneMappingEnabled=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"toneMappingType",{get:function(){return this._toneMappingType},set:function(t){this._toneMappingType!==t&&(this._toneMappingType=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contrast",{get:function(){return this._contrast},set:function(t){this._contrast!==t&&(this._contrast=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vignetteBlendMode",{get:function(){return this._vignetteBlendMode},set:function(t){this._vignetteBlendMode!==t&&(this._vignetteBlendMode=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vignetteEnabled",{get:function(){return this._vignetteEnabled},set:function(t){this._vignetteEnabled!==t&&(this._vignetteEnabled=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"applyByPostProcess",{get:function(){return this._applyByPostProcess},set:function(t){this._applyByPostProcess!==t&&(this._applyByPostProcess=t,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(t){this._isEnabled!==t&&(this._isEnabled=t,this._updateParameters())},enumerable:!1,configurable:!0}),t.prototype._updateParameters=function(){this.onUpdateParameters.notifyObservers(this)},t.prototype.getClassName=function(){return"ImageProcessingConfiguration"},t.PrepareUniforms=function(t,e){e.EXPOSURE&&t.push("exposureLinear"),e.CONTRAST&&t.push("contrast"),e.COLORGRADING&&t.push("colorTransformSettings"),e.VIGNETTE&&(t.push("vInverseScreenSize"),t.push("vignetteSettings1"),t.push("vignetteSettings2")),e.COLORCURVES&&c.a.PrepareUniforms(t)},t.PrepareSamplers=function(t,e){e.COLORGRADING&&t.push("txColorTransform")},t.prototype.prepareDefines=function(e,i){if(void 0===i&&(i=!1),i!==this.applyByPostProcess||!this._isEnabled)return e.VIGNETTE=!1,e.TONEMAPPING=!1,e.TONEMAPPING_ACES=!1,e.CONTRAST=!1,e.EXPOSURE=!1,e.COLORCURVES=!1,e.COLORGRADING=!1,e.COLORGRADING3D=!1,e.IMAGEPROCESSING=!1,void(e.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled);switch(e.VIGNETTE=this.vignetteEnabled,e.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===t._VIGNETTEMODE_MULTIPLY,e.VIGNETTEBLENDMODEOPAQUE=!e.VIGNETTEBLENDMODEMULTIPLY,e.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType){case t.TONEMAPPING_ACES:e.TONEMAPPING_ACES=!0;break;default:e.TONEMAPPING_ACES=!1}e.CONTRAST=1!==this.contrast,e.EXPOSURE=1!==this.exposure,e.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,e.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,e.COLORGRADING?e.COLORGRADING3D=this.colorGradingTexture.is3D:e.COLORGRADING3D=!1,e.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,e.SAMPLER3DBGRMAP=this.colorGradingBGR,e.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,e.IMAGEPROCESSING=e.VIGNETTE||e.TONEMAPPING||e.CONTRAST||e.EXPOSURE||e.COLORCURVES||e.COLORGRADING},t.prototype.isReady=function(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()},t.prototype.bind=function(t,e){if(this._colorCurvesEnabled&&this.colorCurves&&c.a.Bind(this.colorCurves,t),this._vignetteEnabled){var i=1/t.getEngine().getRenderWidth(),r=1/t.getEngine().getRenderHeight();t.setFloat2("vInverseScreenSize",i,r);var n=null!=e?e:r/i,o=Math.tan(.5*this.vignetteCameraFov),a=o*n,h=Math.sqrt(a*o);a=s.b.Mix(a,h,this.vignetteStretch),o=s.b.Mix(o,h,this.vignetteStretch),t.setFloat4("vignetteSettings1",a,o,-a*this.vignetteCentreX,-o*this.vignetteCentreY);var u=-2*this.vignetteWeight;t.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,u)}if(t.setFloat("exposureLinear",this.exposure),t.setFloat("contrast",this.contrast),this.colorGradingTexture){t.setTexture("txColorTransform",this.colorGradingTexture);var l=this.colorGradingTexture.getSize().height;t.setFloat4("colorTransformSettings",(l-1)/l,.5/l,l,this.colorGradingTexture.level)}},t.prototype.clone=function(){return n.a.Clone((function(){return new t}),this)},t.prototype.serialize=function(){return n.a.Serialize(this)},t.Parse=function(e){return n.a.Parse((function(){return new t}),e,null,null)},Object.defineProperty(t,"VIGNETTEMODE_MULTIPLY",{get:function(){return this._VIGNETTEMODE_MULTIPLY},enumerable:!1,configurable:!0}),Object.defineProperty(t,"VIGNETTEMODE_OPAQUE",{get:function(){return this._VIGNETTEMODE_OPAQUE},enumerable:!1,configurable:!0}),t.TONEMAPPING_STANDARD=0,t.TONEMAPPING_ACES=1,t._VIGNETTEMODE_MULTIPLY=0,t._VIGNETTEMODE_OPAQUE=1,Object(r.c)([Object(n.g)()],t.prototype,"colorCurves",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_colorCurvesEnabled",void 0),Object(r.c)([Object(n.m)("colorGradingTexture")],t.prototype,"_colorGradingTexture",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_colorGradingEnabled",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_colorGradingWithGreenDepth",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_colorGradingBGR",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_exposure",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_toneMappingEnabled",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_toneMappingType",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_contrast",void 0),Object(r.c)([Object(n.c)()],t.prototype,"vignetteStretch",void 0),Object(r.c)([Object(n.c)()],t.prototype,"vignetteCentreX",void 0),Object(r.c)([Object(n.c)()],t.prototype,"vignetteCentreY",void 0),Object(r.c)([Object(n.c)()],t.prototype,"vignetteWeight",void 0),Object(r.c)([Object(n.f)()],t.prototype,"vignetteColor",void 0),Object(r.c)([Object(n.c)()],t.prototype,"vignetteCameraFov",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_vignetteBlendMode",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_vignetteEnabled",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_applyByPostProcess",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_isEnabled",void 0),t}();n.a._ImageProcessingConfigurationParser=l.Parse},function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var r=i(3),n=i(37),o=i(0),s=i(34),a=i(47),h=i(38),c=i(207),u=i(208),l=i(209),f=i(45),d=i(92),p=i(144),_=i(60);a.a.AddNodeConstructor("ArcRotateCamera",(function(t,e){return function(){return new g(t,0,0,1,s.e.Zero(),e)}}));var g=function(t){function e(e,i,r,n,a,h,c){void 0===c&&(c=!0);var u=t.call(this,e,s.e.Zero(),h,c)||this;return u.inertialAlphaOffset=0,u.inertialBetaOffset=0,u.inertialRadiusOffset=0,u.lowerAlphaLimit=null,u.upperAlphaLimit=null,u.lowerBetaLimit=.01,u.upperBetaLimit=Math.PI-.01,u.lowerRadiusLimit=null,u.upperRadiusLimit=null,u.inertialPanningX=0,u.inertialPanningY=0,u.pinchToPanMaxDistance=20,u.panningDistanceLimit=null,u.panningOriginTarget=s.e.Zero(),u.panningInertia=.9,u.zoomOnFactor=1,u.targetScreenOffset=s.d.Zero(),u.allowUpsideDown=!0,u.useInputToRestoreState=!0,u._viewMatrix=new s.a,u.panningAxis=new s.e(1,1,0),u.onMeshTargetChangedObservable=new o.a,u.checkCollisions=!1,u.collisionRadius=new s.e(.5,.5,.5),u._previousPosition=s.e.Zero(),u._collisionVelocity=s.e.Zero(),u._newPosition=s.e.Zero(),u._computationVector=s.e.Zero(),u._onCollisionPositionChange=function(t,e,i){void 0===i&&(i=null),i?(u.setPosition(e),u.onCollide&&u.onCollide(i)):u._previousPosition.copyFrom(u._position);var r=Math.cos(u.alpha),n=Math.sin(u.alpha),o=Math.cos(u.beta),s=Math.sin(u.beta);0===s&&(s=1e-4);var a=u._getTargetPosition();u._computationVector.copyFromFloats(u.radius*r*s,u.radius*o,u.radius*n*s),a.addToRef(u._computationVector,u._newPosition),u._position.copyFrom(u._newPosition);var h=u.upVector;u.allowUpsideDown&&u.beta<0&&(h=(h=h.clone()).negate()),u._computeViewMatrix(u._position,a,h),u._viewMatrix.addAtIndex(12,u.targetScreenOffset.x),u._viewMatrix.addAtIndex(13,u.targetScreenOffset.y),u._collisionTriggered=!1},u._target=s.e.Zero(),a&&u.setTarget(a),u.alpha=i,u.beta=r,u.radius=n,u.getViewMatrix(),u.inputs=new p.a(u),u.inputs.addKeyboard().addMouseWheel().addPointers(),u}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this.setTarget(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this.setPosition(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upVector",{get:function(){return this._upVector},set:function(t){this._upToYMatrix||(this._YToUpMatrix=new s.a,this._upToYMatrix=new s.a,this._upVector=s.e.Zero()),t.normalize(),this._upVector.copyFrom(t),this.setMatUp()},enumerable:!1,configurable:!0}),e.prototype.setMatUp=function(){s.a.RotationAlignToRef(s.e.UpReadOnly,this._upVector,this._YToUpMatrix),s.a.RotationAlignToRef(this._upVector,s.e.UpReadOnly,this._upToYMatrix)},Object.defineProperty(e.prototype,"angularSensibilityX",{get:function(){var t=this.inputs.attached.pointers;return t?t.angularSensibilityX:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.angularSensibilityX=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angularSensibilityY",{get:function(){var t=this.inputs.attached.pointers;return t?t.angularSensibilityY:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.angularSensibilityY=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pinchPrecision",{get:function(){var t=this.inputs.attached.pointers;return t?t.pinchPrecision:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.pinchPrecision=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pinchDeltaPercentage",{get:function(){var t=this.inputs.attached.pointers;return t?t.pinchDeltaPercentage:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.pinchDeltaPercentage=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useNaturalPinchZoom",{get:function(){var t=this.inputs.attached.pointers;return!!t&&t.useNaturalPinchZoom},set:function(t){var e=this.inputs.attached.pointers;e&&(e.useNaturalPinchZoom=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"panningSensibility",{get:function(){var t=this.inputs.attached.pointers;return t?t.panningSensibility:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.panningSensibility=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keysUp",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysUp:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysUp=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keysDown",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysDown:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysDown=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keysLeft",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysLeft:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysLeft=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keysRight",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysRight:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysRight=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wheelPrecision",{get:function(){var t=this.inputs.attached.mousewheel;return t?t.wheelPrecision:0},set:function(t){var e=this.inputs.attached.mousewheel;e&&(e.wheelPrecision=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wheelDeltaPercentage",{get:function(){var t=this.inputs.attached.mousewheel;return t?t.wheelDeltaPercentage:0},set:function(t){var e=this.inputs.attached.mousewheel;e&&(e.wheelDeltaPercentage=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bouncingBehavior",{get:function(){return this._bouncingBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useBouncingBehavior",{get:function(){return null!=this._bouncingBehavior},set:function(t){t!==this.useBouncingBehavior&&(t?(this._bouncingBehavior=new u.a,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"framingBehavior",{get:function(){return this._framingBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useFramingBehavior",{get:function(){return null!=this._framingBehavior},set:function(t){t!==this.useFramingBehavior&&(t?(this._framingBehavior=new l.a,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoRotationBehavior",{get:function(){return this._autoRotationBehavior},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useAutoRotationBehavior",{get:function(){return null!=this._autoRotationBehavior},set:function(t){t!==this.useAutoRotationBehavior&&(t?(this._autoRotationBehavior=new c.a,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))},enumerable:!1,configurable:!0}),e.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache._target=new s.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=s.d.Zero()},e.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)},e.prototype._getTargetPosition=function(){if(this._targetHost&&this._targetHost.getAbsolutePosition){var t=this._targetHost.absolutePosition;this._targetBoundingCenter?t.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(t)}var e=this._getLockedTargetPosition();return e||this._target},e.prototype.storeState=function(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),this._storedTargetScreenOffset=this.targetScreenOffset.clone(),t.prototype.storeState.call(this)},e.prototype._restoreStateValues=function(){return!!t.prototype._restoreStateValues.call(this)&&(this.setTarget(this._storedTarget.clone()),this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.targetScreenOffset=this._storedTargetScreenOffset.clone(),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0)},e.prototype._isSynchronizedViewMatrix=function(){return!!t.prototype._isSynchronizedViewMatrix.call(this)&&(this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset))},e.prototype.attachControl=function(t,e,i,r){var n=this;void 0===i&&(i=!0),void 0===r&&(r=2),this._useCtrlForPanning=i,this._panningMouseButton=r,this.inputs.attachElement(t,e),this._reset=function(){n.inertialAlphaOffset=0,n.inertialBetaOffset=0,n.inertialRadiusOffset=0,n.inertialPanningX=0,n.inertialPanningY=0}},e.prototype.detachControl=function(t){this.inputs.detachElement(t),this._reset&&this._reset()},e.prototype._checkInputs=function(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){var e=this.inertialAlphaOffset;this.beta<=0&&(e*=-1),this.getScene().useRightHandedSystem&&(e*=-1),this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(e*=-1),this.alpha+=e,this.beta+=this.inertialBetaOffset,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<_.a&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<_.a&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*_.a&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY){if(this._localDirection||(this._localDirection=s.e.Zero(),this._transformedDirection=s.e.Zero()),this._localDirection.copyFromFloats(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY),this._localDirection.multiplyInPlace(this.panningAxis),this._viewMatrix.invertToRef(this._cameraTransformMatrix),s.e.TransformNormalToRef(this._localDirection,this._cameraTransformMatrix,this._transformedDirection),this.panningAxis.y||(this._transformedDirection.y=0),!this._targetHost)if(this.panningDistanceLimit)this._transformedDirection.addInPlace(this._target),s.e.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection);else this._target.addInPlace(this._transformedDirection);this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*_.a&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*_.a&&(this.inertialPanningY=0)}this._checkLimits(),t.prototype._checkInputs.call(this)}},e.prototype._checkLimits=function(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)},e.prototype.rebuildAnglesAndRadius=function(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||s.e.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector),this.radius=this._computationVector.length(),0===this.radius&&(this.radius=1e-4),0===this._computationVector.x&&0===this._computationVector.z?this.alpha=Math.PI/2:this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha),this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()},e.prototype.setPosition=function(t){this._position.equals(t)||(this._position.copyFrom(t),this.rebuildAnglesAndRadius())},e.prototype.setTarget=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),t.getBoundingInfo)this._targetBoundingCenter=e?t.getBoundingInfo().boundingBox.centerWorld.clone():null,t.computeWorldMatrix(),this._targetHost=t,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{var r=t,n=this._getTargetPosition();if(n&&!i&&n.equals(r))return;this._targetHost=null,this._target=r,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}this.rebuildAnglesAndRadius()},e.prototype._getViewMatrix=function(){var t=Math.cos(this.alpha),e=Math.sin(this.alpha),i=Math.cos(this.beta),r=Math.sin(this.beta);0===r&&(r=1e-4),0===this.radius&&(this.radius=1e-4);var n=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*t*r,this.radius*i,this.radius*e*r),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||s.e.TransformCoordinatesToRef(this._computationVector,this._YToUpMatrix,this._computationVector),n.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions){var o=this.getScene().collisionCoordinator;this._collider||(this._collider=o.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,o.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}else{this._position.copyFrom(this._newPosition);var a=this.upVector;this.allowUpsideDown&&r<0&&(a=a.negate()),this._computeViewMatrix(this._position,n,a),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=n,this._viewMatrix},e.prototype.zoomOn=function(t,e){void 0===e&&(e=!1),t=t||this.getScene().meshes;var i=h.a.MinMax(t),r=s.e.Distance(i.min,i.max);this.radius=r*this.zoomOnFactor,this.focusOn({min:i.min,max:i.max,distance:r},e)},e.prototype.focusOn=function(t,e){var i,r;if(void 0===e&&(e=!1),void 0===t.min){var n=t||this.getScene().meshes;i=h.a.MinMax(n),r=s.e.Distance(i.min,i.max)}else{i=t,r=t.distance}this._target=h.a.Center(i),e||(this.maxZ=2*r)},e.prototype.createRigCamera=function(t,i){var r=0;switch(this.cameraRigMode){case f.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case f.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case f.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case f.a.RIG_MODE_STEREOSCOPIC_INTERLACED:case f.a.RIG_MODE_VR:r=this._cameraRigParams.stereoHalfAngle*(0===i?1:-1);break;case f.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:r=this._cameraRigParams.stereoHalfAngle*(0===i?-1:1)}var n=new e(t,this.alpha+r,this.beta,this.radius,this._target,this.getScene());return n._cameraRigParams={},n.isRigCamera=!0,n.rigParent=this,n.upVector=this.upVector,n},e.prototype._updateRigCameras=function(){var e=this._rigCameras[0],i=this._rigCameras[1];switch(e.beta=i.beta=this.beta,this.cameraRigMode){case f.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case f.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case f.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case f.a.RIG_MODE_STEREOSCOPIC_INTERLACED:case f.a.RIG_MODE_VR:e.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,i.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case f.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:e.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,i.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}t.prototype._updateRigCameras.call(this)},e.prototype.dispose=function(){this.inputs.clear(),t.prototype.dispose.call(this)},e.prototype.getClassName=function(){return"ArcRotateCamera"},Object(r.c)([Object(n.c)()],e.prototype,"alpha",void 0),Object(r.c)([Object(n.c)()],e.prototype,"beta",void 0),Object(r.c)([Object(n.c)()],e.prototype,"radius",void 0),Object(r.c)([Object(n.o)("target")],e.prototype,"_target",void 0),Object(r.c)([Object(n.c)()],e.prototype,"inertialAlphaOffset",void 0),Object(r.c)([Object(n.c)()],e.prototype,"inertialBetaOffset",void 0),Object(r.c)([Object(n.c)()],e.prototype,"inertialRadiusOffset",void 0),Object(r.c)([Object(n.c)()],e.prototype,"lowerAlphaLimit",void 0),Object(r.c)([Object(n.c)()],e.prototype,"upperAlphaLimit",void 0),Object(r.c)([Object(n.c)()],e.prototype,"lowerBetaLimit",void 0),Object(r.c)([Object(n.c)()],e.prototype,"upperBetaLimit",void 0),Object(r.c)([Object(n.c)()],e.prototype,"lowerRadiusLimit",void 0),Object(r.c)([Object(n.c)()],e.prototype,"upperRadiusLimit",void 0),Object(r.c)([Object(n.c)()],e.prototype,"inertialPanningX",void 0),Object(r.c)([Object(n.c)()],e.prototype,"inertialPanningY",void 0),Object(r.c)([Object(n.c)()],e.prototype,"pinchToPanMaxDistance",void 0),Object(r.c)([Object(n.c)()],e.prototype,"panningDistanceLimit",void 0),Object(r.c)([Object(n.o)()],e.prototype,"panningOriginTarget",void 0),Object(r.c)([Object(n.c)()],e.prototype,"panningInertia",void 0),Object(r.c)([Object(n.c)()],e.prototype,"zoomOnFactor",void 0),Object(r.c)([Object(n.c)()],e.prototype,"targetScreenOffset",void 0),Object(r.c)([Object(n.c)()],e.prototype,"allowUpsideDown",void 0),Object(r.c)([Object(n.c)()],e.prototype,"useInputToRestoreState",void 0),e}(d.a)},,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.BuildArray=function(t,e){for(var i=[],r=0;r<t;++r)i.push(e());return i},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r}return t.prototype.toGlobal=function(e,i){return new t(this.x*e,this.y*i,this.width*e,this.height*i)},t.prototype.toGlobalToRef=function(t,e,i){return i.x=this.x*t,i.y=this.y*e,i.width=this.width*t,i.height=this.height*e,this},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t}()},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(34),n=function(){function t(t,e,i,n){this.normal=new r.e(t,e,i),this.d=n}return t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.getClassName=function(){return"Plane"},t.prototype.getHashCode=function(){var t=this.normal.getHashCode();return t=397*t^(0|this.d)},t.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),e=0;return 0!==t&&(e=1/t),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this},t.prototype.transform=function(e){var i=t._TmpMatrix;e.invertToRef(i);var r=i.m,n=this.normal.x,o=this.normal.y,s=this.normal.z,a=this.d;return new t(n*r[0]+o*r[1]+s*r[2]+a*r[3],n*r[4]+o*r[5]+s*r[6]+a*r[7],n*r[8]+o*r[9]+s*r[10]+a*r[11],n*r[12]+o*r[13]+s*r[14]+a*r[15])},t.prototype.dotCoordinate=function(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d},t.prototype.copyFromPoints=function(t,e,i){var r,n=e.x-t.x,o=e.y-t.y,s=e.z-t.z,a=i.x-t.x,h=i.y-t.y,c=i.z-t.z,u=o*c-s*h,l=s*a-n*c,f=n*h-o*a,d=Math.sqrt(u*u+l*l+f*f);return r=0!==d?1/d:0,this.normal.x=u*r,this.normal.y=l*r,this.normal.z=f*r,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this},t.prototype.isFrontFacingTo=function(t,e){return r.e.Dot(this.normal,t)<=e},t.prototype.signedDistanceTo=function(t){return r.e.Dot(t,this.normal)+this.d},t.FromArray=function(e){return new t(e[0],e[1],e[2],e[3])},t.FromPoints=function(e,i,r){var n=new t(0,0,0,0);return n.copyFromPoints(e,i,r),n},t.FromPositionAndNormal=function(e,i){var r=new t(0,0,0,0);return i.normalize(),r.normal=i,r.d=-(i.x*e.x+i.y*e.y+i.z*e.z),r},t.SignedDistanceToPlaneFromPositionAndNormal=function(t,e,i){var n=-(e.x*t.x+e.y*t.y+e.z*t.z);return r.e.Dot(i,e)+n},t._TmpMatrix=r.a.Identity(),t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(40),n=i(168),o=i(63),s=i(200),a=function(){function t(t,e,i,r,n,o,s,a,h){void 0===a&&(a=!0),void 0===h&&(h=!0),this.materialIndex=t,this.verticesStart=e,this.verticesCount=i,this.indexStart=r,this.indexCount=n,this._materialDefines=null,this._materialEffect=null,this._effectOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=o,this._renderingMesh=s||o,h&&o.subMeshes.push(this),this._trianglePlanes=[],this._id=o.subMeshes.length-1,a&&(this.refreshBoundingInfo(),o.computeWorldMatrix(!0))}return Object.defineProperty(t.prototype,"materialDefines",{get:function(){return this._materialDefines},set:function(t){this._materialDefines=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effect",{get:function(){var t;return null!==(t=this._effectOverride)&&void 0!==t?t:this._materialEffect},enumerable:!1,configurable:!0}),t.prototype.setEffect=function(t,e){void 0===e&&(e=null),this._materialEffect!==t?(this._materialDefines=e,this._materialEffect=t):t||(this._materialDefines=null)},t.AddToMesh=function(e,i,r,n,o,s,a,h){return void 0===h&&(h=!0),new t(e,i,r,n,o,s,a,h)},Object.defineProperty(t.prototype,"IsGlobal",{get:function(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()},enumerable:!1,configurable:!0}),t.prototype.getBoundingInfo=function(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo},t.prototype.setBoundingInfo=function(t){return this._boundingInfo=t,this},t.prototype.getMesh=function(){return this._mesh},t.prototype.getRenderingMesh=function(){return this._renderingMesh},t.prototype.getReplacementMesh=function(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null},t.prototype.getEffectiveMesh=function(){var t=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return t||this._renderingMesh},t.prototype.getMaterial=function(){var t=this._renderingMesh.material;if(null==t)return this._mesh.getScene().defaultMaterial;if(this._IsMultiMaterial(t)){var e=t.getSubMaterial(this.materialIndex);return this._currentMaterial!==e&&(this._currentMaterial=e,this._materialDefines=null),e}return t},t.prototype._IsMultiMaterial=function(t){return void 0!==t.getSubMaterial},t.prototype.refreshBoundingInfo=function(t){if(void 0===t&&(t=null),this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(t||(t=this._renderingMesh.getVerticesData(r.b.PositionKind)),!t)return this._boundingInfo=this._mesh.getBoundingInfo(),this;var e,i=this._renderingMesh.getIndices();if(0===this.indexStart&&this.indexCount===i.length){var n=this._renderingMesh.getBoundingInfo();e={minimum:n.minimum.clone(),maximum:n.maximum.clone()}}else e=Object(s.b)(t,i,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(e.minimum,e.maximum):this._boundingInfo=new o.a(e.minimum,e.maximum),this},t.prototype._checkCollision=function(t){return this.getBoundingInfo()._checkCollision(t)},t.prototype.updateBoundingInfo=function(t){var e=this.getBoundingInfo();return e||(this.refreshBoundingInfo(),e=this.getBoundingInfo()),e&&e.update(t),this},t.prototype.isInFrustum=function(t){var e=this.getBoundingInfo();return!!e&&e.isInFrustum(t,this._mesh.cullingStrategy)},t.prototype.isCompletelyInFrustum=function(t){var e=this.getBoundingInfo();return!!e&&e.isCompletelyInFrustum(t)},t.prototype.render=function(t){return this._renderingMesh.render(this,t,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this},t.prototype._getLinesIndexBuffer=function(t,e){if(!this._linesIndexBuffer){for(var i=[],r=this.indexStart;r<this.indexStart+this.indexCount;r+=3)i.push(t[r],t[r+1],t[r+1],t[r+2],t[r+2],t[r]);this._linesIndexBuffer=e.createIndexBuffer(i),this._linesIndexCount=i.length}return this._linesIndexBuffer},t.prototype.canIntersects=function(t){var e=this.getBoundingInfo();return!!e&&t.intersectsBox(e.boundingBox)},t.prototype.intersects=function(t,e,i,r,n){var o=this.getMaterial();if(!o)return null;var s=3,a=!1;switch(o.fillMode){case 3:case 4:case 5:case 6:case 8:return null;case 7:s=1,a=!0}return"InstancedLinesMesh"===this._mesh.getClassName()||"LinesMesh"===this._mesh.getClassName()?i.length?this._intersectLines(t,e,i,this._mesh.intersectionThreshold,r):this._intersectUnIndexedLines(t,e,i,this._mesh.intersectionThreshold,r):!i.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(t,e,i,r,n):this._intersectTriangles(t,e,i,s,a,r,n)},t.prototype._intersectLines=function(t,e,i,r,o){for(var s=null,a=this.indexStart;a<this.indexStart+this.indexCount;a+=2){var h=e[i[a]],c=e[i[a+1]],u=t.intersectionSegment(h,c,r);if(!(u<0)&&((o||!s||u<s.distance)&&((s=new n.a(null,null,u)).faceId=a/2,o)))break}return s},t.prototype._intersectUnIndexedLines=function(t,e,i,r,o){for(var s=null,a=this.verticesStart;a<this.verticesStart+this.verticesCount;a+=2){var h=e[a],c=e[a+1],u=t.intersectionSegment(h,c,r);if(!(u<0)&&((o||!s||u<s.distance)&&((s=new n.a(null,null,u)).faceId=a/2,o)))break}return s},t.prototype._intersectTriangles=function(t,e,i,r,n,o,s){for(var a=null,h=-1,c=this.indexStart;c<this.indexStart+this.indexCount;c+=r){h++;var u=i[c],l=i[c+1],f=i[c+2];if(n&&4294967295===f)c+=2;else{var d=e[u],p=e[l],_=e[f];if(!s||s(d,p,_,t)){var g=t.intersectsTriangle(d,p,_);if(g){if(g.distance<0)continue;if((o||!a||g.distance<a.distance)&&((a=g).faceId=h,o))break}}}}return a},t.prototype._intersectUnIndexedTriangles=function(t,e,i,r,n){for(var o=null,s=this.verticesStart;s<this.verticesStart+this.verticesCount;s+=3){var a=e[s],h=e[s+1],c=e[s+2];if(!n||n(a,h,c,t)){var u=t.intersectsTriangle(a,h,c);if(u){if(u.distance<0)continue;if((r||!o||u.distance<o.distance)&&((o=u).faceId=s/3,r))break}}}return o},t.prototype._rebuild=function(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)},t.prototype.clone=function(e,i){var r=new t(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,e,i,!1);if(!this.IsGlobal){var n=this.getBoundingInfo();if(!n)return r;r._boundingInfo=new o.a(n.minimum,n.maximum)}return r},t.prototype.dispose=function(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);var t=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(t,1)},t.prototype.getClassName=function(){return"SubMesh"},t.CreateFromIndices=function(e,i,r,n,o){for(var s=Number.MAX_VALUE,a=-Number.MAX_VALUE,h=(o||n).getIndices(),c=i;c<i+r;c++){var u=h[c];u<s&&(s=u),u>a&&(a=u)}return new t(e,s,a-s+1,i,r,n,o)},t}()},,function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var r=i(3),n=i(37),o=i(45),s=i(34),a=i(60),h=i(55),c=function(t){function e(e,i,r,n){void 0===n&&(n=!0);var o=t.call(this,e,i,r,n)||this;return o._tmpUpVector=s.e.Zero(),o._tmpTargetVector=s.e.Zero(),o.cameraDirection=new s.e(0,0,0),o.cameraRotation=new s.d(0,0),o.ignoreParentScaling=!1,o.updateUpVectorFromRotation=!1,o._tmpQuaternion=new s.b,o.rotation=new s.e(0,0,0),o.speed=2,o.noRotationConstraint=!1,o.invertRotation=!1,o.inverseRotationSpeed=.2,o.lockedTarget=null,o._currentTarget=s.e.Zero(),o._initialFocalDistance=1,o._viewMatrix=s.a.Zero(),o._camMatrix=s.a.Zero(),o._cameraTransformMatrix=s.a.Zero(),o._cameraRotationMatrix=s.a.Zero(),o._referencePoint=new s.e(0,0,1),o._transformedReferencePoint=s.e.Zero(),o._defaultUp=s.e.Up(),o._cachedRotationZ=0,o._cachedQuaternionRotationZ=0,o}return Object(r.d)(e,t),e.prototype.getFrontPosition=function(t){this.getWorldMatrix();var e=this.getTarget().subtract(this.position);return e.normalize(),e.scaleInPlace(t),this.globalPosition.add(e)},e.prototype._getLockedTargetPosition=function(){return this.lockedTarget?(this.lockedTarget.absolutePosition&&this.lockedTarget.computeWorldMatrix(),this.lockedTarget.absolutePosition||this.lockedTarget):null},e.prototype.storeState=function(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),t.prototype.storeState.call(this)},e.prototype._restoreStateValues=function(){return!!t.prototype._restoreStateValues.call(this)&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0)},e.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.lockedTarget=new s.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new s.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new s.b(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},e.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this);var i=this._getLockedTargetPosition();i?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(i):this._cache.lockedTarget=i.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)},e.prototype._isSynchronizedViewMatrix=function(){if(!t.prototype._isSynchronizedViewMatrix.call(this))return!1;var e=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(e):!e)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))},e.prototype._computeLocalCameraSpeed=function(){var t=this.getEngine();return this.speed*Math.sqrt(t.getDeltaTime()/(100*t.getFps()))},e.prototype.setTarget=function(t){this.upVector.normalize(),this._initialFocalDistance=t.subtract(this.position).length(),this.position.z===t.z&&(this.position.z+=a.a),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),s.a.LookAtLHToRef(this.position,t,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);var e=t.subtract(this.position);e.x>=0?this.rotation.y=-Math.atan(e.z/e.x)+Math.PI/2:this.rotation.y=-Math.atan(e.z/e.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&s.b.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)},Object.defineProperty(e.prototype,"target",{get:function(){return this.getTarget()},set:function(t){this.setTarget(t)},enumerable:!1,configurable:!0}),e.prototype.getTarget=function(){return this._currentTarget},e.prototype._decideIfNeedsToMove=function(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0},e.prototype._updatePosition=function(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(s.c.Matrix[0]),s.e.TransformNormalToRef(this.cameraDirection,s.c.Matrix[0],s.c.Vector3[0]),void this.position.addInPlace(s.c.Vector3[0]);this.position.addInPlace(this.cameraDirection)},e.prototype._checkInputs=function(){var e=this.invertRotation?-this.inverseRotationSpeed:1,i=this._decideIfNeedsToMove(),r=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0;if(i&&this._updatePosition(),r){if(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this.rotation),this.rotation.x+=this.cameraRotation.x*e,this.rotation.y+=this.cameraRotation.y*e,!this.noRotationConstraint){this.rotation.x>1.570796&&(this.rotation.x=1.570796),this.rotation.x<-1.570796&&(this.rotation.x=-1.570796)}if(this.rotationQuaternion)this.rotation.lengthSquared()&&s.b.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}i&&(Math.abs(this.cameraDirection.x)<this.speed*a.a&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*a.a&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*a.a&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),r&&(Math.abs(this.cameraRotation.x)<this.speed*a.a&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*a.a&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),t.prototype._checkInputs.call(this)},e.prototype._updateCameraRotationMatrix=function(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):s.a.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)},e.prototype._rotateUpVectorWithCameraRotationMatrix=function(){return s.e.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this},e.prototype._getViewMatrix=function(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!=this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),s.e.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?h.a.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(s.b.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),h.a.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix},e.prototype._computeViewMatrix=function(t,e,i){if(this.ignoreParentScaling){if(this.parent){var r=this.parent.getWorldMatrix();s.e.TransformCoordinatesToRef(t,r,this._globalPosition),s.e.TransformCoordinatesToRef(e,r,this._tmpTargetVector),s.e.TransformNormalToRef(i,r,this._tmpUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(t),this._tmpTargetVector.copyFrom(e),this._tmpUpVector.copyFrom(i);this.getScene().useRightHandedSystem?s.a.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):s.a.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix)}else if(this.getScene().useRightHandedSystem?s.a.LookAtRHToRef(t,e,i,this._viewMatrix):s.a.LookAtLHToRef(t,e,i,this._viewMatrix),this.parent){r=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(r,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.copyFrom(t)},e.prototype.createRigCamera=function(t,i){if(this.cameraRigMode!==o.a.RIG_MODE_NONE){var r=new e(t,this.position.clone(),this.getScene());return r.isRigCamera=!0,r.rigParent=this,this.cameraRigMode!==o.a.RIG_MODE_VR&&this.cameraRigMode!==o.a.RIG_MODE_WEBVR||(this.rotationQuaternion||(this.rotationQuaternion=new s.b),r._cameraRigParams={},r.rotationQuaternion=new s.b),r}return null},e.prototype._updateRigCameras=function(){var e=this._rigCameras[0],i=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case o.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case o.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case o.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case o.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case o.a.RIG_MODE_STEREOSCOPIC_INTERLACED:var r=this.cameraRigMode===o.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,n=this.cameraRigMode===o.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*r,e),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*n,i);break;case o.a.RIG_MODE_VR:e.rotationQuaternion?(e.rotationQuaternion.copyFrom(this.rotationQuaternion),i.rotationQuaternion.copyFrom(this.rotationQuaternion)):(e.rotation.copyFrom(this.rotation),i.rotation.copyFrom(this.rotation)),e.position.copyFrom(this.position),i.position.copyFrom(this.position)}t.prototype._updateRigCameras.call(this)},e.prototype._getRigCamPositionAndTarget=function(t,i){this.getTarget().subtractToRef(this.position,e._TargetFocalPoint),e._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);var r=e._TargetFocalPoint.addInPlace(this.position);s.a.TranslationToRef(-r.x,-r.y,-r.z,e._TargetTransformMatrix),e._TargetTransformMatrix.multiplyToRef(s.a.RotationAxis(i.upVector,t),e._RigCamTransformMatrix),s.a.TranslationToRef(r.x,r.y,r.z,e._TargetTransformMatrix),e._RigCamTransformMatrix.multiplyToRef(e._TargetTransformMatrix,e._RigCamTransformMatrix),s.e.TransformCoordinatesToRef(this.position,e._RigCamTransformMatrix,i.position),i.setTarget(r)},e.prototype.getClassName=function(){return"TargetCamera"},e._RigCamTransformMatrix=new s.a,e._TargetTransformMatrix=new s.a,e._TargetFocalPoint=new s.e,Object(r.c)([Object(n.o)()],e.prototype,"rotation",void 0),Object(r.c)([Object(n.c)()],e.prototype,"speed",void 0),Object(r.c)([Object(n.k)("lockedTargetId")],e.prototype,"lockedTarget",void 0),e}(o.a)},,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(34),n=i(40),o=function(){function t(){this._pickingUnavailable=!1,this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.originMesh=null,this.ray=null}return t.prototype.getNormal=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!0),!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(n.b.NormalKind))return null;var i,o=this.pickedMesh.getIndices();if(!o)return null;if(e){var s=this.pickedMesh.getVerticesData(n.b.NormalKind),a=r.e.FromArray(s,3*o[3*this.faceId]),h=r.e.FromArray(s,3*o[3*this.faceId+1]),c=r.e.FromArray(s,3*o[3*this.faceId+2]);a=a.scale(this.bu),h=h.scale(this.bv),c=c.scale(1-this.bu-this.bv),i=new r.e(a.x+h.x+c.x,a.y+h.y+c.y,a.z+h.z+c.z)}else{var u=this.pickedMesh.getVerticesData(n.b.PositionKind),l=r.e.FromArray(u,3*o[3*this.faceId]),f=r.e.FromArray(u,3*o[3*this.faceId+1]),d=r.e.FromArray(u,3*o[3*this.faceId+2]),p=l.subtract(f),_=d.subtract(f);i=r.e.Cross(p,_)}if(t){var g=this.pickedMesh.getWorldMatrix();this.pickedMesh.nonUniformScaling&&(r.c.Matrix[0].copyFrom(g),(g=r.c.Matrix[0]).setTranslationFromFloats(0,0,0),g.invert(),g.transposeToRef(r.c.Matrix[1]),g=r.c.Matrix[1]),i=r.e.TransformNormal(i,g)}return i.normalize(),i},t.prototype.getTextureCoordinates=function(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(n.b.UVKind))return null;var t=this.pickedMesh.getIndices();if(!t)return null;var e=this.pickedMesh.getVerticesData(n.b.UVKind);if(!e)return null;var i=r.d.FromArray(e,2*t[3*this.faceId]),o=r.d.FromArray(e,2*t[3*this.faceId+1]),s=r.d.FromArray(e,2*t[3*this.faceId+2]);return i=i.scale(this.bu),o=o.scale(this.bv),s=s.scale(1-this.bu-this.bv),new r.d(i.x+o.x+s.x,i.y+o.y+s.y)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return u})),i.d(e,"d",(function(){return l})),i.d(e,"b",(function(){return f}));var r,n=i(46),o=i(34),s=i(60);!function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(r||(r={}));var a=function(){function t(){}return t.Interpolate=function(t,e,i,r,n){for(var o=1-3*r+3*e,s=3*r-6*e,a=3*e,h=t,c=0;c<5;c++){var u=h*h;h-=(o*(u*h)+s*u+a*h-t)*(1/(3*o*u+2*s*h+a)),h=Math.min(1,Math.max(0,h))}return 3*Math.pow(1-h,2)*h*i+3*(1-h)*Math.pow(h,2)*n+Math.pow(h,3)},t}(),h=function(){function t(t){this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}return t.prototype.degrees=function(){return 180*this._radians/Math.PI},t.prototype.radians=function(){return this._radians},t.BetweenTwoPoints=function(e,i){var r=i.subtract(e);return new t(Math.atan2(r.y,r.x))},t.FromRadians=function(e){return new t(e)},t.FromDegrees=function(e){return new t(e*Math.PI/180)},t}(),c=function(t,e,i){this.startPoint=t,this.midPoint=e,this.endPoint=i;var n=Math.pow(e.x,2)+Math.pow(e.y,2),s=(Math.pow(t.x,2)+Math.pow(t.y,2)-n)/2,a=(n-Math.pow(i.x,2)-Math.pow(i.y,2))/2,c=(t.x-e.x)*(e.y-i.y)-(e.x-i.x)*(t.y-e.y);this.centerPoint=new o.d((s*(e.y-i.y)-a*(t.y-e.y))/c,((t.x-e.x)*a-(e.x-i.x)*s)/c),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=h.BetweenTwoPoints(this.centerPoint,this.startPoint);var u=this.startAngle.degrees(),l=h.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),f=h.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();l-u>180&&(l-=360),l-u<-180&&(l+=360),f-l>180&&(f-=360),f-l<-180&&(f+=360),this.orientation=l-u<0?r.CW:r.CCW,this.angle=h.FromDegrees(this.orientation===r.CW?u-f:f-u)},u=function(){function t(t,e){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new o.d(t,e))}return t.prototype.addLineTo=function(t,e){if(this.closed)return this;var i=new o.d(t,e),r=this._points[this._points.length-1];return this._points.push(i),this._length+=i.subtract(r).length(),this},t.prototype.addArcTo=function(t,e,i,n,s){if(void 0===s&&(s=36),this.closed)return this;var a=this._points[this._points.length-1],h=new o.d(t,e),u=new o.d(i,n),l=new c(a,h,u),f=l.angle.radians()/s;l.orientation===r.CW&&(f*=-1);for(var d=l.startAngle.radians()+f,p=0;p<s;p++){var _=Math.cos(d)*l.radius+l.centerPoint.x,g=Math.sin(d)*l.radius+l.centerPoint.y;this.addLineTo(_,g),d+=f}return this},t.prototype.close=function(){return this.closed=!0,this},t.prototype.length=function(){var t=this._length;if(this.closed){var e=this._points[this._points.length-1];t+=this._points[0].subtract(e).length()}return t},t.prototype.getPoints=function(){return this._points},t.prototype.getPointAtLengthPosition=function(t){if(t<0||t>1)return o.d.Zero();for(var e=t*this.length(),i=0,r=0;r<this._points.length;r++){var n=(r+1)%this._points.length,s=this._points[r],a=this._points[n].subtract(s),h=a.length()+i;if(e>=i&&e<=h){var c=a.normalize(),u=e-i;return new o.d(s.x+c.x*u,s.y+c.y*u)}i=h}return o.d.Zero()},t.StartingAt=function(e,i){return new t(e,i)},t}(),l=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===r&&(r=!1),this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array,this._pointAtData={id:0,point:o.e.Zero(),previousPointArrayIndex:0,position:0,subPosition:0,interpolateReady:!1,interpolationMatrix:o.a.Identity()};for(var n=0;n<t.length;n++)this._curve[n]=t[n].clone();this._raw=i||!1,this._alignTangentsWithPath=r,this._compute(e,r)}return t.prototype.getCurve=function(){return this._curve},t.prototype.getPoints=function(){return this._curve},t.prototype.length=function(){return this._distances[this._distances.length-1]},t.prototype.getTangents=function(){return this._tangents},t.prototype.getNormals=function(){return this._normals},t.prototype.getBinormals=function(){return this._binormals},t.prototype.getDistances=function(){return this._distances},t.prototype.getPointAt=function(t){return this._updatePointAtData(t).point},t.prototype.getTangentAt=function(t,e){return void 0===e&&(e=!1),this._updatePointAtData(t,e),e?o.e.TransformCoordinates(o.e.Forward(),this._pointAtData.interpolationMatrix):this._tangents[this._pointAtData.previousPointArrayIndex]},t.prototype.getNormalAt=function(t,e){return void 0===e&&(e=!1),this._updatePointAtData(t,e),e?o.e.TransformCoordinates(o.e.Right(),this._pointAtData.interpolationMatrix):this._normals[this._pointAtData.previousPointArrayIndex]},t.prototype.getBinormalAt=function(t,e){return void 0===e&&(e=!1),this._updatePointAtData(t,e),e?o.e.TransformCoordinates(o.e.UpReadOnly,this._pointAtData.interpolationMatrix):this._binormals[this._pointAtData.previousPointArrayIndex]},t.prototype.getDistanceAt=function(t){return this.length()*t},t.prototype.getPreviousPointIndexAt=function(t){return this._updatePointAtData(t),this._pointAtData.previousPointArrayIndex},t.prototype.getSubPositionAt=function(t){return this._updatePointAtData(t),this._pointAtData.subPosition},t.prototype.getClosestPositionTo=function(t){for(var e=Number.MAX_VALUE,i=0,r=0;r<this._curve.length-1;r++){var n=this._curve[r+0],s=this._curve[r+1].subtract(n).normalize(),a=this._distances[r+1]-this._distances[r+0],h=Math.min(Math.max(o.e.Dot(s,t.subtract(n).normalize()),0)*o.e.Distance(n,t)/a,1),c=o.e.Distance(n.add(s.scale(h*a)),t);c<e&&(e=c,i=(this._distances[r+0]+a*h)/this.length())}return i},t.prototype.slice=function(e,i){if(void 0===e&&(e=0),void 0===i&&(i=1),e<0&&(e=1- -1*e%1),i<0&&(i=1- -1*i%1),e>i){var r=e;e=i,i=r}var n=this.getCurve(),o=this.getPointAt(e),s=this.getPreviousPointIndexAt(e),a=this.getPointAt(i),h=this.getPreviousPointIndexAt(i)+1,c=[];return 0!==e&&(s++,c.push(o)),c.push.apply(c,n.slice(s,h)),1===i&&1!==e||c.push(a),new t(c,this.getNormalAt(e),this._raw,this._alignTangentsWithPath)},t.prototype.update=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1);for(var r=0;r<t.length;r++)this._curve[r].x=t[r].x,this._curve[r].y=t[r].y,this._curve[r].z=t[r].z;return this._compute(e,i),this},t.prototype._compute=function(t,e){void 0===e&&(e=!1);var i=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[i-1]=this._curve[i-1].subtract(this._curve[i-2]),this._raw||this._tangents[i-1].normalize();var r,n,s,a,h,c=this._tangents[0],u=this._normalVector(c,t);this._normals[0]=u,this._raw||this._normals[0].normalize(),this._binormals[0]=o.e.Cross(c,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var l=1;l<i;l++)r=this._getLastNonNullVector(l),l<i-1&&(n=this._getFirstNonNullVector(l),this._tangents[l]=e?n:r.add(n),this._tangents[l].normalize()),this._distances[l]=this._distances[l-1]+this._curve[l].subtract(this._curve[l-1]).length(),s=this._tangents[l],h=this._binormals[l-1],this._normals[l]=o.e.Cross(h,s),this._raw||(0===this._normals[l].length()?(a=this._normals[l-1],this._normals[l]=a.clone()):this._normals[l].normalize()),this._binormals[l]=o.e.Cross(s,this._normals[l]),this._raw||this._binormals[l].normalize();this._pointAtData.id=NaN},t.prototype._getFirstNonNullVector=function(t){for(var e=1,i=this._curve[t+e].subtract(this._curve[t]);0===i.length()&&t+e+1<this._curve.length;)e++,i=this._curve[t+e].subtract(this._curve[t]);return i},t.prototype._getLastNonNullVector=function(t){for(var e=1,i=this._curve[t].subtract(this._curve[t-e]);0===i.length()&&t>e+1;)e++,i=this._curve[t].subtract(this._curve[t-e]);return i},t.prototype._normalVector=function(t,e){var i,r,a=t.length();(0===a&&(a=1),null==e)?(r=n.a.WithinEpsilon(Math.abs(t.y)/a,1,s.a)?n.a.WithinEpsilon(Math.abs(t.x)/a,1,s.a)?n.a.WithinEpsilon(Math.abs(t.z)/a,1,s.a)?o.e.Zero():new o.e(0,0,1):new o.e(1,0,0):new o.e(0,-1,0),i=o.e.Cross(t,r)):(i=o.e.Cross(t,e),o.e.CrossToRef(i,t,i));return i.normalize(),i},t.prototype._updatePointAtData=function(t,e){if(void 0===e&&(e=!1),this._pointAtData.id===t)return this._pointAtData.interpolateReady||this._updateInterpolationMatrix(),this._pointAtData;this._pointAtData.id=t;var i=this.getPoints();if(t<=0)return this._setPointAtData(0,0,i[0],0,e);if(t>=1)return this._setPointAtData(1,1,i[i.length-1],i.length-1,e);for(var r,n=i[0],s=0,a=t*this.length(),h=1;h<i.length;h++){r=i[h];var c=o.e.Distance(n,r);if((s+=c)===a)return this._setPointAtData(t,1,r,h,e);if(s>a){var u=(s-a)/c,l=n.subtract(r),f=r.add(l.scaleInPlace(u));return this._setPointAtData(t,1-u,f,h-1,e)}n=r}return this._pointAtData},t.prototype._setPointAtData=function(t,e,i,r,n){return this._pointAtData.point=i,this._pointAtData.position=t,this._pointAtData.subPosition=e,this._pointAtData.previousPointArrayIndex=r,this._pointAtData.interpolateReady=n,n&&this._updateInterpolationMatrix(),this._pointAtData},t.prototype._updateInterpolationMatrix=function(){this._pointAtData.interpolationMatrix=o.a.Identity();var t=this._pointAtData.previousPointArrayIndex;if(t!==this._tangents.length-1){var e=t+1,i=this._tangents[t].clone(),r=this._normals[t].clone(),n=this._binormals[t].clone(),s=this._tangents[e].clone(),a=this._normals[e].clone(),h=this._binormals[e].clone(),c=o.b.RotationQuaternionFromAxis(r,n,i),u=o.b.RotationQuaternionFromAxis(a,h,s);o.b.Slerp(c,u,this._pointAtData.subPosition).toRotationMatrix(this._pointAtData.interpolationMatrix)}},t}(),f=function(){function t(t){this._length=0,this._points=t,this._length=this._computeLength(t)}return t.CreateQuadraticBezier=function(e,i,r,n){n=n>2?n:3;for(var s=new Array,a=function(t,e,i,r){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*r},h=0;h<=n;h++)s.push(new o.e(a(h/n,e.x,i.x,r.x),a(h/n,e.y,i.y,r.y),a(h/n,e.z,i.z,r.z)));return new t(s)},t.CreateCubicBezier=function(e,i,r,n,s){s=s>3?s:4;for(var a=new Array,h=function(t,e,i,r,n){return(1-t)*(1-t)*(1-t)*e+3*t*(1-t)*(1-t)*i+3*t*t*(1-t)*r+t*t*t*n},c=0;c<=s;c++)a.push(new o.e(h(c/s,e.x,i.x,r.x,n.x),h(c/s,e.y,i.y,r.y,n.y),h(c/s,e.z,i.z,r.z,n.z)));return new t(a)},t.CreateHermiteSpline=function(e,i,r,n,s){for(var a=new Array,h=1/s,c=0;c<=s;c++)a.push(o.e.Hermite(e,i,r,n,c*h));return new t(a)},t.CreateCatmullRomSpline=function(e,i,r){var n=new Array,s=1/i,a=0;if(r){for(var h=e.length,c=0;c<h;c++){a=0;for(var u=0;u<i;u++)n.push(o.e.CatmullRom(e[c%h],e[(c+1)%h],e[(c+2)%h],e[(c+3)%h],a)),a+=s}n.push(n[0])}else{var l=new Array;l.push(e[0].clone()),Array.prototype.push.apply(l,e),l.push(e[e.length-1].clone());for(c=0;c<l.length-3;c++){a=0;for(u=0;u<i;u++)n.push(o.e.CatmullRom(l[c],l[c+1],l[c+2],l[c+3],a)),a+=s}c--,n.push(o.e.CatmullRom(l[c],l[c+1],l[c+2],l[c+3],a))}return new t(n)},t.prototype.getPoints=function(){return this._points},t.prototype.length=function(){return this._length},t.prototype.continue=function(e){for(var i=this._points[this._points.length-1],r=this._points.slice(),n=e.getPoints(),o=1;o<n.length;o++)r.push(n[o].subtract(n[0]).add(i));return new t(r)},t.prototype._computeLength=function(t){for(var e=0,i=1;i<t.length;i++)e+=t[i].subtract(t[i-1]).length();return e},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(3),n=i(49),o=i(105),s=i(35),a=function(t){function e(e,i){var r=t.call(this,e,i,!0)||this;return i.multiMaterials.push(r),r.subMaterials=new Array,r._storeEffectOnSubMeshes=!0,r}return Object(r.d)(e,t),Object.defineProperty(e.prototype,"subMaterials",{get:function(){return this._subMaterials},set:function(t){this._subMaterials=t,this._hookArray(t)},enumerable:!1,configurable:!0}),e.prototype.getChildren=function(){return this.subMaterials},e.prototype._hookArray=function(t){var e=this,i=t.push;t.push=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=i.apply(t,r);return e._markAllSubMeshesAsTexturesDirty(),o};var r=t.splice;t.splice=function(i,n){var o=r.apply(t,[i,n]);return e._markAllSubMeshesAsTexturesDirty(),o}},e.prototype.getSubMaterial=function(t){return t<0||t>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[t]},e.prototype.getActiveTextures=function(){var e;return(e=t.prototype.getActiveTextures.call(this)).concat.apply(e,this.subMaterials.map((function(t){return t?t.getActiveTextures():[]})))},e.prototype.getClassName=function(){return"MultiMaterial"},e.prototype.isReadyForSubMesh=function(t,e,i){for(var r=0;r<this.subMaterials.length;r++){var n=this.subMaterials[r];if(n){if(n._storeEffectOnSubMeshes){if(!n.isReadyForSubMesh(t,e,i))return!1;continue}if(!n.isReady(t))return!1}}return!0},e.prototype.clone=function(t,i){for(var r=new e(t,this.getScene()),n=0;n<this.subMaterials.length;n++){var o=null,s=this.subMaterials[n];o=i&&s?s.clone(t+"-"+s.name):this.subMaterials[n],r.subMaterials.push(o)}return r},e.prototype.serialize=function(){var t={};t.name=this.name,t.id=this.id,o.a&&(t.tags=o.a.GetTags(this)),t.materials=[];for(var e=0;e<this.subMaterials.length;e++){var i=this.subMaterials[e];i?t.materials.push(i.id):t.materials.push(null)}return t},e.prototype.dispose=function(e,i,r){var n=this.getScene();if(n){if(r)for(var o=0;o<this.subMaterials.length;o++){var s=this.subMaterials[o];s&&s.dispose(e,i)}(o=n.multiMaterials.indexOf(this))>=0&&n.multiMaterials.splice(o,1),t.prototype.dispose.call(this,e,i)}},e.ParseMultiMaterial=function(t,i){var r=new e(t.name,i);r.id=t.id,o.a&&o.a.AddTagsTo(r,t.tags);for(var n=0;n<t.materials.length;n++){var s=t.materials[n];s?r.subMaterials.push(i.getLastMaterialByID(s)):r.subMaterials.push(null)}return r},e}(n.a);s.a.RegisteredTypes["BABYLON.MultiMaterial"]=a},,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(193),n=function(){function t(){}return t.EnableFor=function(e){e._tags=e._tags||{},e.hasTags=function(){return t.HasTags(e)},e.addTags=function(i){return t.AddTagsTo(e,i)},e.removeTags=function(i){return t.RemoveTagsFrom(e,i)},e.matchesTagsQuery=function(i){return t.MatchesQuery(e,i)}},t.DisableFor=function(t){delete t._tags,delete t.hasTags,delete t.addTags,delete t.removeTags,delete t.matchesTagsQuery},t.HasTags=function(t){if(!t._tags)return!1;var e=t._tags;for(var i in e)if(e.hasOwnProperty(i))return!0;return!1},t.GetTags=function(t,e){if(void 0===e&&(e=!0),!t._tags)return null;if(e){var i=[];for(var r in t._tags)t._tags.hasOwnProperty(r)&&!0===t._tags[r]&&i.push(r);return i.join(" ")}return t._tags},t.AddTagsTo=function(e,i){i&&("string"==typeof i&&i.split(" ").forEach((function(i,r,n){t._AddTagTo(e,i)})))},t._AddTagTo=function(e,i){""!==(i=i.trim())&&"true"!==i&&"false"!==i&&(i.match(/[\s]/)||i.match(/^([!]|([|]|[&]){2})/)||(t.EnableFor(e),e._tags[i]=!0))},t.RemoveTagsFrom=function(e,i){if(t.HasTags(e)){var r=i.split(" ");for(var n in r)t._RemoveTagFrom(e,r[n])}},t._RemoveTagFrom=function(t,e){delete t._tags[e]},t.MatchesQuery=function(e,i){return void 0===i||(""===i?t.HasTags(e):r.a.Eval(i,(function(i){return t.HasTags(e)&&e._tags[i]})))},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1}return Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!1,configurable:!0}),t.prototype.markAsProcessed=function(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._areImageProcessingDirty=!1},t.prototype.markAsUnprocessed=function(){this._isDirty=!0},t.prototype.markAllAsDirty=function(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0},t.prototype.markAsImageProcessingDirty=function(){this._areImageProcessingDirty=!0,this._isDirty=!0},t.prototype.markAsLightDirty=function(t){void 0===t&&(t=!1),this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||t,this._isDirty=!0},t.prototype.markAsAttributesDirty=function(){this._areAttributesDirty=!0,this._isDirty=!0},t.prototype.markAsTexturesDirty=function(){this._areTexturesDirty=!0,this._isDirty=!0},t.prototype.markAsFresnelDirty=function(){this._areFresnelDirty=!0,this._isDirty=!0},t.prototype.markAsMiscDirty=function(){this._areMiscDirty=!0,this._isDirty=!0},t.prototype.rebuild=function(){this._keys=[];for(var t=0,e=Object.keys(this);t<e.length;t++){var i=e[t];"_"!==i[0]&&this._keys.push(i)}},t.prototype.isEqual=function(t){if(this._keys.length!==t._keys.length)return!1;for(var e=0;e<this._keys.length;e++){var i=this._keys[e];if(this[i]!==t[i])return!1}return!0},t.prototype.cloneTo=function(t){this._keys.length!==t._keys.length&&(t._keys=this._keys.slice(0));for(var e=0;e<this._keys.length;e++){var i=this._keys[e];t[i]=this[i]}},t.prototype.reset=function(){for(var t=0;t<this._keys.length;t++){var e=this._keys[t];switch(typeof this[e]){case"number":this[e]=0;break;case"string":this[e]="";break;default:this[e]=!1}}},t.prototype.toString=function(){for(var t="",e=0;e<this._keys.length;e++){var i=this._keys[e],r=this[i];switch(typeof r){case"number":case"string":t+="#define "+i+" "+r+"\n";break;default:r&&(t+="#define "+i+"\n")}}return t},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s}));var r=i(3),n=function(){function t(){}return t.KEYDOWN=1,t.KEYUP=2,t}(),o=function(t,e){this.type=t,this.event=e},s=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.type=e,r.event=i,r.skipOnPointerObservable=!1,r}return Object(r.d)(e,t),e}(o)},function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var r=i(34),n=i(36),o=i(43),s=i(40),a=i(90),h=i(143),c=i(63),u=i(41),l=i(105),f=i(200),d=function(){function t(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=null),this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this.useBoundingInfoFromGeometry=!1,this.id=t,this.uniqueId=e.getUniqueId(),this._engine=e.getEngine(),this._meshes=[],this._scene=e,this._vertexBuffers={},this._indices=[],this._updatable=r,i?this.setAllVerticesData(i,r):(this._totalVertices=0,this._indices=[]),this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),n&&(this.applyToMesh(n),n.computeWorldMatrix(!0))}return Object.defineProperty(t.prototype,"boundingBias",{get:function(){return this._boundingBias},set:function(t){this._boundingBias?this._boundingBias.copyFrom(t):this._boundingBias=t.clone(),this._updateBoundingInfo(!0,null)},enumerable:!1,configurable:!0}),t.CreateGeometryForMesh=function(e){var i=new t(t.RandomId(),e.getScene());return i.applyToMesh(e),i},Object.defineProperty(t.prototype,"meshes",{get:function(){return this._meshes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extend",{get:function(){return this._extend},enumerable:!1,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._engine},t.prototype.isReady=function(){return 1===this.delayLoadState||0===this.delayLoadState},Object.defineProperty(t.prototype,"doNotSerialize",{get:function(){for(var t=0;t<this._meshes.length;t++)if(!this._meshes[t].doNotSerialize)return!1;return!0},enumerable:!1,configurable:!0}),t.prototype._rebuild=function(){for(var t in this._vertexArrayObjects&&(this._vertexArrayObjects={}),0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._vertexBuffers){this._vertexBuffers[t]._rebuild()}},t.prototype.setAllVerticesData=function(t,e){t.applyToGeometry(this,e),this.notifyUpdate()},t.prototype.setVerticesData=function(t,e,i,r){void 0===i&&(i=!1);var n=new s.b(this._engine,e,t,i,0===this._meshes.length,r);this.setVerticesBuffer(n)},t.prototype.removeVerticesData=function(t){this._vertexBuffers[t]&&(this._vertexBuffers[t].dispose(),delete this._vertexBuffers[t])},t.prototype.setVerticesBuffer=function(t,e){void 0===e&&(e=null);var i=t.getKind();if(this._vertexBuffers[i]&&this._vertexBuffers[i].dispose(),this._vertexBuffers[i]=t,i===s.b.PositionKind){var r=t.getData();null!=e?this._totalVertices=e:null!=r&&(this._totalVertices=r.length/(t.byteStride/4)),this._updateExtend(r),this._resetPointsArrayCache();for(var n=this._meshes,o=n.length,a=0;a<o;a++){var h=n[a];h._boundingInfo=new c.a(this._extend.minimum,this._extend.maximum),h._createGlobalSubMesh(!1),h.computeWorldMatrix(!0)}}this.notifyUpdate(i),this._vertexArrayObjects&&(this._disposeVertexArrayObjects(),this._vertexArrayObjects={})},t.prototype.updateVerticesDataDirectly=function(t,e,i,r){void 0===r&&(r=!1);var n=this.getVertexBuffer(t);n&&(n.updateDirectly(e,i,r),this.notifyUpdate(t))},t.prototype.updateVerticesData=function(t,e,i){void 0===i&&(i=!1);var r=this.getVertexBuffer(t);r&&(r.update(e),t===s.b.PositionKind&&this._updateBoundingInfo(i,e),this.notifyUpdate(t))},t.prototype._updateBoundingInfo=function(t,e){if(t&&this._updateExtend(e),this._resetPointsArrayCache(),t)for(var i=0,r=this._meshes;i<r.length;i++){var n=r[i];n._boundingInfo?n._boundingInfo.reConstruct(this._extend.minimum,this._extend.maximum):n._boundingInfo=new c.a(this._extend.minimum,this._extend.maximum);for(var o=0,s=n.subMeshes;o<s.length;o++){s[o].refreshBoundingInfo()}}},t.prototype._bind=function(t,e){if(t){void 0===e&&(e=this._indexBuffer);var i=this.getVertexBuffers();i&&(e==this._indexBuffer&&this._vertexArrayObjects?(this._vertexArrayObjects[t.key]||(this._vertexArrayObjects[t.key]=this._engine.recordVertexArrayObject(i,e,t)),this._engine.bindVertexArrayObject(this._vertexArrayObjects[t.key],e)):this._engine.bindBuffers(i,e,t))}},t.prototype.getTotalVertices=function(){return this.isReady()?this._totalVertices:0},t.prototype.getVerticesData=function(t,e,i){var r=this.getVertexBuffer(t);if(!r)return null;var n=r.getData();if(!n)return null;var o=r.getSize()*s.b.GetTypeByteLength(r.type),a=this._totalVertices*r.getSize();if(r.type!==s.b.FLOAT||r.byteStride!==o){var h=[];return r.forEach(a,(function(t){return h.push(t)})),h}if(!(n instanceof Array||n instanceof Float32Array)||0!==r.byteOffset||n.length!==a){if(n instanceof Array){var c=r.byteOffset/4;return u.b.Slice(n,c,c+a)}if(n instanceof ArrayBuffer)return new Float32Array(n,r.byteOffset,a);c=n.byteOffset+r.byteOffset;if(i||e&&1!==this._meshes.length){var l=new Float32Array(a),f=new Float32Array(n.buffer,c,a);return l.set(f),l}return new Float32Array(n.buffer,c,a)}return i||e&&1!==this._meshes.length?u.b.Slice(n):n},t.prototype.isVertexBufferUpdatable=function(t){var e=this._vertexBuffers[t];return!!e&&e.isUpdatable()},t.prototype.getVertexBuffer=function(t){return this.isReady()?this._vertexBuffers[t]:null},t.prototype.getVertexBuffers=function(){return this.isReady()?this._vertexBuffers:null},t.prototype.isVerticesDataPresent=function(t){return this._vertexBuffers?void 0!==this._vertexBuffers[t]:!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)},t.prototype.getVerticesDataKinds=function(){var t,e=[];if(!this._vertexBuffers&&this._delayInfo)for(t in this._delayInfo)e.push(t);else for(t in this._vertexBuffers)e.push(t);return e},t.prototype.updateIndices=function(t,e,i){if(void 0===i&&(i=!1),this._indexBuffer)if(this._indexBufferIsUpdatable){var r=t.length!==this._indices.length;if(i||(this._indices=t.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,t,e),r)for(var n=0,o=this._meshes;n<o.length;n++){o[n]._createGlobalSubMesh(!0)}}else this.setIndices(t,null,!0)},t.prototype.setIndices=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._disposeVertexArrayObjects(),this._indices=t,this._indexBufferIsUpdatable=i,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,i)),null!=e&&(this._totalVertices=e);for(var r=0,n=this._meshes;r<n.length;r++){n[r]._createGlobalSubMesh(!0)}this.notifyUpdate()},t.prototype.getTotalIndices=function(){return this.isReady()?this._indices.length:0},t.prototype.getIndices=function(t,e){if(!this.isReady())return null;var i=this._indices;if(e||t&&1!==this._meshes.length){for(var r=i.length,n=[],o=0;o<r;o++)n.push(i[o]);return n}return i},t.prototype.getIndexBuffer=function(){return this.isReady()?this._indexBuffer:null},t.prototype._releaseVertexArrayObject=function(t){void 0===t&&(t=null),t&&this._vertexArrayObjects&&this._vertexArrayObjects[t.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t.key]),delete this._vertexArrayObjects[t.key])},t.prototype.releaseForMesh=function(t,e){var i=this._meshes,r=i.indexOf(t);-1!==r&&(i.splice(r,1),t._geometry=null,0===i.length&&e&&this.dispose())},t.prototype.applyToMesh=function(t){if(t._geometry!==this){var e=t._geometry;e&&e.releaseForMesh(t);var i=this._meshes;t._geometry=this,this._scene.pushGeometry(this),i.push(t),this.isReady()?this._applyToMesh(t):t._boundingInfo=this._boundingInfo}},t.prototype._updateExtend=function(t){void 0===t&&(t=null),this.useBoundingInfoFromGeometry&&this._boundingInfo?this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()}:(t||(t=this.getVerticesData(s.b.PositionKind)),this._extend=Object(f.a)(t,0,this._totalVertices,this.boundingBias,3))},t.prototype._applyToMesh=function(t){var e=this._meshes.length;for(var i in this._vertexBuffers){1===e&&this._vertexBuffers[i].create();var r=this._vertexBuffers[i].getBuffer();r&&(r.references=e),i===s.b.PositionKind&&(this._extend||this._updateExtend(),t._boundingInfo=new c.a(this._extend.minimum,this._extend.maximum),t._createGlobalSubMesh(!1),t._updateBoundingInfo())}1===e&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._indexBuffer&&(this._indexBuffer.references=e),t._syncGeometryWithMorphTargetManager(),t.synchronizeInstances()},t.prototype.notifyUpdate=function(t){this.onGeometryUpdated&&this.onGeometryUpdated(this,t);for(var e=0,i=this._meshes;e<i.length;e++){i[e]._markSubMeshesAsAttributesDirty()}},t.prototype.load=function(t,e){2!==this.delayLoadState&&(this.isReady()?e&&e():(this.delayLoadState=2,this._queueLoad(t,e)))},t.prototype._queueLoad=function(t,e){var i=this;this.delayLoadingFile&&(t._addPendingData(this),t._loadFile(this.delayLoadingFile,(function(r){if(i._delayLoadingFunction){i._delayLoadingFunction(JSON.parse(r),i),i.delayLoadState=1,i._delayInfo=[],t._removePendingData(i);for(var n=i._meshes,o=n.length,s=0;s<o;s++)i._applyToMesh(n[s]);e&&e()}}),void 0,!0))},t.prototype.toLeftHanded=function(){var t=this.getIndices(!1);if(null!=t&&t.length>0){for(var e=0;e<t.length;e+=3){var i=t[e+0];t[e+0]=t[e+2],t[e+2]=i}this.setIndices(t)}var r=this.getVerticesData(s.b.PositionKind,!1);if(null!=r&&r.length>0){for(e=0;e<r.length;e+=3)r[e+2]=-r[e+2];this.setVerticesData(s.b.PositionKind,r,!1)}var n=this.getVerticesData(s.b.NormalKind,!1);if(null!=n&&n.length>0){for(e=0;e<n.length;e+=3)n[e+2]=-n[e+2];this.setVerticesData(s.b.NormalKind,n,!1)}},t.prototype._resetPointsArrayCache=function(){this._positions=null},t.prototype._generatePointsArray=function(){if(this._positions)return!0;var t=this.getVerticesData(s.b.PositionKind);if(!t||0===t.length)return!1;this._positions=[];for(var e=0;e<t.length;e+=3)this._positions.push(r.e.FromArray(t,e));return!0},t.prototype.isDisposed=function(){return this._isDisposed},t.prototype._disposeVertexArrayObjects=function(){if(this._vertexArrayObjects){for(var t in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t]);this._vertexArrayObjects={}}},t.prototype.dispose=function(){var t,e=this._meshes,i=e.length;for(t=0;t<i;t++)this.releaseForMesh(e[t]);for(var r in this._meshes=[],this._disposeVertexArrayObjects(),this._vertexBuffers)this._vertexBuffers[r].dispose();this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._isDisposed=!0},t.prototype.copy=function(e){var i=new o.a;i.indices=[];var r=this.getIndices();if(r)for(var n=0;n<r.length;n++)i.indices.push(r[n]);var s,a=!1,h=!1;for(s in this._vertexBuffers){var u=this.getVerticesData(s);if(u&&(u instanceof Float32Array?i.set(new Float32Array(u),s):i.set(u.slice(0),s),!h)){var l=this.getVertexBuffer(s);l&&(h=!(a=l.isUpdatable()))}}var f=new t(e,this._scene,i,a);for(s in f.delayLoadState=this.delayLoadState,f.delayLoadingFile=this.delayLoadingFile,f._delayLoadingFunction=this._delayLoadingFunction,this._delayInfo)f._delayInfo=f._delayInfo||[],f._delayInfo.push(s);return f._boundingInfo=new c.a(this._extend.minimum,this._extend.maximum),f},t.prototype.serialize=function(){var t={};return t.id=this.id,t.updatable=this._updatable,l.a&&l.a.HasTags(this)&&(t.tags=l.a.GetTags(this)),t},t.prototype.toNumberArray=function(t){return Array.isArray(t)?t:Array.prototype.slice.call(t)},t.prototype.serializeVerticeData=function(){var t=this.serialize();return this.isVerticesDataPresent(s.b.PositionKind)&&(t.positions=this.toNumberArray(this.getVerticesData(s.b.PositionKind)),this.isVertexBufferUpdatable(s.b.PositionKind)&&(t.positions._updatable=!0)),this.isVerticesDataPresent(s.b.NormalKind)&&(t.normals=this.toNumberArray(this.getVerticesData(s.b.NormalKind)),this.isVertexBufferUpdatable(s.b.NormalKind)&&(t.normals._updatable=!0)),this.isVerticesDataPresent(s.b.TangentKind)&&(t.tangets=this.toNumberArray(this.getVerticesData(s.b.TangentKind)),this.isVertexBufferUpdatable(s.b.TangentKind)&&(t.tangets._updatable=!0)),this.isVerticesDataPresent(s.b.UVKind)&&(t.uvs=this.toNumberArray(this.getVerticesData(s.b.UVKind)),this.isVertexBufferUpdatable(s.b.UVKind)&&(t.uvs._updatable=!0)),this.isVerticesDataPresent(s.b.UV2Kind)&&(t.uv2s=this.toNumberArray(this.getVerticesData(s.b.UV2Kind)),this.isVertexBufferUpdatable(s.b.UV2Kind)&&(t.uv2s._updatable=!0)),this.isVerticesDataPresent(s.b.UV3Kind)&&(t.uv3s=this.toNumberArray(this.getVerticesData(s.b.UV3Kind)),this.isVertexBufferUpdatable(s.b.UV3Kind)&&(t.uv3s._updatable=!0)),this.isVerticesDataPresent(s.b.UV4Kind)&&(t.uv4s=this.toNumberArray(this.getVerticesData(s.b.UV4Kind)),this.isVertexBufferUpdatable(s.b.UV4Kind)&&(t.uv4s._updatable=!0)),this.isVerticesDataPresent(s.b.UV5Kind)&&(t.uv5s=this.toNumberArray(this.getVerticesData(s.b.UV5Kind)),this.isVertexBufferUpdatable(s.b.UV5Kind)&&(t.uv5s._updatable=!0)),this.isVerticesDataPresent(s.b.UV6Kind)&&(t.uv6s=this.toNumberArray(this.getVerticesData(s.b.UV6Kind)),this.isVertexBufferUpdatable(s.b.UV6Kind)&&(t.uv6s._updatable=!0)),this.isVerticesDataPresent(s.b.ColorKind)&&(t.colors=this.toNumberArray(this.getVerticesData(s.b.ColorKind)),this.isVertexBufferUpdatable(s.b.ColorKind)&&(t.colors._updatable=!0)),this.isVerticesDataPresent(s.b.MatricesIndicesKind)&&(t.matricesIndices=this.toNumberArray(this.getVerticesData(s.b.MatricesIndicesKind)),t.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(s.b.MatricesIndicesKind)&&(t.matricesIndices._updatable=!0)),this.isVerticesDataPresent(s.b.MatricesWeightsKind)&&(t.matricesWeights=this.toNumberArray(this.getVerticesData(s.b.MatricesWeightsKind)),this.isVertexBufferUpdatable(s.b.MatricesWeightsKind)&&(t.matricesWeights._updatable=!0)),t.indices=this.toNumberArray(this.getIndices()),t},t.ExtractFromMesh=function(t,e){var i=t._geometry;return i?i.copy(e):null},t.RandomId=function(){return u.b.RandomId()},t._ImportGeometry=function(e,i){var r=i.getScene(),o=e.geometryId;if(o){var h=r.getGeometryByID(o);h&&h.applyToMesh(i)}else if(e instanceof ArrayBuffer){var c=i._binaryInfo;if(c.positionsAttrDesc&&c.positionsAttrDesc.count>0){var u=new Float32Array(e,c.positionsAttrDesc.offset,c.positionsAttrDesc.count);i.setVerticesData(s.b.PositionKind,u,!1)}if(c.normalsAttrDesc&&c.normalsAttrDesc.count>0){var l=new Float32Array(e,c.normalsAttrDesc.offset,c.normalsAttrDesc.count);i.setVerticesData(s.b.NormalKind,l,!1)}if(c.tangetsAttrDesc&&c.tangetsAttrDesc.count>0){var f=new Float32Array(e,c.tangetsAttrDesc.offset,c.tangetsAttrDesc.count);i.setVerticesData(s.b.TangentKind,f,!1)}if(c.uvsAttrDesc&&c.uvsAttrDesc.count>0){var d=new Float32Array(e,c.uvsAttrDesc.offset,c.uvsAttrDesc.count);i.setVerticesData(s.b.UVKind,d,!1)}if(c.uvs2AttrDesc&&c.uvs2AttrDesc.count>0){var p=new Float32Array(e,c.uvs2AttrDesc.offset,c.uvs2AttrDesc.count);i.setVerticesData(s.b.UV2Kind,p,!1)}if(c.uvs3AttrDesc&&c.uvs3AttrDesc.count>0){var _=new Float32Array(e,c.uvs3AttrDesc.offset,c.uvs3AttrDesc.count);i.setVerticesData(s.b.UV3Kind,_,!1)}if(c.uvs4AttrDesc&&c.uvs4AttrDesc.count>0){var g=new Float32Array(e,c.uvs4AttrDesc.offset,c.uvs4AttrDesc.count);i.setVerticesData(s.b.UV4Kind,g,!1)}if(c.uvs5AttrDesc&&c.uvs5AttrDesc.count>0){var m=new Float32Array(e,c.uvs5AttrDesc.offset,c.uvs5AttrDesc.count);i.setVerticesData(s.b.UV5Kind,m,!1)}if(c.uvs6AttrDesc&&c.uvs6AttrDesc.count>0){var y=new Float32Array(e,c.uvs6AttrDesc.offset,c.uvs6AttrDesc.count);i.setVerticesData(s.b.UV6Kind,y,!1)}if(c.colorsAttrDesc&&c.colorsAttrDesc.count>0){var b=new Float32Array(e,c.colorsAttrDesc.offset,c.colorsAttrDesc.count);i.setVerticesData(s.b.ColorKind,b,!1,c.colorsAttrDesc.stride)}if(c.matricesIndicesAttrDesc&&c.matricesIndicesAttrDesc.count>0){for(var v=new Int32Array(e,c.matricesIndicesAttrDesc.offset,c.matricesIndicesAttrDesc.count),M=[],O=0;O<v.length;O++){var A=v[O];M.push(255&A),M.push((65280&A)>>8),M.push((16711680&A)>>16),M.push(A>>24&255)}i.setVerticesData(s.b.MatricesIndicesKind,M,!1)}if(c.matricesIndicesExtraAttrDesc&&c.matricesIndicesExtraAttrDesc.count>0){for(v=new Int32Array(e,c.matricesIndicesExtraAttrDesc.offset,c.matricesIndicesExtraAttrDesc.count),M=[],O=0;O<v.length;O++){A=v[O];M.push(255&A),M.push((65280&A)>>8),M.push((16711680&A)>>16),M.push(A>>24&255)}i.setVerticesData(s.b.MatricesIndicesExtraKind,M,!1)}if(c.matricesWeightsAttrDesc&&c.matricesWeightsAttrDesc.count>0){var P=new Float32Array(e,c.matricesWeightsAttrDesc.offset,c.matricesWeightsAttrDesc.count);i.setVerticesData(s.b.MatricesWeightsKind,P,!1)}if(c.indicesAttrDesc&&c.indicesAttrDesc.count>0){var x=new Int32Array(e,c.indicesAttrDesc.offset,c.indicesAttrDesc.count);i.setIndices(x,null)}if(c.subMeshesAttrDesc&&c.subMeshesAttrDesc.count>0){var T=new Int32Array(e,c.subMeshesAttrDesc.offset,5*c.subMeshesAttrDesc.count);i.subMeshes=[];for(O=0;O<c.subMeshesAttrDesc.count;O++){var I=T[5*O+0],R=T[5*O+1],C=T[5*O+2],D=T[5*O+3],S=T[5*O+4];a.a.AddToMesh(I,R,C,D,S,i)}}}else if(e.positions&&e.normals&&e.indices){if(i.setVerticesData(s.b.PositionKind,e.positions,e.positions._updatable),i.setVerticesData(s.b.NormalKind,e.normals,e.normals._updatable),e.tangents&&i.setVerticesData(s.b.TangentKind,e.tangents,e.tangents._updatable),e.uvs&&i.setVerticesData(s.b.UVKind,e.uvs,e.uvs._updatable),e.uvs2&&i.setVerticesData(s.b.UV2Kind,e.uvs2,e.uvs2._updatable),e.uvs3&&i.setVerticesData(s.b.UV3Kind,e.uvs3,e.uvs3._updatable),e.uvs4&&i.setVerticesData(s.b.UV4Kind,e.uvs4,e.uvs4._updatable),e.uvs5&&i.setVerticesData(s.b.UV5Kind,e.uvs5,e.uvs5._updatable),e.uvs6&&i.setVerticesData(s.b.UV6Kind,e.uvs6,e.uvs6._updatable),e.colors&&i.setVerticesData(s.b.ColorKind,n.b.CheckColors4(e.colors,e.positions.length/3),e.colors._updatable),e.matricesIndices)if(e.matricesIndices._isExpanded)delete e.matricesIndices._isExpanded,i.setVerticesData(s.b.MatricesIndicesKind,e.matricesIndices,e.matricesIndices._updatable);else{for(M=[],O=0;O<e.matricesIndices.length;O++){var E=e.matricesIndices[O];M.push(255&E),M.push((65280&E)>>8),M.push((16711680&E)>>16),M.push(E>>24&255)}i.setVerticesData(s.b.MatricesIndicesKind,M,e.matricesIndices._updatable)}if(e.matricesIndicesExtra)if(e.matricesIndicesExtra._isExpanded)delete e.matricesIndices._isExpanded,i.setVerticesData(s.b.MatricesIndicesExtraKind,e.matricesIndicesExtra,e.matricesIndicesExtra._updatable);else{for(M=[],O=0;O<e.matricesIndicesExtra.length;O++){E=e.matricesIndicesExtra[O];M.push(255&E),M.push((65280&E)>>8),M.push((16711680&E)>>16),M.push(E>>24&255)}i.setVerticesData(s.b.MatricesIndicesExtraKind,M,e.matricesIndicesExtra._updatable)}e.matricesWeights&&(t._CleanMatricesWeights(e,i),i.setVerticesData(s.b.MatricesWeightsKind,e.matricesWeights,e.matricesWeights._updatable)),e.matricesWeightsExtra&&i.setVerticesData(s.b.MatricesWeightsExtraKind,e.matricesWeightsExtra,e.matricesWeights._updatable),i.setIndices(e.indices,null)}if(e.subMeshes){i.subMeshes=[];for(var w=0;w<e.subMeshes.length;w++){var F=e.subMeshes[w];a.a.AddToMesh(F.materialIndex,F.verticesStart,F.verticesCount,F.indexStart,F.indexCount,i)}}i._shouldGenerateFlatShading&&(i.convertToFlatShadedMesh(),i._shouldGenerateFlatShading=!1),i.computeWorldMatrix(!0),r.onMeshImportedObservable.notifyObservers(i)},t._CleanMatricesWeights=function(t,e){if(h.a.CleanBoneMatrixWeights){var i=0;if(t.skeletonId>-1){var r=e.getScene().getLastSkeletonByID(t.skeletonId);if(r){i=r.bones.length;for(var n=e.getVerticesData(s.b.MatricesIndicesKind),o=e.getVerticesData(s.b.MatricesIndicesExtraKind),a=t.matricesWeights,c=t.matricesWeightsExtra,u=t.numBoneInfluencer,l=a.length,f=0;f<l;f+=4){for(var d=0,p=-1,_=0;_<4;_++){d+=g=a[f+_],g<.001&&p<0&&(p=_)}if(c)for(_=0;_<4;_++){var g;d+=g=c[f+_],g<.001&&p<0&&(p=_+4)}if((p<0||p>u-1)&&(p=u-1),d>.001){var m=1/d;for(_=0;_<4;_++)a[f+_]*=m;if(c)for(_=0;_<4;_++)c[f+_]*=m}else p>=4?(c[f+p-4]=1-d,o[f+p-4]=i):(a[f+p]=1-d,n[f+p]=i)}e.setVerticesData(s.b.MatricesIndicesKind,n),t.matricesWeightsExtra&&e.setVerticesData(s.b.MatricesIndicesExtraKind,o)}}}},t.Parse=function(e,i,n){if(i.getGeometryByID(e.id))return null;var a=new t(e.id,i,void 0,e.updatable);return l.a&&l.a.AddTagsTo(a,e.tags),e.delayLoadingFile?(a.delayLoadState=4,a.delayLoadingFile=n+e.delayLoadingFile,a._boundingInfo=new c.a(r.e.FromArray(e.boundingBoxMinimum),r.e.FromArray(e.boundingBoxMaximum)),a._delayInfo=[],e.hasUVs&&a._delayInfo.push(s.b.UVKind),e.hasUVs2&&a._delayInfo.push(s.b.UV2Kind),e.hasUVs3&&a._delayInfo.push(s.b.UV3Kind),e.hasUVs4&&a._delayInfo.push(s.b.UV4Kind),e.hasUVs5&&a._delayInfo.push(s.b.UV5Kind),e.hasUVs6&&a._delayInfo.push(s.b.UV6Kind),e.hasColors&&a._delayInfo.push(s.b.ColorKind),e.hasMatricesIndices&&a._delayInfo.push(s.b.MatricesIndicesKind),e.hasMatricesWeights&&a._delayInfo.push(s.b.MatricesWeightsKind),a._delayLoadingFunction=o.a.ImportVertexData):o.a.ImportVertexData(e,a),i.pushGeometry(a,!0),a},t}()},,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"b",(function(){return d})),i.d(e,"a",(function(){return g}));var r=i(3),n=i(78),o=i(2),s=i(0),a=i(139),h=i(195),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e._setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e}(Error),u=i(11),l=i(4),f=i(13),d=function(t){function e(i,r){var o=t.call(this,i)||this;return o.name="LoadFileError",c._setPrototypeOf(o,e.prototype),r instanceof n.a?o.request=r:o.file=r,o}return Object(r.d)(e,t),e}(c),p=function(t){function e(i,r){var n=t.call(this,i)||this;return n.request=r,n.name="RequestFileError",c._setPrototypeOf(n,e.prototype),n}return Object(r.d)(e,t),e}(c),_=function(t){function e(i,r){var n=t.call(this,i)||this;return n.file=r,n.name="ReadFileError",c._setPrototypeOf(n,e.prototype),n}return Object(r.d)(e,t),e}(c),g=function(){function t(){}return t._CleanUrl=function(t){return t=t.replace(/#/gm,"%23")},t.SetCorsBehavior=function(e,i){if((!e||0!==e.indexOf("data:"))&&t.CorsBehavior)if("string"==typeof t.CorsBehavior||this.CorsBehavior instanceof String)i.crossOrigin=t.CorsBehavior;else{var r=t.CorsBehavior(e);r&&(i.crossOrigin=r)}},t.LoadImage=function(e,i,r,n,o){var s;void 0===o&&(o="");var h=!1;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob?(s=URL.createObjectURL(new Blob([e],{type:o})),h=!0):s="data:"+o+";base64,"+u.a.EncodeArrayBufferToBase64(e):e instanceof Blob?(s=URL.createObjectURL(e),h=!0):(s=t._CleanUrl(e),s=t.PreprocessUrl(e)),"undefined"==typeof Image)return t.LoadFile(s,(function(t){createImageBitmap(new Blob([t],{type:o})).then((function(t){i(t),h&&URL.revokeObjectURL(s)})).catch((function(t){r&&r("Error while trying to load image: "+e,t)}))}),void 0,n||void 0,!0,(function(t,i){r&&r("Error while trying to load image: "+e,i)})),null;var c=new Image;t.SetCorsBehavior(s,c);var l=function(){c.removeEventListener("load",l),c.removeEventListener("error",f),i(c),h&&c.src&&URL.revokeObjectURL(c.src)},f=function(t){if(c.removeEventListener("load",l),c.removeEventListener("error",f),r){var i=e.toString();r("Error while trying to load image: "+(i.length<32?i:i.slice(0,32)+"..."),t)}h&&c.src&&URL.revokeObjectURL(c.src)};c.addEventListener("load",l),c.addEventListener("error",f);var d=function(){c.src=s};if("data:"!==s.substr(0,5)&&n&&n.enableTexturesOffline)n.open((function(){n&&n.loadImage(s,c)}),d);else{if(-1!==s.indexOf("file:")){var p=decodeURIComponent(s.substring(5).toLowerCase());if(a.a.FilesToLoad[p]){try{var _;try{_=URL.createObjectURL(a.a.FilesToLoad[p])}catch(t){_=URL.createObjectURL(a.a.FilesToLoad[p])}c.src=_,h=!0}catch(t){c.src=""}return c}}d()}return c},t.ReadFile=function(t,e,i,r,n){var o=new FileReader,a={onCompleteObservable:new s.a,abort:function(){return o.abort()}};return o.onloadend=function(t){return a.onCompleteObservable.notifyObservers(a)},n&&(o.onerror=function(e){n(new _("Unable to read "+t.name,t))}),o.onload=function(t){e(t.target.result)},i&&(o.onprogress=i),r?o.readAsArrayBuffer(t):o.readAsText(t),a},t.LoadFile=function(e,i,r,n,o,s){if(-1!==e.indexOf("file:")){var h=decodeURIComponent(e.substring(5).toLowerCase());0===h.indexOf("./")&&(h=h.substring(2));var c=a.a.FilesToLoad[h];if(c)return t.ReadFile(c,i,r,o,s?function(t){return s(void 0,new d(t.message,t.file))}:void 0)}return t.RequestFile(e,(function(t,e){i(t,e?e.responseURL:void 0)}),r,n,o,s?function(t){s(t.request,new d(t.message,t.request))}:void 0)},t.RequestFile=function(e,i,r,a,h,c,u){e=t._CleanUrl(e),e=t.PreprocessUrl(e);var l=t.BaseUrl+e,f=!1,d={onCompleteObservable:new s.a,abort:function(){return f=!0}},_=function(){var e=new n.a,s=null;d.abort=function(){f=!0,e.readyState!==(XMLHttpRequest.DONE||4)&&e.abort(),null!==s&&(clearTimeout(s),s=null)};var a=function(_){e.open("GET",l),u&&u(e),h&&(e.responseType="arraybuffer"),r&&e.addEventListener("progress",r);var g=function(){e.removeEventListener("loadend",g),d.onCompleteObservable.notifyObservers(d),d.onCompleteObservable.clear()};e.addEventListener("loadend",g);var m=function(){if(!f&&e.readyState===(XMLHttpRequest.DONE||4)){if(e.removeEventListener("readystatechange",m),e.status>=200&&e.status<300||0===e.status&&(!o.a.IsWindowObjectExist()||t.IsFileURL()))return void i(h?e.response:e.responseText,e);var r=t.DefaultRetryStrategy;if(r){var u=r(l,e,_);if(-1!==u)return e.removeEventListener("loadend",g),e=new n.a,void(s=setTimeout((function(){return a(_+1)}),u))}var d=new p("Error status: "+e.status+" "+e.statusText+" - Unable to load "+l,e);c&&c(d)}};e.addEventListener("readystatechange",m),e.send()};a(0)};if(a&&a.enableSceneOffline){var g=function(t){t&&t.status>400?c&&c(t):_()};a.open((function(){a&&a.loadFile(t.BaseUrl+e,(function(t){f||i(t),d.onCompleteObservable.notifyObservers(d)}),r?function(t){f||r(t)}:void 0,g,h)}),g)}else _();return d},t.IsFileURL=function(){return"file:"===location.protocol},t.DefaultRetryStrategy=h.a.ExponentialBackoff(),t.BaseUrl="",t.CorsBehavior="anonymous",t.PreprocessUrl=function(t){return t},t}();l.a._FileToolsLoadImage=g.LoadImage.bind(g),l.a._FileToolsLoadFile=g.LoadFile.bind(g),f.a._FileToolsLoadFile=g.LoadFile.bind(g)},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.toString=function(){return"{W: "+this.width+", H: "+this.height+"}"},t.prototype.getClassName=function(){return"Size"},t.prototype.getHashCode=function(){var t=0|this.width;return t=397*t^(0|this.height)},t.prototype.copyFrom=function(t){this.width=t.width,this.height=t.height},t.prototype.copyFromFloats=function(t,e){return this.width=t,this.height=e,this},t.prototype.set=function(t,e){return this.copyFromFloats(t,e)},t.prototype.multiplyByFloats=function(e,i){return new t(this.width*e,this.height*i)},t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.equals=function(t){return!!t&&(this.width===t.width&&this.height===t.height)},Object.defineProperty(t.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.Zero=function(){return new t(0,0)},t.prototype.add=function(e){return new t(this.width+e.width,this.height+e.height)},t.prototype.subtract=function(e){return new t(this.width-e.width,this.height-e.height)},t.Lerp=function(e,i,r){return new t(e.width+(i.width-e.width)*r,e.height+(i.height-e.height)*r)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(1),n=(i(202),function(){function t(t,e,i){this._alreadyBound=!1,this._valueCache={},this._engine=t,this._noUBO=!t.supportsUniformBuffers,this._dynamic=i,this._data=e||[],this._uniformLocations={},this._uniformSizes={},this._uniformLocationPointer=0,this._needSync=!1,this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform)}return Object.defineProperty(t.prototype,"useUbo",{get:function(){return!this._noUBO},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSync",{get:function(){return!this._needSync},enumerable:!1,configurable:!0}),t.prototype.isDynamic=function(){return void 0!==this._dynamic},t.prototype.getData=function(){return this._bufferData},t.prototype.getBuffer=function(){return this._buffer},t.prototype._fillAlignment=function(t){var e;if(e=t<=2?t:4,this._uniformLocationPointer%e!=0){var i=this._uniformLocationPointer;this._uniformLocationPointer+=e-this._uniformLocationPointer%e;for(var r=this._uniformLocationPointer-i,n=0;n<r;n++)this._data.push(0)}},t.prototype.addUniform=function(t,e){if(!this._noUBO&&void 0===this._uniformLocations[t]){var i;if(e instanceof Array)e=(i=e).length;else{e=e,i=[];for(var r=0;r<e;r++)i.push(0)}this._fillAlignment(e),this._uniformSizes[t]=e,this._uniformLocations[t]=this._uniformLocationPointer,this._uniformLocationPointer+=e;for(r=0;r<e;r++)this._data.push(i[r]);this._needSync=!0}},t.prototype.addMatrix=function(t,e){this.addUniform(t,Array.prototype.slice.call(e.toArray()))},t.prototype.addFloat2=function(t,e,i){var r=[e,i];this.addUniform(t,r)},t.prototype.addFloat3=function(t,e,i,r){var n=[e,i,r];this.addUniform(t,n)},t.prototype.addColor3=function(t,e){var i=new Array;e.toArray(i),this.addUniform(t,i)},t.prototype.addColor4=function(t,e,i){var r=new Array;e.toArray(r),r.push(i),this.addUniform(t,r)},t.prototype.addVector3=function(t,e){var i=new Array;e.toArray(i),this.addUniform(t,i)},t.prototype.addMatrix3x3=function(t){this.addUniform(t,12)},t.prototype.addMatrix2x2=function(t){this.addUniform(t,8)},t.prototype.create=function(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)},t.prototype._rebuild=function(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData))},t.prototype.update=function(){this._buffer?(this._dynamic||this._needSync)&&(this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._needSync=!1):this.create()},t.prototype.updateUniform=function(t,e,i){var n=this._uniformLocations[t];if(void 0===n){if(this._buffer)return void r.a.Error("Cannot add an uniform after UBO has been created.");this.addUniform(t,i),n=this._uniformLocations[t]}if(this._buffer||this.create(),this._dynamic)for(s=0;s<i;s++)this._bufferData[n+s]=e[s];else{for(var o=!1,s=0;s<i;s++)16!==i&&this._bufferData[n+s]===e[s]||(o=!0,this._bufferData[n+s]=e[s]);this._needSync=this._needSync||o}},t.prototype._cacheMatrix=function(t,e){var i=this._valueCache[t],r=e.updateFlag;return(void 0===i||i!==r)&&(this._valueCache[t]=r,!0)},t.prototype._updateMatrix3x3ForUniform=function(e,i){for(var r=0;r<3;r++)t._tempBuffer[4*r]=i[3*r],t._tempBuffer[4*r+1]=i[3*r+1],t._tempBuffer[4*r+2]=i[3*r+2],t._tempBuffer[4*r+3]=0;this.updateUniform(e,t._tempBuffer,12)},t.prototype._updateMatrix3x3ForEffect=function(t,e){this._currentEffect.setMatrix3x3(t,e)},t.prototype._updateMatrix2x2ForEffect=function(t,e){this._currentEffect.setMatrix2x2(t,e)},t.prototype._updateMatrix2x2ForUniform=function(e,i){for(var r=0;r<2;r++)t._tempBuffer[4*r]=i[2*r],t._tempBuffer[4*r+1]=i[2*r+1],t._tempBuffer[4*r+2]=0,t._tempBuffer[4*r+3]=0;this.updateUniform(e,t._tempBuffer,8)},t.prototype._updateFloatForEffect=function(t,e){this._currentEffect.setFloat(t,e)},t.prototype._updateFloatForUniform=function(e,i){t._tempBuffer[0]=i,this.updateUniform(e,t._tempBuffer,1)},t.prototype._updateFloat2ForEffect=function(t,e,i,r){void 0===r&&(r=""),this._currentEffect.setFloat2(t+r,e,i)},t.prototype._updateFloat2ForUniform=function(e,i,r){t._tempBuffer[0]=i,t._tempBuffer[1]=r,this.updateUniform(e,t._tempBuffer,2)},t.prototype._updateFloat3ForEffect=function(t,e,i,r,n){void 0===n&&(n=""),this._currentEffect.setFloat3(t+n,e,i,r)},t.prototype._updateFloat3ForUniform=function(e,i,r,n){t._tempBuffer[0]=i,t._tempBuffer[1]=r,t._tempBuffer[2]=n,this.updateUniform(e,t._tempBuffer,3)},t.prototype._updateFloat4ForEffect=function(t,e,i,r,n,o){void 0===o&&(o=""),this._currentEffect.setFloat4(t+o,e,i,r,n)},t.prototype._updateFloat4ForUniform=function(e,i,r,n,o){t._tempBuffer[0]=i,t._tempBuffer[1]=r,t._tempBuffer[2]=n,t._tempBuffer[3]=o,this.updateUniform(e,t._tempBuffer,4)},t.prototype._updateMatrixForEffect=function(t,e){this._currentEffect.setMatrix(t,e)},t.prototype._updateMatrixForUniform=function(t,e){this._cacheMatrix(t,e)&&this.updateUniform(t,e.toArray(),16)},t.prototype._updateVector3ForEffect=function(t,e){this._currentEffect.setVector3(t,e)},t.prototype._updateVector3ForUniform=function(e,i){i.toArray(t._tempBuffer),this.updateUniform(e,t._tempBuffer,3)},t.prototype._updateVector4ForEffect=function(t,e){this._currentEffect.setVector4(t,e)},t.prototype._updateVector4ForUniform=function(e,i){i.toArray(t._tempBuffer),this.updateUniform(e,t._tempBuffer,4)},t.prototype._updateColor3ForEffect=function(t,e,i){void 0===i&&(i=""),this._currentEffect.setColor3(t+i,e)},t.prototype._updateColor3ForUniform=function(e,i){i.toArray(t._tempBuffer),this.updateUniform(e,t._tempBuffer,3)},t.prototype._updateColor4ForEffect=function(t,e,i,r){void 0===r&&(r=""),this._currentEffect.setColor4(t+r,e,i)},t.prototype._updateColor4ForUniform=function(e,i,r){i.toArray(t._tempBuffer),t._tempBuffer[3]=r,this.updateUniform(e,t._tempBuffer,4)},t.prototype.setTexture=function(t,e){this._currentEffect.setTexture(t,e)},t.prototype.updateUniformDirectly=function(t,e){this.updateUniform(t,e,e.length),this.update()},t.prototype.bindToEffect=function(t,e){this._currentEffect=t,!this._noUBO&&this._buffer&&(this._alreadyBound=!0,t.bindUniformBuffer(this._buffer,e))},t.prototype.dispose=function(){if(!this._noUBO){var t=this._engine._uniformBuffers,e=t.indexOf(this);-1!==e&&(t[e]=t[t.length-1],t.pop()),this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}},t._MAX_UNIFORM_SIZE=256,t._tempBuffer=new Float32Array(t._MAX_UNIFORM_SIZE),t}())},,,function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a})),i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return c}));var r=i(3),n=i(98),o=function(){function t(){this._easingMode=t.EASINGMODE_EASEIN}return t.prototype.setEasingMode=function(t){var e=Math.min(Math.max(t,0),2);this._easingMode=e},t.prototype.getEasingMode=function(){return this._easingMode},t.prototype.easeInCore=function(t){throw new Error("You must implement this method")},t.prototype.ease=function(e){switch(this._easingMode){case t.EASINGMODE_EASEIN:return this.easeInCore(e);case t.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-e)}return e>=.5?.5*(1-this.easeInCore(2*(1-e)))+.5:.5*this.easeInCore(2*e)},t.EASINGMODE_EASEIN=0,t.EASINGMODE_EASEOUT=1,t.EASINGMODE_EASEINOUT=2,t}(),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.easeInCore=function(t){return t=Math.max(0,Math.min(1,t)),1-Math.sqrt(1-t*t)},e}(o),a=function(t){function e(e){void 0===e&&(e=1);var i=t.call(this)||this;return i.amplitude=e,i}return Object(r.d)(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.amplitude);return Math.pow(t,3)-t*e*Math.sin(3.141592653589793*t)},e}(o),h=(function(t){function e(e,i){void 0===e&&(e=3),void 0===i&&(i=2);var r=t.call(this)||this;return r.bounces=e,r.bounciness=i,r}Object(r.d)(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.bounces),i=this.bounciness;i<=1&&(i=1.001);var r=Math.pow(i,e),n=1-i,o=(1-r)/n+.5*r,s=t*o,a=Math.log(-s*(1-i)+1)/Math.log(i),h=Math.floor(a),c=h+1,u=(1-Math.pow(i,h))/(n*o),l=.5*(u+(1-Math.pow(i,c))/(n*o)),f=t-l,d=l-u;return-Math.pow(1/i,e-h)/(d*d)*(f-d)*(f+d)}}(o),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.d)(e,t),e.prototype.easeInCore=function(t){return t*t*t}}(o),function(t){function e(e,i){void 0===e&&(e=3),void 0===i&&(i=3);var r=t.call(this)||this;return r.oscillations=e,r.springiness=i,r}Object(r.d)(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.oscillations),i=Math.max(0,this.springiness);return(0==i?t:(Math.exp(i*t)-1)/(Math.exp(i)-1))*Math.sin((6.283185307179586*e+1.5707963267948966)*t)}}(o),function(t){function e(e){void 0===e&&(e=2);var i=t.call(this)||this;return i.exponent=e,i}return Object(r.d)(e,t),e.prototype.easeInCore=function(t){return this.exponent<=0?t:(Math.exp(this.exponent*t)-1)/(Math.exp(this.exponent)-1)},e}(o)),c=(function(t){function e(e){void 0===e&&(e=2);var i=t.call(this)||this;return i.power=e,i}Object(r.d)(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.power);return Math.pow(t,e)}}(o),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.d)(e,t),e.prototype.easeInCore=function(t){return t*t}}(o),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.d)(e,t),e.prototype.easeInCore=function(t){return t*t*t*t}}(o),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.d)(e,t),e.prototype.easeInCore=function(t){return t*t*t*t*t}}(o),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.d)(e,t),e.prototype.easeInCore=function(t){return 1-Math.sin(1.5707963267948966*(1-t))},e}(o));!function(t){function e(e,i,r,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=1);var o=t.call(this)||this;return o.x1=e,o.y1=i,o.x2=r,o.y2=n,o}Object(r.d)(e,t),e.prototype.easeInCore=function(t){return n.a.Interpolate(t,this.x1,this.y1,this.x2,this.y2)}}(o)},,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(t,e,i,r,n,o){this.source=t,this.pointerX=e,this.pointerY=i,this.meshUnderPointer=r,this.sourceEvent=n,this.additionalData=o}return t.CreateNew=function(e,i,r){var n=e.getScene();return new t(e,n.pointerX,n.pointerY,n.meshUnderPointer||e,i,r)},t.CreateNewFromSprite=function(e,i,r,n){return new t(e,i.pointerX,i.pointerY,i.meshUnderPointer,r,n)},t.CreateNewFromScene=function(e,i){return new t(null,e.pointerX,e.pointerY,e.meshUnderPointer,i)},t.CreateNewFromPrimitive=function(e,i,r,n){return new t(e,i.x,i.y,null,r,n)},t}()},,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.FilesToLoad={},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(89),n=function(){function t(){}return t.GetPlanes=function(e){for(var i=[],n=0;n<6;n++)i.push(new r.a(0,0,0,0));return t.GetPlanesToRef(e,i),i},t.GetNearPlaneToRef=function(t,e){var i=t.m;e.normal.x=i[3]+i[2],e.normal.y=i[7]+i[6],e.normal.z=i[11]+i[10],e.d=i[15]+i[14],e.normalize()},t.GetFarPlaneToRef=function(t,e){var i=t.m;e.normal.x=i[3]-i[2],e.normal.y=i[7]-i[6],e.normal.z=i[11]-i[10],e.d=i[15]-i[14],e.normalize()},t.GetLeftPlaneToRef=function(t,e){var i=t.m;e.normal.x=i[3]+i[0],e.normal.y=i[7]+i[4],e.normal.z=i[11]+i[8],e.d=i[15]+i[12],e.normalize()},t.GetRightPlaneToRef=function(t,e){var i=t.m;e.normal.x=i[3]-i[0],e.normal.y=i[7]-i[4],e.normal.z=i[11]-i[8],e.d=i[15]-i[12],e.normalize()},t.GetTopPlaneToRef=function(t,e){var i=t.m;e.normal.x=i[3]-i[1],e.normal.y=i[7]-i[5],e.normal.z=i[11]-i[9],e.d=i[15]-i[13],e.normalize()},t.GetBottomPlaneToRef=function(t,e){var i=t.m;e.normal.x=i[3]+i[1],e.normal.y=i[7]+i[5],e.normal.z=i[11]+i[9],e.d=i[15]+i[13],e.normalize()},t.GetPlanesToRef=function(e,i){t.GetNearPlaneToRef(e,i[0]),t.GetFarPlaneToRef(e,i[1]),t.GetLeftPlaneToRef(e,i[2]),t.GetRightPlaneToRef(e,i[3]),t.GetTopPlaneToRef(e,i[4]),t.GetBottomPlaneToRef(e,i[5])},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(49),n=i(40),o=function(){function t(t){this._vertexBuffers={},this._scene=t}return t.prototype._prepareBuffers=function(){if(!this._vertexBuffers[n.b.PositionKind]){var t=[];t.push(1,1),t.push(-1,1),t.push(-1,-1),t.push(1,-1),this._vertexBuffers[n.b.PositionKind]=new n.b(this._scene.getEngine(),t,n.b.PositionKind,!1,!1,2),this._buildIndexBuffer()}},t.prototype._buildIndexBuffer=function(){var t=[];t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(t)},t.prototype._rebuild=function(){var t=this._vertexBuffers[n.b.PositionKind];t&&(t._rebuild(),this._buildIndexBuffer())},t.prototype._prepareFrame=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=this._scene.activeCamera;return!!i&&(!(!(e=e||i._postProcesses.filter((function(t){return null!=t})))||0===e.length||!this._scene.postProcessesEnabled)&&(e[0].activate(i,t,null!=e),!0))},t.prototype.directRender=function(t,e,i,n,o,s){void 0===e&&(e=null),void 0===i&&(i=!1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=!1);for(var a=this._scene.getEngine(),h=0;h<t.length;h++){h<t.length-1?t[h+1].activate(this._scene.activeCamera,e):e?a.bindFramebuffer(e,n,void 0,void 0,i,o):s||a.restoreDefaultFramebuffer();var c=t[h],u=c.apply();u&&(c.onBeforeRenderObservable.notifyObservers(u),this._prepareBuffers(),a.bindBuffers(this._vertexBuffers,this._indexBuffer,u),a.drawElementsType(r.a.TriangleFillMode,0,6),c.onAfterRenderObservable.notifyObservers(u))}a.setDepthBuffer(!0),a.setDepthWrite(!0)},t.prototype._finalizeFrame=function(t,e,i,n,o){void 0===o&&(o=!1);var s=this._scene.activeCamera;if(s&&0!==(n=n||s._postProcesses.filter((function(t){return null!=t}))).length&&this._scene.postProcessesEnabled){for(var a=this._scene.getEngine(),h=0,c=n.length;h<c;h++){var u=n[h];if(h<c-1?u._outputTexture=n[h+1].activate(s,e):e?(a.bindFramebuffer(e,i,void 0,void 0,o),u._outputTexture=e):(a.restoreDefaultFramebuffer(),u._outputTexture=null),t)break;var l=u.apply();l&&(u.onBeforeRenderObservable.notifyObservers(l),this._prepareBuffers(),a.bindBuffers(this._vertexBuffers,this._indexBuffer,l),a.drawElementsType(r.a.TriangleFillMode,0,6),u.onAfterRenderObservable.notifyObservers(l))}a.setDepthBuffer(!0),a.setDepthWrite(!0),a.setAlphaMode(0)}},t.prototype.dispose=function(){var t=this._vertexBuffers[n.b.PositionKind];t&&(t.dispose(),this._vertexBuffers[n.b.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(203),n=function(){},o=function(){function t(e){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new n,this._scene=e;for(var i=t.MIN_RENDERINGGROUPS;i<t.MAX_RENDERINGGROUPS;i++)this._autoClearDepthStencil[i]={autoClear:!0,depth:!0,stencil:!0}}return t.prototype._clearDepthStencilBuffer=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0),this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,t,e),this._depthStencilBufferAlreadyCleaned=!0)},t.prototype.render=function(e,i,r,n){var o=this._renderingGroupInfo;if(o.scene=this._scene,o.camera=this._scene.activeCamera,this._scene.spriteManagers&&n)for(var s=0;s<this._scene.spriteManagers.length;s++){var a=this._scene.spriteManagers[s];this.dispatchSprites(a)}for(s=t.MIN_RENDERINGGROUPS;s<t.MAX_RENDERINGGROUPS;s++){this._depthStencilBufferAlreadyCleaned=s===t.MIN_RENDERINGGROUPS;var h=this._renderingGroups[s];if(h){var c=Math.pow(2,s);if(o.renderingGroupId=s,this._scene.onBeforeRenderingGroupObservable.notifyObservers(o,c),t.AUTOCLEAR){var u=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(s):this._autoClearDepthStencil[s];u&&u.autoClear&&this._clearDepthStencilBuffer(u.depth,u.stencil)}for(var l=0,f=this._scene._beforeRenderingGroupDrawStage;l<f.length;l++){f[l].action(s)}h.render(e,n,r,i);for(var d=0,p=this._scene._afterRenderingGroupDrawStage;d<p.length;d++){p[d].action(s)}this._scene.onAfterRenderingGroupObservable.notifyObservers(o,c)}}},t.prototype.reset=function(){for(var e=t.MIN_RENDERINGGROUPS;e<t.MAX_RENDERINGGROUPS;e++){var i=this._renderingGroups[e];i&&i.prepare()}},t.prototype.dispose=function(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null},t.prototype.freeRenderingGroups=function(){for(var e=t.MIN_RENDERINGGROUPS;e<t.MAX_RENDERINGGROUPS;e++){var i=this._renderingGroups[e];i&&i.dispose()}},t.prototype._prepareRenderingGroup=function(t){void 0===this._renderingGroups[t]&&(this._renderingGroups[t]=new r.a(t,this._scene,this._customOpaqueSortCompareFn[t],this._customAlphaTestSortCompareFn[t],this._customTransparentSortCompareFn[t]))},t.prototype.dispatchSprites=function(t){var e=t.renderingGroupId||0;this._prepareRenderingGroup(e),this._renderingGroups[e].dispatchSprites(t)},t.prototype.dispatchParticles=function(t){var e=t.renderingGroupId||0;this._prepareRenderingGroup(e),this._renderingGroups[e].dispatchParticles(t)},t.prototype.dispatch=function(t,e,i){void 0===e&&(e=t.getMesh());var r=e.renderingGroupId||0;this._prepareRenderingGroup(r),this._renderingGroups[r].dispatch(t,e,i)},t.prototype.setRenderingOrder=function(t,e,i,r){if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this._customOpaqueSortCompareFn[t]=e,this._customAlphaTestSortCompareFn[t]=i,this._customTransparentSortCompareFn[t]=r,this._renderingGroups[t]){var n=this._renderingGroups[t];n.opaqueSortCompareFn=this._customOpaqueSortCompareFn[t],n.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[t],n.transparentSortCompareFn=this._customTransparentSortCompareFn[t]}},t.prototype.setRenderingAutoClearDepthStencil=function(t,e,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0),this._autoClearDepthStencil[t]={autoClear:e,depth:i,stencil:r}},t.prototype.getAutoClearDepthStencilSetup=function(t){return this._autoClearDepthStencil[t]},t.MAX_RENDERINGGROUPS=4,t.MIN_RENDERINGGROUPS=0,t.AUTOCLEAR=!0,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return Object.defineProperty(t,"ForceFullSceneLoadingForIncremental",{get:function(){return t._ForceFullSceneLoadingForIncremental},set:function(e){t._ForceFullSceneLoadingForIncremental=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ShowLoadingScreen",{get:function(){return t._ShowLoadingScreen},set:function(e){t._ShowLoadingScreen=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loggingLevel",{get:function(){return t._loggingLevel},set:function(e){t._loggingLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CleanBoneMatrixWeights",{get:function(){return t._CleanBoneMatrixWeights},set:function(e){t._CleanBoneMatrixWeights=e},enumerable:!1,configurable:!0}),t._ForceFullSceneLoadingForIncremental=!1,t._ShowLoadingScreen=!0,t._CleanBoneMatrixWeights=!1,t._loggingLevel=0,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(3),n=i(212),o=i(210),s=i(211),a=function(t){function e(e){return t.call(this,e)||this}return Object(r.d)(e,t),e.prototype.addMouseWheel=function(){return this.add(new s.a),this},e.prototype.addPointers=function(){return this.add(new n.a),this},e.prototype.addKeyboard=function(){return this.add(new o.a),this},e}(i(53).b)},,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){this.hoverCursor="",this.actions=new Array,this.isRecursive=!1}return Object.defineProperty(t,"HasTriggers",{get:function(){for(var e in t.Triggers)if(t.Triggers.hasOwnProperty(e))return!0;return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"HasPickTriggers",{get:function(){for(var e in t.Triggers)if(t.Triggers.hasOwnProperty(e)){var i=parseInt(e);if(i>=1&&i<=7)return!0}return!1},enumerable:!1,configurable:!0}),t.HasSpecificTrigger=function(e){for(var i in t.Triggers){if(t.Triggers.hasOwnProperty(i))if(parseInt(i)===e)return!0}return!1},t.Triggers={},t}()},function(t,e,i){"use strict";var r;i.d(e,"a",(function(){return r})),function(t){t[t.STEP=1]="STEP"}(r||(r={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(t,e,i){this.name=t,this.from=e,this.to=i}return t.prototype.clone=function(){return new t(this.name,this.from,this.to)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){this._count=0,this._data={}}return t.prototype.copyFrom=function(t){var e=this;this.clear(),t.forEach((function(t,i){return e.add(t,i)}))},t.prototype.get=function(t){var e=this._data[t];if(void 0!==e)return e},t.prototype.getOrAddWithFactory=function(t,e){var i=this.get(t);return void 0!==i||(i=e(t))&&this.add(t,i),i},t.prototype.getOrAdd=function(t,e){var i=this.get(t);return void 0!==i?i:(this.add(t,e),e)},t.prototype.contains=function(t){return void 0!==this._data[t]},t.prototype.add=function(t,e){return void 0===this._data[t]&&(this._data[t]=e,++this._count,!0)},t.prototype.set=function(t,e){return void 0!==this._data[t]&&(this._data[t]=e,!0)},t.prototype.getAndRemove=function(t){var e=this.get(t);return void 0!==e?(delete this._data[t],--this._count,e):null},t.prototype.remove=function(t){return!!this.contains(t)&&(delete this._data[t],--this._count,!0)},t.prototype.clear=function(){this._data={},this._count=0},Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){for(var e in this._data){t(e,this._data[e])}},t.prototype.first=function(t){for(var e in this._data){var i=t(e,this._data[e]);if(i)return i}return null},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i(85),n=i(34),o=i(60),s=function(){function t(t,e,i){this.vectors=r.a.BuildArray(8,n.e.Zero),this.center=n.e.Zero(),this.centerWorld=n.e.Zero(),this.extendSize=n.e.Zero(),this.extendSizeWorld=n.e.Zero(),this.directions=r.a.BuildArray(3,n.e.Zero),this.vectorsWorld=r.a.BuildArray(8,n.e.Zero),this.minimumWorld=n.e.Zero(),this.maximumWorld=n.e.Zero(),this.minimum=n.e.Zero(),this.maximum=n.e.Zero(),this.reConstruct(t,e,i)}return t.prototype.reConstruct=function(t,e,i){var r=t.x,o=t.y,s=t.z,a=e.x,h=e.y,c=e.z,u=this.vectors;this.minimum.copyFromFloats(r,o,s),this.maximum.copyFromFloats(a,h,c),u[0].copyFromFloats(r,o,s),u[1].copyFromFloats(a,h,c),u[2].copyFromFloats(a,o,s),u[3].copyFromFloats(r,h,s),u[4].copyFromFloats(r,o,c),u[5].copyFromFloats(a,h,s),u[6].copyFromFloats(r,h,c),u[7].copyFromFloats(a,o,c),e.addToRef(t,this.center).scaleInPlace(.5),e.subtractToRef(t,this.extendSize).scaleInPlace(.5),this._worldMatrix=i||n.a.IdentityReadOnly,this._update(this._worldMatrix)},t.prototype.scale=function(e){var i=t.TmpVector3,r=this.maximum.subtractToRef(this.minimum,i[0]),n=r.length();r.normalizeFromLength(n);var o=n*e,s=r.scaleInPlace(.5*o),a=this.center.subtractToRef(s,i[1]),h=this.center.addToRef(s,i[2]);return this.reConstruct(a,h,this._worldMatrix),this},t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(t){var e=this.minimumWorld,i=this.maximumWorld,r=this.directions,o=this.vectorsWorld,s=this.vectors;if(t.isIdentity()){e.copyFrom(this.minimum),i.copyFrom(this.maximum);for(a=0;a<8;++a)o[a].copyFrom(s[a]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{e.setAll(Number.MAX_VALUE),i.setAll(-Number.MAX_VALUE);for(var a=0;a<8;++a){var h=o[a];n.e.TransformCoordinatesToRef(s[a],t,h),e.minimizeInPlace(h),i.maximizeInPlace(h)}i.subtractToRef(e,this.extendSizeWorld).scaleInPlace(.5),i.addToRef(e,this.centerWorld).scaleInPlace(.5)}n.e.FromArrayToRef(t.m,0,r[0]),n.e.FromArrayToRef(t.m,4,r[1]),n.e.FromArrayToRef(t.m,8,r[2]),this._worldMatrix=t},t.prototype.isInFrustum=function(e){return t.IsInFrustum(this.vectorsWorld,e)},t.prototype.isCompletelyInFrustum=function(e){return t.IsCompletelyInFrustum(this.vectorsWorld,e)},t.prototype.intersectsPoint=function(t){var e=this.minimumWorld,i=this.maximumWorld,r=e.x,n=e.y,s=e.z,a=i.x,h=i.y,c=i.z,u=t.x,l=t.y,f=t.z,d=-o.a;return!(a-u<d||d>u-r)&&(!(h-l<d||d>l-n)&&!(c-f<d||d>f-s))},t.prototype.intersectsSphere=function(e){return t.IntersectsSphere(this.minimumWorld,this.maximumWorld,e.centerWorld,e.radiusWorld)},t.prototype.intersectsMinMax=function(t,e){var i=this.minimumWorld,r=this.maximumWorld,n=i.x,o=i.y,s=i.z,a=r.x,h=r.y,c=r.z,u=t.x,l=t.y,f=t.z,d=e.x,p=e.y,_=e.z;return!(a<u||n>d)&&(!(h<l||o>p)&&!(c<f||s>_))},t.Intersects=function(t,e){return t.intersectsMinMax(e.minimumWorld,e.maximumWorld)},t.IntersectsSphere=function(e,i,r,o){var s=t.TmpVector3[0];return n.e.ClampToRef(r,e,i,s),n.e.DistanceSquared(r,s)<=o*o},t.IsCompletelyInFrustum=function(t,e){for(var i=0;i<6;++i)for(var r=e[i],n=0;n<8;++n)if(r.dotCoordinate(t[n])<0)return!1;return!0},t.IsInFrustum=function(t,e){for(var i=0;i<6;++i){for(var r=!0,n=e[i],o=0;o<8;++o)if(n.dotCoordinate(t[o])>=0){r=!1;break}if(r)return!1}return!0},t.TmpVector3=r.a.BuildArray(3,n.e.Zero),t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(85),n=i(34),o=function(){function t(t,e,i){this.center=n.e.Zero(),this.centerWorld=n.e.Zero(),this.minimum=n.e.Zero(),this.maximum=n.e.Zero(),this.reConstruct(t,e,i)}return t.prototype.reConstruct=function(t,e,i){this.minimum.copyFrom(t),this.maximum.copyFrom(e);var r=n.e.Distance(t,e);e.addToRef(t,this.center).scaleInPlace(.5),this.radius=.5*r,this._update(i||n.a.IdentityReadOnly)},t.prototype.scale=function(e){var i=this.radius*e,r=t.TmpVector3,n=r[0].setAll(i),o=this.center.subtractToRef(n,r[1]),s=this.center.addToRef(n,r[2]);return this.reConstruct(o,s,this._worldMatrix),this},t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(e){if(e.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{n.e.TransformCoordinatesToRef(this.center,e,this.centerWorld);var i=t.TmpVector3[0];n.e.TransformNormalFromFloatsToRef(1,1,1,e,i),this.radiusWorld=Math.max(Math.abs(i.x),Math.abs(i.y),Math.abs(i.z))*this.radius}},t.prototype.isInFrustum=function(t){for(var e=this.centerWorld,i=this.radiusWorld,r=0;r<6;r++)if(t[r].dotCoordinate(e)<=-i)return!1;return!0},t.prototype.isCenterInFrustum=function(t){for(var e=this.centerWorld,i=0;i<6;i++)if(t[i].dotCoordinate(e)<0)return!1;return!0},t.prototype.intersectsPoint=function(t){var e=n.e.DistanceSquared(this.centerWorld,t);return!(this.radiusWorld*this.radiusWorld<e)},t.Intersects=function(t,e){var i=n.e.DistanceSquared(t.centerWorld,e.centerWorld),r=t.radiusWorld+e.radiusWorld;return!(r*r<i)},t.TmpVector3=r.a.BuildArray(3,n.e.Zero),t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(t,e,i){this.bu=t,this.bv=e,this.distance=i,this.faceId=0,this.subMeshId=0}},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.Eval=function(e,i){return"true"===(e=e.match(/\([^\(\)]*\)/g)?e.replace(/\([^\(\)]*\)/g,(function(e){return e=e.slice(1,e.length-1),t._HandleParenthesisContent(e,i)})):t._HandleParenthesisContent(e,i))||"false"!==e&&t.Eval(e,i)},t._HandleParenthesisContent=function(e,i){var r;i=i||function(t){return"true"===t};var n=e.split("||");for(var o in n)if(n.hasOwnProperty(o)){var s=t._SimplifyNegation(n[o].trim()),a=s.split("&&");if(a.length>1)for(var h=0;h<a.length;++h){var c=t._SimplifyNegation(a[h].trim());if(!(r="true"!==c&&"false"!==c?"!"===c[0]?!i(c.substring(1)):i(c):"true"===c)){s="false";break}}if(r||"true"===s){r=!0;break}r="true"!==s&&"false"!==s?"!"===s[0]?!i(s.substring(1)):i(s):"true"===s}return r?"true":"false"},t._SimplifyNegation=function(t){return"!true"===(t=(t=t.replace(/^[\s!]+/,(function(t){return(t=t.replace(/[\s]/g,(function(){return""}))).length%2?"!":""}))).trim())?t="false":"!false"===t&&(t="true"),t},t}()},,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.ExponentialBackoff=function(t,e){return void 0===t&&(t=3),void 0===e&&(e=500),function(i,r,n){return 0!==r.status||n>=t||-1!==i.indexOf("file:")?-1:Math.pow(2,n)*e}},t}()},function(t,e,i){"use strict";var r;i.d(e,"a",(function(){return s})),function(t){t[t.Pending=0]="Pending",t[t.Fulfilled=1]="Fulfilled",t[t.Rejected=2]="Rejected"}(r||(r={}));var n=function(){this.count=0,this.target=0,this.results=[]},o=function(){function t(t){var e=this;if(this._state=r.Pending,this._children=new Array,this._rejectWasConsumed=!1,t)try{t((function(t){e._resolve(t)}),(function(t){e._reject(t)}))}catch(t){this._reject(t)}}return Object.defineProperty(t.prototype,"_result",{get:function(){return this._resultValue},set:function(t){this._resultValue=t,this._parent&&void 0===this._parent._result&&(this._parent._result=t)},enumerable:!1,configurable:!0}),t.prototype.catch=function(t){return this.then(void 0,t)},t.prototype.then=function(e,i){var n=this,o=new t;return o._onFulfilled=e,o._onRejected=i,this._children.push(o),o._parent=this,this._state!==r.Pending&&setTimeout((function(){if(n._state===r.Fulfilled||n._rejectWasConsumed){var t=o._resolve(n._result);if(null!=t)if(void 0!==t._state){var e=t;o._children.push(e),e._parent=o,o=e}else o._result=t}else o._reject(n._reason)})),o},t.prototype._moveChildren=function(t){var e,i=this;if((e=this._children).push.apply(e,t.splice(0,t.length)),this._children.forEach((function(t){t._parent=i})),this._state===r.Fulfilled)for(var n=0,o=this._children;n<o.length;n++){o[n]._resolve(this._result)}else if(this._state===r.Rejected)for(var s=0,a=this._children;s<a.length;s++){a[s]._reject(this._reason)}},t.prototype._resolve=function(t){try{this._state=r.Fulfilled;var e=null;if(this._onFulfilled&&(e=this._onFulfilled(t)),null!=e)if(void 0!==e._state){var i=e;i._parent=this,i._moveChildren(this._children),t=i._result}else t=e;this._result=t;for(var n=0,o=this._children;n<o.length;n++){o[n]._resolve(t)}this._children.length=0,delete this._onFulfilled,delete this._onRejected}catch(t){this._reject(t,!0)}},t.prototype._reject=function(t,e){if(void 0===e&&(e=!1),this._state=r.Rejected,this._reason=t,this._onRejected&&!e)try{this._onRejected(t),this._rejectWasConsumed=!0}catch(e){t=e}for(var i=0,n=this._children;i<n.length;i++){var o=n[i];this._rejectWasConsumed?o._resolve(null):o._reject(t)}this._children.length=0,delete this._onFulfilled,delete this._onRejected},t.resolve=function(e){var i=new t;return i._resolve(e),i},t._RegisterForFulfillment=function(t,e,i){t.then((function(t){return e.results[i]=t,e.count++,e.count===e.target&&e.rootPromise._resolve(e.results),null}),(function(t){e.rootPromise._state!==r.Rejected&&e.rootPromise._reject(t)}))},t.all=function(e){var i=new t,r=new n;if(r.target=e.length,r.rootPromise=i,e.length)for(var o=0;o<e.length;o++)t._RegisterForFulfillment(e[o],r,o);else i._resolve([]);return i},t.race=function(e){var i=new t;if(e.length)for(var r=0,n=e;r<n.length;r++){n[r].then((function(t){return i&&(i._resolve(t),i=null),null}),(function(t){i&&(i._reject(t),i=null)}))}return i},t}(),s=function(){function t(){}return t.Apply=function(t){(void 0===t&&(t=!1),t||"undefined"==typeof Promise)&&(window.Promise=o)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(2),n=function(){function t(){}return t.SetImmediate=function(t){r.a.IsWindowObjectExist()&&window.setImmediate?window.setImmediate(t):setTimeout(t,1)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.RandomId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i(34),n=function(){this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new r.e(0,0,0),this._diffPositionForCollisions=new r.e(0,0,0),this._collisionResponse=!0}},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o}));var r=i(34);function n(t,e,i,n,o){void 0===o&&(o=null);for(var s=new r.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new r.e(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),h=i;h<i+n;h++){var c=3*e[h],u=t[c],l=t[c+1],f=t[c+2];s.minimizeInPlaceFromFloats(u,l,f),a.maximizeInPlaceFromFloats(u,l,f)}return o&&(s.x-=s.x*o.x+o.y,s.y-=s.y*o.x+o.y,s.z-=s.z*o.x+o.y,a.x+=a.x*o.x+o.y,a.y+=a.y*o.x+o.y,a.z+=a.z*o.x+o.y),{minimum:s,maximum:a}}function o(t,e,i,n,o){void 0===n&&(n=null);var s=new r.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new r.e(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);o||(o=3);for(var h=e,c=e*o;h<e+i;h++,c+=o){var u=t[c],l=t[c+1],f=t[c+2];s.minimizeInPlaceFromFloats(u,l,f),a.maximizeInPlaceFromFloats(u,l,f)}return n&&(s.x-=s.x*n.x+n.y,s.y-=s.y*n.x+n.y,s.z-=s.z*n.x+n.y,a.x+=a.x*n.x+n.y,a.y+=a.y*n.x+n.y,a.z+=a.z*n.x+n.y),{minimum:s,maximum:a}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i(3),n=i(37),o=i(36),s=function(){function t(){this._dirty=!0,this._tempColor=new o.b(0,0,0,0),this._globalCurve=new o.b(0,0,0,0),this._highlightsCurve=new o.b(0,0,0,0),this._midtonesCurve=new o.b(0,0,0,0),this._shadowsCurve=new o.b(0,0,0,0),this._positiveCurve=new o.b(0,0,0,0),this._negativeCurve=new o.b(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}return Object.defineProperty(t.prototype,"globalHue",{get:function(){return this._globalHue},set:function(t){this._globalHue=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalDensity",{get:function(){return this._globalDensity},set:function(t){this._globalDensity=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalSaturation",{get:function(){return this._globalSaturation},set:function(t){this._globalSaturation=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalExposure",{get:function(){return this._globalExposure},set:function(t){this._globalExposure=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightsHue",{get:function(){return this._highlightsHue},set:function(t){this._highlightsHue=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightsDensity",{get:function(){return this._highlightsDensity},set:function(t){this._highlightsDensity=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightsSaturation",{get:function(){return this._highlightsSaturation},set:function(t){this._highlightsSaturation=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightsExposure",{get:function(){return this._highlightsExposure},set:function(t){this._highlightsExposure=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"midtonesHue",{get:function(){return this._midtonesHue},set:function(t){this._midtonesHue=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"midtonesDensity",{get:function(){return this._midtonesDensity},set:function(t){this._midtonesDensity=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"midtonesSaturation",{get:function(){return this._midtonesSaturation},set:function(t){this._midtonesSaturation=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"midtonesExposure",{get:function(){return this._midtonesExposure},set:function(t){this._midtonesExposure=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowsHue",{get:function(){return this._shadowsHue},set:function(t){this._shadowsHue=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowsDensity",{get:function(){return this._shadowsDensity},set:function(t){this._shadowsDensity=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowsSaturation",{get:function(){return this._shadowsSaturation},set:function(t){this._shadowsSaturation=t,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowsExposure",{get:function(){return this._shadowsExposure},set:function(t){this._shadowsExposure=t,this._dirty=!0},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"ColorCurves"},t.Bind=function(t,e,i,r,n){void 0===i&&(i="vCameraColorCurvePositive"),void 0===r&&(r="vCameraColorCurveNeutral"),void 0===n&&(n="vCameraColorCurveNegative"),t._dirty&&(t._dirty=!1,t.getColorGradingDataToRef(t._globalHue,t._globalDensity,t._globalSaturation,t._globalExposure,t._globalCurve),t.getColorGradingDataToRef(t._highlightsHue,t._highlightsDensity,t._highlightsSaturation,t._highlightsExposure,t._tempColor),t._tempColor.multiplyToRef(t._globalCurve,t._highlightsCurve),t.getColorGradingDataToRef(t._midtonesHue,t._midtonesDensity,t._midtonesSaturation,t._midtonesExposure,t._tempColor),t._tempColor.multiplyToRef(t._globalCurve,t._midtonesCurve),t.getColorGradingDataToRef(t._shadowsHue,t._shadowsDensity,t._shadowsSaturation,t._shadowsExposure,t._tempColor),t._tempColor.multiplyToRef(t._globalCurve,t._shadowsCurve),t._highlightsCurve.subtractToRef(t._midtonesCurve,t._positiveCurve),t._midtonesCurve.subtractToRef(t._shadowsCurve,t._negativeCurve)),e&&(e.setFloat4(i,t._positiveCurve.r,t._positiveCurve.g,t._positiveCurve.b,t._positiveCurve.a),e.setFloat4(r,t._midtonesCurve.r,t._midtonesCurve.g,t._midtonesCurve.b,t._midtonesCurve.a),e.setFloat4(n,t._negativeCurve.r,t._negativeCurve.g,t._negativeCurve.b,t._negativeCurve.a))},t.PrepareUniforms=function(t){t.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")},t.prototype.getColorGradingDataToRef=function(e,i,r,n,o){null!=e&&(e=t.clamp(e,0,360),i=t.clamp(i,-100,100),r=t.clamp(r,-100,100),n=t.clamp(n,-100,100),i=t.applyColorGradingSliderNonlinear(i),i*=.5,n=t.applyColorGradingSliderNonlinear(n),i<0&&(i*=-1,e=(e+180)%360),t.fromHSBToRef(e,i,50+.25*n,o),o.scaleToRef(2,o),o.a=1+.01*r)},t.applyColorGradingSliderNonlinear=function(t){t/=100;var e=Math.abs(t);return e=Math.pow(e,2),t<0&&(e*=-1),e*=100},t.fromHSBToRef=function(e,i,r,n){var o=t.clamp(e,0,360),s=t.clamp(i/100,0,1),a=t.clamp(r/100,0,1);if(0===s)n.r=a,n.g=a,n.b=a;else{o/=60;var h=Math.floor(o),c=o-h,u=a*(1-s),l=a*(1-s*c),f=a*(1-s*(1-c));switch(h){case 0:n.r=a,n.g=f,n.b=u;break;case 1:n.r=l,n.g=a,n.b=u;break;case 2:n.r=u,n.g=a,n.b=f;break;case 3:n.r=u,n.g=l,n.b=a;break;case 4:n.r=f,n.g=u,n.b=a;break;default:n.r=a,n.g=u,n.b=l}}n.a=1},t.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},t.prototype.clone=function(){return n.a.Clone((function(){return new t}),this)},t.prototype.serialize=function(){return n.a.Serialize(this)},t.Parse=function(e){return n.a.Parse((function(){return new t}),e,null,null)},Object(r.c)([Object(n.c)()],t.prototype,"_globalHue",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_globalDensity",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_globalSaturation",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_globalExposure",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_highlightsHue",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_highlightsDensity",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_highlightsSaturation",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_highlightsExposure",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_midtonesHue",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_midtonesDensity",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_midtonesSaturation",void 0),Object(r.c)([Object(n.c)()],t.prototype,"_midtonesExposure",void 0),t}();n.a._ColorCurvesParser=s.Parse},function(t,e,i){"use strict";var r=i(4),n=i(10);r.a.prototype.createUniformBuffer=function(t){var e=this._gl.createBuffer();if(!e)throw new Error("Unable to create uniform buffer");var i=new n.a(e);return this.bindUniformBuffer(i),t instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,t,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(t),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),i.references=1,i},r.a.prototype.createDynamicUniformBuffer=function(t){var e=this._gl.createBuffer();if(!e)throw new Error("Unable to create dynamic uniform buffer");var i=new n.a(e);return this.bindUniformBuffer(i),t instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,t,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(t),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),i.references=1,i},r.a.prototype.updateUniformBuffer=function(t,e,i,r){this.bindUniformBuffer(t),void 0===i&&(i=0),void 0===r?e instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,i,e):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,i,new Float32Array(e)):e instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,e.subarray(i,i+r)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(e).subarray(i,i+r)),this.bindUniformBuffer(null)},r.a.prototype.bindUniformBuffer=function(t){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,t?t.underlyingResource:null)},r.a.prototype.bindUniformBufferBase=function(t,e){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,e,t?t.underlyingResource:null)},r.a.prototype.bindUniformBlock=function(t,e,i){var r=t.program,n=this._gl.getUniformBlockIndex(r,e);this._gl.uniformBlockBinding(r,n,i)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(68),n=i(34),o=function(){function t(t,e,i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.index=t,this._opaqueSubMeshes=new r.a(256),this._transparentSubMeshes=new r.a(256),this._alphaTestSubMeshes=new r.a(256),this._depthOnlySubMeshes=new r.a(256),this._particleSystems=new r.a(256),this._spriteManagers=new r.a(256),this._edgesRenderers=new r.b(16),this._scene=e,this.opaqueSortCompareFn=i,this.alphaTestSortCompareFn=n,this.transparentSortCompareFn=o}return Object.defineProperty(t.prototype,"opaqueSortCompareFn",{set:function(e){this._opaqueSortCompareFn=e,this._renderOpaque=e?this.renderOpaqueSorted:t.renderUnsorted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaTestSortCompareFn",{set:function(e){this._alphaTestSortCompareFn=e,this._renderAlphaTest=e?this.renderAlphaTestSorted:t.renderUnsorted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transparentSortCompareFn",{set:function(e){this._transparentSortCompareFn=e||t.defaultTransparentSortCompare,this._renderTransparent=this.renderTransparentSorted},enumerable:!1,configurable:!0}),t.prototype.render=function(t,e,i,r){if(t)t(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);else{var n=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(n.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),n.setColorWrite(!0)),0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes),0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);var o=n.getStencilBuffer();if(n.setStencilBuffer(!1),e&&this._renderSprites(),i&&this._renderParticles(r),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length&&(n.setStencilBuffer(o),this._renderTransparent(this._transparentSubMeshes),n.setAlphaMode(0)),n.setStencilBuffer(!1),this._edgesRenderers.length){for(var s=0;s<this._edgesRenderers.length;s++)this._edgesRenderers.data[s].render();n.setAlphaMode(0)}n.setStencilBuffer(o)}},t.prototype.renderOpaqueSorted=function(e){return t.renderSorted(e,this._opaqueSortCompareFn,this._scene.activeCamera,!1)},t.prototype.renderAlphaTestSorted=function(e){return t.renderSorted(e,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)},t.prototype.renderTransparentSorted=function(e){return t.renderSorted(e,this._transparentSortCompareFn,this._scene.activeCamera,!0)},t.renderSorted=function(e,i,r,o){for(var s,a=0,h=r?r.globalPosition:t._zeroVector;a<e.length;a++)(s=e.data[a])._alphaIndex=s.getMesh().alphaIndex,s._distanceToCamera=n.e.Distance(s.getBoundingInfo().boundingSphere.centerWorld,h);var c=e.data.slice(0,e.length);for(i&&c.sort(i),a=0;a<c.length;a++){if(s=c[a],o){var u=s.getMaterial();if(u&&u.needDepthPrePass){var l=u.getScene().getEngine();l.setColorWrite(!1),l.setAlphaMode(0),s.render(!1),l.setColorWrite(!0)}}s.render(o)}},t.renderUnsorted=function(t){for(var e=0;e<t.length;e++){t.data[e].render(!1)}},t.defaultTransparentSortCompare=function(e,i){return e._alphaIndex>i._alphaIndex?1:e._alphaIndex<i._alphaIndex?-1:t.backToFrontSortCompare(e,i)},t.backToFrontSortCompare=function(t,e){return t._distanceToCamera<e._distanceToCamera?1:t._distanceToCamera>e._distanceToCamera?-1:0},t.frontToBackSortCompare=function(t,e){return t._distanceToCamera<e._distanceToCamera?-1:t._distanceToCamera>e._distanceToCamera?1:0},t.prototype.prepare=function(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this._spriteManagers.reset(),this._edgesRenderers.reset()},t.prototype.dispose=function(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()},t.prototype.dispatch=function(t,e,i){void 0===e&&(e=t.getMesh()),void 0===i&&(i=t.getMaterial()),null!=i&&(i.needAlphaBlendingForMesh(e)?this._transparentSubMeshes.push(t):i.needAlphaTesting()?(i.needDepthPrePass&&this._depthOnlySubMeshes.push(t),this._alphaTestSubMeshes.push(t)):(i.needDepthPrePass&&this._depthOnlySubMeshes.push(t),this._opaqueSubMeshes.push(t)),e._renderingGroup=this,e._edgesRenderer&&e._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(e._edgesRenderer))},t.prototype.dispatchSprites=function(t){this._spriteManagers.push(t)},t.prototype.dispatchParticles=function(t){this._particleSystems.push(t)},t.prototype._renderParticles=function(t){if(0!==this._particleSystems.length){var e=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(var i=0;i<this._particleSystems.length;i++){var r=this._particleSystems.data[i];if(0!==(e&&e.layerMask&r.layerMask)){var n=r.emitter;n.position&&t&&-1===t.indexOf(n)||this._scene._activeParticles.addCount(r.render(),!1)}}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}},t.prototype._renderSprites=function(){if(this._scene.spritesEnabled&&0!==this._spriteManagers.length){var t=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(var e=0;e<this._spriteManagers.length;e++){var i=this._spriteManagers.data[e];0!==(t&&t.layerMask&i.layerMask)&&i.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}},t._zeroVector=n.e.Zero(),t}()},,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(t,e){this.distance=t,this.mesh=e}},,function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(58),n=i(8),o=function(){function t(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}return Object.defineProperty(t.prototype,"name",{get:function(){return"AutoRotation"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomStopsAnimation",{get:function(){return this._zoomStopsAnimation},set:function(t){this._zoomStopsAnimation=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationSpeed",{get:function(){return this._idleRotationSpeed},set:function(t){this._idleRotationSpeed=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationWaitTime",{get:function(){return this._idleRotationWaitTime},set:function(t){this._idleRotationWaitTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationSpinupTime",{get:function(){return this._idleRotationSpinupTime},set:function(t){this._idleRotationSpinupTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotationInProgress",{get:function(){return Math.abs(this._cameraRotationSpeed)>0},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){var e=this;this._attachedCamera=t;var i=this._attachedCamera.getScene();this._onPrePointerObservableObserver=i.onPrePointerObservable.add((function(t){t.type!==r.a.POINTERDOWN?t.type===r.a.POINTERUP&&(e._isPointerDown=!1):e._isPointerDown=!0})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((function(){var t=n.a.Now,i=0;null!=e._lastFrameTime&&(i=t-e._lastFrameTime),e._lastFrameTime=t,e._applyUserInteraction();var r=t-e._lastInteractionTime-e._idleRotationWaitTime,o=Math.max(Math.min(r/e._idleRotationSpinupTime,1),0);e._cameraRotationSpeed=e._idleRotationSpeed*o,e._attachedCamera&&(e._attachedCamera.alpha-=e._cameraRotationSpeed*(i/1e3))}))},t.prototype.detach=function(){if(this._attachedCamera){var t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}},t.prototype._userIsZooming=function(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset},t.prototype._shouldAnimationStopForInteraction=function(){if(!this._attachedCamera)return!1;var t=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(t=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?t:this._userIsZooming()},t.prototype._applyUserInteraction=function(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=n.a.Now)},t.prototype._userIsMoving=function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(125),n=i(65),o=function(){function t(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}return Object.defineProperty(t.prototype,"name",{get:function(){return"Bouncing"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoTransitionRange",{get:function(){return this._autoTransitionRange},set:function(t){var e=this;if(this._autoTransitionRange!==t){this._autoTransitionRange=t;var i=this._attachedCamera;i&&(t?this._onMeshTargetChangedObserver=i.onMeshTargetChangedObservable.add((function(t){if(t){t.computeWorldMatrix(!0);var i=t.getBoundingInfo().diagonalLength;e.lowerRadiusTransitionRange=.05*i,e.upperRadiusTransitionRange=.05*i}})):this._onMeshTargetChangedObserver&&i.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){var e=this;this._attachedCamera=t,this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((function(){e._attachedCamera&&(e._isRadiusAtLimit(e._attachedCamera.lowerRadiusLimit)&&e._applyBoundRadiusAnimation(e.lowerRadiusTransitionRange),e._isRadiusAtLimit(e._attachedCamera.upperRadiusLimit)&&e._applyBoundRadiusAnimation(e.upperRadiusTransitionRange))}))},t.prototype.detach=function(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)},t.prototype._isRadiusAtLimit=function(t){return!!this._attachedCamera&&(this._attachedCamera.radius===t&&!this._radiusIsAnimating)},t.prototype._applyBoundRadiusAnimation=function(e){var i=this;if(this._attachedCamera){this._radiusBounceTransition||(t.EasingFunction.setEasingMode(t.EasingMode),this._radiusBounceTransition=n.a.CreateAnimation("radius",n.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;var r=n.a.TransitionTo("radius",this._attachedCamera.radius+e,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,(function(){return i._clearAnimationLocks()}));r&&this._animatables.push(r)}},t.prototype._clearAnimationLocks=function(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)},t.prototype.stopAllAnimations=function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()},t.EasingFunction=new r.a(.3),t.EasingMode=r.c.EASINGMODE_EASEOUT,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var r=i(125),n=i(58),o=i(8),s=i(34),a=i(65),h=function(){function t(){this._mode=t.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}return Object.defineProperty(t.prototype,"name",{get:function(){return"Framing"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radiusScale",{get:function(){return this._radiusScale},set:function(t){this._radiusScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positionScale",{get:function(){return this._positionScale},set:function(t){this._positionScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultElevation",{get:function(){return this._defaultElevation},set:function(t){this._defaultElevation=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"elevationReturnTime",{get:function(){return this._elevationReturnTime},set:function(t){this._elevationReturnTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"elevationReturnWaitTime",{get:function(){return this._elevationReturnWaitTime},set:function(t){this._elevationReturnWaitTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomStopsAnimation",{get:function(){return this._zoomStopsAnimation},set:function(t){this._zoomStopsAnimation=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"framingTime",{get:function(){return this._framingTime},set:function(t){this._framingTime=t},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(e){var i=this;this._attachedCamera=e;var r=this._attachedCamera.getScene();t.EasingFunction.setEasingMode(t.EasingMode),this._onPrePointerObservableObserver=r.onPrePointerObservable.add((function(t){t.type!==n.a.POINTERDOWN?t.type===n.a.POINTERUP&&(i._isPointerDown=!1):i._isPointerDown=!0})),this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add((function(t){t&&i.zoomOnMesh(t)})),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add((function(){i._applyUserInteraction(),i._maintainCameraAboveGround()}))},t.prototype.detach=function(){if(this._attachedCamera){var t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}},t.prototype.zoomOnMesh=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=null),t.computeWorldMatrix(!0);var r=t.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(r.minimumWorld,r.maximumWorld,e,i)},t.prototype.zoomOnMeshHierarchy=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=null),t.computeWorldMatrix(!0);var r=t.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(r.min,r.max,e,i)},t.prototype.zoomOnMeshesHierarchy=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=null);for(var r=new s.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=new s.e(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),o=0;o<t.length;o++){var a=t[o].getHierarchyBoundingVectors(!0);s.e.CheckExtends(a.min,r,n),s.e.CheckExtends(a.max,r,n)}this.zoomOnBoundingInfo(r,n,e,i)},t.prototype.zoomOnBoundingInfo=function(e,i,r,n){var o,h=this;if(void 0===r&&(r=!1),void 0===n&&(n=null),this._attachedCamera){var c=e.y,u=c+(i.y-c)*this._positionScale,l=i.subtract(e).scale(.5);if(r)o=new s.e(0,u,0);else{var f=e.add(l);o=new s.e(f.x,u,f.z)}this._vectorTransition||(this._vectorTransition=a.a.CreateAnimation("target",a.a.ANIMATIONTYPE_VECTOR3,60,t.EasingFunction)),this._betaIsAnimating=!0;var d=a.a.TransitionTo("target",o,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);d&&this._animatables.push(d);var p=0;if(this._mode===t.FitFrustumSidesMode){var _=this._calculateLowerRadiusFromModelBoundingSphere(e,i);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=l.length()+this._attachedCamera.minZ),p=_}else this._mode===t.IgnoreBoundsSizeMode&&(p=this._calculateLowerRadiusFromModelBoundingSphere(e,i),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){var g=i.subtract(e).length();this._attachedCamera.panningSensibility=5e3/g,this._attachedCamera.wheelPrecision=100/p}this._radiusTransition||(this._radiusTransition=a.a.CreateAnimation("radius",a.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction)),(d=a.a.TransitionTo("radius",p,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,(function(){h.stopAllAnimations(),n&&n(),h._attachedCamera&&h._attachedCamera.useInputToRestoreState&&h._attachedCamera.storeState()})))&&this._animatables.push(d)}},t.prototype._calculateLowerRadiusFromModelBoundingSphere=function(e,i){var r=i.subtract(e).length(),n=this._getFrustumSlope(),o=.5*r*this._radiusScale,s=o*Math.sqrt(1+1/(n.x*n.x)),a=o*Math.sqrt(1+1/(n.y*n.y)),h=Math.max(s,a),c=this._attachedCamera;return c?(c.lowerRadiusLimit&&this._mode===t.IgnoreBoundsSizeMode&&(h=h<c.lowerRadiusLimit?c.lowerRadiusLimit:h),c.upperRadiusLimit&&(h=h>c.upperRadiusLimit?c.upperRadiusLimit:h),h):0},t.prototype._maintainCameraAboveGround=function(){var e=this;if(!(this._elevationReturnTime<0)){var i=o.a.Now-this._lastInteractionTime,r=.5*Math.PI-this._defaultElevation,n=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>n&&i>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=a.a.CreateAnimation("beta",a.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction));var s=a.a.TransitionTo("beta",r,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,(function(){e._clearAnimationLocks(),e.stopAllAnimations()}));s&&this._animatables.push(s)}}},t.prototype._getFrustumSlope=function(){var t=this._attachedCamera;if(!t)return s.d.Zero();var e=t.getScene().getEngine().getAspectRatio(t),i=Math.tan(t.fov/2),r=i*e;return new s.d(r,i)},t.prototype._clearAnimationLocks=function(){this._betaIsAnimating=!1},t.prototype._applyUserInteraction=function(){this.isUserIsMoving&&(this._lastInteractionTime=o.a.Now,this.stopAllAnimations(),this._clearAnimationLocks())},t.prototype.stopAllAnimations=function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()},Object.defineProperty(t.prototype,"isUserIsMoving",{get:function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)},enumerable:!1,configurable:!0}),t.EasingFunction=new r.d,t.EasingMode=r.c.EASINGMODE_EASEINOUT,t.IgnoreBoundsSizeMode=0,t.FitFrustumSidesMode=1,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(3),n=i(37),o=i(53),s=i(107),a=function(){function t(){this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}return t.prototype.attachControl=function(t,e){var i=this;this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add((function(){i._keys=[]})),this._onKeyboardObserver=this._scene.onKeyboardObservable.add((function(t){var r,n=t.event;n.metaKey||(t.type===s.a.KEYDOWN?(i._ctrlPressed=n.ctrlKey,i._altPressed=n.altKey,(-1!==i.keysUp.indexOf(n.keyCode)||-1!==i.keysDown.indexOf(n.keyCode)||-1!==i.keysLeft.indexOf(n.keyCode)||-1!==i.keysRight.indexOf(n.keyCode)||-1!==i.keysReset.indexOf(n.keyCode))&&(-1===(r=i._keys.indexOf(n.keyCode))&&i._keys.push(n.keyCode),n.preventDefault&&(e||n.preventDefault()))):-1===i.keysUp.indexOf(n.keyCode)&&-1===i.keysDown.indexOf(n.keyCode)&&-1===i.keysLeft.indexOf(n.keyCode)&&-1===i.keysRight.indexOf(n.keyCode)&&-1===i.keysReset.indexOf(n.keyCode)||((r=i._keys.indexOf(n.keyCode))>=0&&i._keys.splice(r,1),n.preventDefault&&(e||n.preventDefault())))})))},t.prototype.detachControl=function(t){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys=[]},t.prototype.checkInputs=function(){if(this._onKeyboardObserver)for(var t=this.camera,e=0;e<this._keys.length;e++){var i=this._keys[e];-1!==this.keysLeft.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX-=1/this.panningSensibility:t.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset+=1/this.zoomingSensibility:t.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX+=1/this.panningSensibility:t.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset-=1/this.zoomingSensibility:t.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(i)&&t.useInputToRestoreState&&t.restoreState()}},t.prototype.getClassName=function(){return"ArcRotateCameraKeyboardMoveInput"},t.prototype.getSimpleName=function(){return"keyboard"},Object(r.c)([Object(n.c)()],t.prototype,"keysUp",void 0),Object(r.c)([Object(n.c)()],t.prototype,"keysDown",void 0),Object(r.c)([Object(n.c)()],t.prototype,"keysLeft",void 0),Object(r.c)([Object(n.c)()],t.prototype,"keysRight",void 0),Object(r.c)([Object(n.c)()],t.prototype,"keysReset",void 0),Object(r.c)([Object(n.c)()],t.prototype,"panningSensibility",void 0),Object(r.c)([Object(n.c)()],t.prototype,"zoomingSensibility",void 0),Object(r.c)([Object(n.c)()],t.prototype,"useAltToZoom",void 0),Object(r.c)([Object(n.c)()],t.prototype,"angularSpeed",void 0),t}();o.a.ArcRotateCameraKeyboardMoveInput=a},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var r=i(3),n=i(37),o=i(53),s=i(58),a=i(46),h=function(){function t(){this.wheelPrecision=3,this.wheelDeltaPercentage=0}return t.prototype.computeDeltaFromMouseWheelLegacyEvent=function(t,e){var i=.01*t*this.wheelDeltaPercentage*e;return t>0?i/(1+this.wheelDeltaPercentage):i*(1+this.wheelDeltaPercentage)},t.prototype.attachControl=function(t,e){var i=this;this._wheel=function(t,r){if(t.type===s.a.POINTERWHEEL){var n=t.event,o=0,h=n,c=0;if(c=h.wheelDelta?h.wheelDelta:60*-(n.deltaY||n.detail),i.wheelDeltaPercentage){if((o=i.computeDeltaFromMouseWheelLegacyEvent(c,i.camera.radius))>0){for(var u=i.camera.radius,l=i.camera.inertialRadiusOffset+o,f=0;f<20&&Math.abs(l)>.001;f++)u-=l,l*=i.camera.inertia;u=a.a.Clamp(u,0,Number.MAX_VALUE),o=i.computeDeltaFromMouseWheelLegacyEvent(c,u)}}else o=c/(40*i.wheelPrecision);o&&(i.camera.inertialRadiusOffset+=o),n.preventDefault&&(e||n.preventDefault())}},this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,s.a.POINTERWHEEL)},t.prototype.detachControl=function(t){this._observer&&t&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this._wheel=null)},t.prototype.getClassName=function(){return"ArcRotateCameraMouseWheelInput"},t.prototype.getSimpleName=function(){return"mousewheel"},Object(r.c)([Object(n.c)()],t.prototype,"wheelPrecision",void 0),Object(r.c)([Object(n.c)()],t.prototype,"wheelDeltaPercentage",void 0),t}();o.a.ArcRotateCameraMouseWheelInput=h},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i(3),n=i(37),o=i(53),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buttons=[0,1,2],e.angularSensibilityX=1e3,e.angularSensibilityY=1e3,e.pinchPrecision=12,e.pinchDeltaPercentage=0,e.useNaturalPinchZoom=!1,e.panningSensibility=1e3,e.multiTouchPanning=!0,e.multiTouchPanAndZoom=!0,e.pinchInwards=!0,e._isPanClick=!1,e._twoFingerActivityCount=0,e._isPinching=!1,e}return Object(r.d)(e,t),e.prototype.getClassName=function(){return"ArcRotateCameraPointersInput"},e.prototype.onTouch=function(t,e,i){0!==this.panningSensibility&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-e/this.panningSensibility,this.camera.inertialPanningY+=i/this.panningSensibility):(this.camera.inertialAlphaOffset-=e/this.angularSensibilityX,this.camera.inertialBetaOffset-=i/this.angularSensibilityY)},e.prototype.onDoubleTap=function(t){this.camera.useInputToRestoreState&&this.camera.restoreState()},e.prototype.onMultiTouch=function(t,e,i,r,n,o){if(!(0===i&&null===n||0===r&&null===o)){var s=this.pinchInwards?1:-1;if(this.multiTouchPanAndZoom){if(this.useNaturalPinchZoom?this.camera.radius=this.camera.radius*Math.sqrt(i)/Math.sqrt(r):this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=.001*(r-i)*this.camera.radius*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(r-i)/(this.pinchPrecision*s*(this.angularSensibilityX+this.angularSensibilityY)/2),0!==this.panningSensibility&&n&&o){var a=o.x-n.x,h=o.y-n.y;this.camera.inertialPanningX+=-a/this.panningSensibility,this.camera.inertialPanningY+=h/this.panningSensibility}}else{this._twoFingerActivityCount++;var c=Math.sqrt(i),u=Math.sqrt(r);if(this._isPinching||this._twoFingerActivityCount<20&&Math.abs(u-c)>this.camera.pinchToPanMaxDistance)this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=.001*(r-i)*this.camera.radius*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(r-i)/(this.pinchPrecision*s*(this.angularSensibilityX+this.angularSensibilityY)/2),this._isPinching=!0;else if(0!==this.panningSensibility&&this.multiTouchPanning&&o&&n){a=o.x-n.x,h=o.y-n.y;this.camera.inertialPanningX+=-a/this.panningSensibility,this.camera.inertialPanningY+=h/this.panningSensibility}}}},e.prototype.onButtonDown=function(t){this._isPanClick=t.button===this.camera._panningMouseButton},e.prototype.onButtonUp=function(t){this._twoFingerActivityCount=0,this._isPinching=!1},e.prototype.onLostFocus=function(){this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1},Object(r.c)([Object(n.c)()],e.prototype,"buttons",void 0),Object(r.c)([Object(n.c)()],e.prototype,"angularSensibilityX",void 0),Object(r.c)([Object(n.c)()],e.prototype,"angularSensibilityY",void 0),Object(r.c)([Object(n.c)()],e.prototype,"pinchPrecision",void 0),Object(r.c)([Object(n.c)()],e.prototype,"pinchDeltaPercentage",void 0),Object(r.c)([Object(n.c)()],e.prototype,"useNaturalPinchZoom",void 0),Object(r.c)([Object(n.c)()],e.prototype,"panningSensibility",void 0),Object(r.c)([Object(n.c)()],e.prototype,"multiTouchPanning",void 0),Object(r.c)([Object(n.c)()],e.prototype,"multiTouchPanAndZoom",void 0),e}(i(231).a);o.a.ArcRotateCameraPointersInput=s},,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(1),n=i(35),o=function(){function t(){}return t.Instantiate=function(t){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[t])return this.RegisteredExternalClasses[t];var e=n.a.GetClass(t);if(e)return e;r.a.Warn(t+" not found, you may have missed an import.");for(var i=t.split("."),o=window||this,s=0,a=i.length;s<a;s++)o=o[i[s]];return"function"!=typeof o?null:o},t.RegisteredExternalClasses={},t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){}return Object.defineProperty(t,"UniqueId",{get:function(){var t=this._UniqueIdCounter;return this._UniqueIdCounter++,t},enumerable:!1,configurable:!0}),t._UniqueIdCounter=0,t}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(3),n=i(37),o=i(41),s=i(58),a=function(){function t(){this.buttons=[0,1,2]}return t.prototype.attachControl=function(t,e){var i=this,r=this.camera.getEngine(),n=0,a=null;this.pointA=null,this.pointB=null,this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._pointerInput=function(o,h){var c=o.event,u="touch"===c.pointerType;if(!r.isInVRExclusivePointerMode&&(o.type===s.a.POINTERMOVE||-1!==i.buttons.indexOf(c.button))){var l=c.srcElement||c.target;if(i._altKey=c.altKey,i._ctrlKey=c.ctrlKey,i._metaKey=c.metaKey,i._shiftKey=c.shiftKey,i._buttonsPressed=c.buttons,r.isPointerLock){var f=c.movementX||c.mozMovementX||c.webkitMovementX||c.msMovementX||0,d=c.movementY||c.mozMovementY||c.webkitMovementY||c.msMovementY||0;i.onTouch(null,f,d),i.pointA=null,i.pointB=null}else if(o.type===s.a.POINTERDOWN&&l){try{l.setPointerCapture(c.pointerId)}catch(t){}null===i.pointA?i.pointA={x:c.clientX,y:c.clientY,pointerId:c.pointerId,type:c.pointerType}:null===i.pointB&&(i.pointB={x:c.clientX,y:c.clientY,pointerId:c.pointerId,type:c.pointerType}),i.onButtonDown(c),e||(c.preventDefault(),t.focus())}else if(o.type===s.a.POINTERDOUBLETAP)i.onDoubleTap(c.pointerType);else if(o.type===s.a.POINTERUP&&l){try{l.releasePointerCapture(c.pointerId)}catch(t){}u||(i.pointB=null),r._badOS?i.pointA=i.pointB=null:i.pointB&&i.pointA&&i.pointA.pointerId==c.pointerId?(i.pointA=i.pointB,i.pointB=null):i.pointA&&i.pointB&&i.pointB.pointerId==c.pointerId?i.pointB=null:i.pointA=i.pointB=null,(0!==n||a)&&(i.onMultiTouch(i.pointA,i.pointB,n,0,a,null),n=0,a=null),i.onButtonUp(c),e||c.preventDefault()}else if(o.type===s.a.POINTERMOVE)if(e||c.preventDefault(),i.pointA&&null===i.pointB){f=c.clientX-i.pointA.x,d=c.clientY-i.pointA.y;i.onTouch(i.pointA,f,d),i.pointA.x=c.clientX,i.pointA.y=c.clientY}else if(i.pointA&&i.pointB){var p=i.pointA.pointerId===c.pointerId?i.pointA:i.pointB;p.x=c.clientX,p.y=c.clientY;var _=i.pointA.x-i.pointB.x,g=i.pointA.y-i.pointB.y,m=_*_+g*g,y={x:(i.pointA.x+i.pointB.x)/2,y:(i.pointA.y+i.pointB.y)/2,pointerId:c.pointerId,type:o.type};i.onMultiTouch(i.pointA,i.pointB,n,m,a,y),a=y,n=m}}},this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,s.a.POINTERDOWN|s.a.POINTERUP|s.a.POINTERMOVE),this._onLostFocus=function(){i.pointA=i.pointB=null,n=0,a=null,i.onLostFocus()},t.addEventListener("contextmenu",this.onContextMenu.bind(this),!1);var h=this.camera.getScene().getEngine().getHostWindow();h&&o.b.RegisterTopRootEvents(h,[{name:"blur",handler:this._onLostFocus}])},t.prototype.detachControl=function(t){if(this._onLostFocus){var e=this.camera.getScene().getEngine().getHostWindow();e&&o.b.UnregisterTopRootEvents(e,[{name:"blur",handler:this._onLostFocus}])}t&&this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this.onContextMenu&&t.removeEventListener("contextmenu",this.onContextMenu),this._onLostFocus=null),this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0},t.prototype.getClassName=function(){return"BaseCameraPointersInput"},t.prototype.getSimpleName=function(){return"pointers"},t.prototype.onDoubleTap=function(t){},t.prototype.onTouch=function(t,e,i){},t.prototype.onMultiTouch=function(t,e,i,r,n,o){},t.prototype.onContextMenu=function(t){t.preventDefault()},t.prototype.onButtonDown=function(t){},t.prototype.onButtonUp=function(t){},t.prototype.onLostFocus=function(){},Object(r.c)([Object(n.c)()],t.prototype,"buttons",void 0),t}()}])]);
//# sourceMappingURL=0.babylonBundle.js.map